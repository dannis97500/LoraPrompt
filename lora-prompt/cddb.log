2024-06-13 10:05:55,440 [trainer.py] => config: configs/lora-prompt/cddb.json
2024-06-13 10:05:55,440 [trainer.py] => prefix: reproduce
2024-06-13 10:05:55,440 [trainer.py] => dataset: cddb
2024-06-13 10:05:55,440 [trainer.py] => task_name: ['gaugan', 'biggan', 'wild', 'whichfaceisreal', 'san']
2024-06-13 10:05:55,440 [trainer.py] => data_path: 
2024-06-13 10:05:55,440 [trainer.py] => multiclass: [0, 0, 0, 0, 0]
2024-06-13 10:05:55,440 [trainer.py] => class_order: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2024-06-13 10:05:55,440 [trainer.py] => total_sessions: 5
2024-06-13 10:05:55,440 [trainer.py] => memory_size: 0
2024-06-13 10:05:55,440 [trainer.py] => memory_per_class: 0
2024-06-13 10:05:55,440 [trainer.py] => fixed_memory: True
2024-06-13 10:05:55,440 [trainer.py] => shuffle: False
2024-06-13 10:05:55,440 [trainer.py] => init_cls: 2
2024-06-13 10:05:55,440 [trainer.py] => increment: 2
2024-06-13 10:05:55,440 [trainer.py] => model_name: lora_prompt
2024-06-13 10:05:55,440 [trainer.py] => net_type: lora_prompt_clip
2024-06-13 10:05:55,440 [trainer.py] => embd_dim: 768
2024-06-13 10:05:55,441 [trainer.py] => prompt_length: 10
2024-06-13 10:05:55,441 [trainer.py] => device: [device(type='cuda', index=0)]
2024-06-13 10:05:55,441 [trainer.py] => seed: 1993
2024-06-13 10:05:55,441 [trainer.py] => EPSILON: 1e-08
2024-06-13 10:05:55,441 [trainer.py] => init_epoch: 50
2024-06-13 10:05:55,441 [trainer.py] => init_lr: 0.001
2024-06-13 10:05:55,441 [trainer.py] => init_milestones: [20, 30, 40]
2024-06-13 10:05:55,441 [trainer.py] => init_lr_decay: 0.1
2024-06-13 10:05:55,441 [trainer.py] => init_weight_decay: 0.0005
2024-06-13 10:05:55,441 [trainer.py] => epochs: 30
2024-06-13 10:05:55,441 [trainer.py] => lrate: 0.01
2024-06-13 10:05:55,441 [trainer.py] => milestones: [20, 30]
2024-06-13 10:05:55,441 [trainer.py] => lrate_decay: 0.1
2024-06-13 10:05:55,441 [trainer.py] => batch_size: 128
2024-06-13 10:05:55,441 [trainer.py] => weight_decay: 0.0002
2024-06-13 10:05:55,441 [trainer.py] => num_workers: 16
2024-06-13 10:05:55,500 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
/miniconda3/envs/pyspompts/lib/python3.8/site-packages/peft/tuners/lora.py:173: UserWarning: fan_in_fan_out is set to True but the target module is not a Conv1D. Setting fan_in_fan_out to False.
  warnings.warn(
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
2024-06-13 10:06:00,056 [trainer.py] => All params: 581646337
2024-06-13 10:06:00,061 [trainer.py] => Trainable params: 150683137
2024-06-13 10:06:00,061 [lora_prompt.py] => Learning on 0-2
Parameters to be updated: {'lora_image_model_pool.0.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'classifier_pool.0.ctx', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight'},count:204800
  0%|          | 0/50 [00:00<?, ?it/s]Task 0, Epoch 1/50 => Loss 0.502, Train_accy 74.12, Test_accy 92.30:   0%|          | 0/50 [00:20<?, ?it/s]Task 0, Epoch 1/50 => Loss 0.502, Train_accy 74.12, Test_accy 92.30:   2%|▏         | 1/50 [00:20<16:31, 20.24s/it]Task 0, Epoch 2/50 => Loss 0.212, Train_accy 91.48, Test_accy 96.90:   2%|▏         | 1/50 [00:36<16:31, 20.24s/it]Task 0, Epoch 2/50 => Loss 0.212, Train_accy 91.48, Test_accy 96.90:   4%|▍         | 2/50 [00:36<14:29, 18.11s/it]Task 0, Epoch 3/50 => Loss 0.162, Train_accy 93.63, Test_accy 95.50:   4%|▍         | 2/50 [00:53<14:29, 18.11s/it]Task 0, Epoch 3/50 => Loss 0.162, Train_accy 93.63, Test_accy 95.50:   6%|▌         | 3/50 [00:53<13:46, 17.59s/it]Task 0, Epoch 4/50 => Loss 0.141, Train_accy 94.57, Test_accy 96.20:   6%|▌         | 3/50 [01:10<13:46, 17.59s/it]Task 0, Epoch 4/50 => Loss 0.141, Train_accy 94.57, Test_accy 96.20:   8%|▊         | 4/50 [01:10<13:14, 17.28s/it]Task 0, Epoch 5/50 => Loss 0.118, Train_accy 95.43, Test_accy 97.75:   8%|▊         | 4/50 [01:27<13:14, 17.28s/it]Task 0, Epoch 5/50 => Loss 0.118, Train_accy 95.43, Test_accy 97.75:  10%|█         | 5/50 [01:27<12:50, 17.13s/it]Task 0, Epoch 6/50 => Loss 0.106, Train_accy 96.07, Test_accy 96.65:  10%|█         | 5/50 [01:44<12:50, 17.13s/it]Task 0, Epoch 6/50 => Loss 0.106, Train_accy 96.07, Test_accy 96.65:  12%|█▏        | 6/50 [01:44<12:30, 17.06s/it]Task 0, Epoch 7/50 => Loss 0.111, Train_accy 95.70, Test_accy 97.80:  12%|█▏        | 6/50 [02:01<12:30, 17.06s/it]Task 0, Epoch 7/50 => Loss 0.111, Train_accy 95.70, Test_accy 97.80:  14%|█▍        | 7/50 [02:01<12:12, 17.03s/it]Task 0, Epoch 8/50 => Loss 0.099, Train_accy 96.20, Test_accy 98.15:  14%|█▍        | 7/50 [02:18<12:12, 17.03s/it]Task 0, Epoch 8/50 => Loss 0.099, Train_accy 96.20, Test_accy 98.15:  16%|█▌        | 8/50 [02:18<11:50, 16.93s/it]Task 0, Epoch 9/50 => Loss 0.095, Train_accy 96.28, Test_accy 97.80:  16%|█▌        | 8/50 [02:35<11:50, 16.93s/it]Task 0, Epoch 9/50 => Loss 0.095, Train_accy 96.28, Test_accy 97.80:  18%|█▊        | 9/50 [02:35<11:34, 16.93s/it]Task 0, Epoch 10/50 => Loss 0.096, Train_accy 96.40, Test_accy 98.55:  18%|█▊        | 9/50 [02:51<11:34, 16.93s/it]Task 0, Epoch 10/50 => Loss 0.096, Train_accy 96.40, Test_accy 98.55:  20%|██        | 10/50 [02:51<11:12, 16.82s/it]Task 0, Epoch 11/50 => Loss 0.095, Train_accy 96.45, Test_accy 98.80:  20%|██        | 10/50 [03:08<11:12, 16.82s/it]Task 0, Epoch 11/50 => Loss 0.095, Train_accy 96.45, Test_accy 98.80:  22%|██▏       | 11/50 [03:08<10:56, 16.84s/it]Task 0, Epoch 12/50 => Loss 0.083, Train_accy 96.73, Test_accy 98.85:  22%|██▏       | 11/50 [03:25<10:56, 16.84s/it]Task 0, Epoch 12/50 => Loss 0.083, Train_accy 96.73, Test_accy 98.85:  24%|██▍       | 12/50 [03:25<10:41, 16.87s/it]Task 0, Epoch 13/50 => Loss 0.082, Train_accy 97.07, Test_accy 98.75:  24%|██▍       | 12/50 [03:42<10:41, 16.87s/it]Task 0, Epoch 13/50 => Loss 0.082, Train_accy 97.07, Test_accy 98.75:  26%|██▌       | 13/50 [03:42<10:22, 16.82s/it]Task 0, Epoch 14/50 => Loss 0.083, Train_accy 96.90, Test_accy 98.75:  26%|██▌       | 13/50 [03:59<10:22, 16.82s/it]Task 0, Epoch 14/50 => Loss 0.083, Train_accy 96.90, Test_accy 98.75:  28%|██▊       | 14/50 [03:59<10:08, 16.91s/it]Task 0, Epoch 15/50 => Loss 0.081, Train_accy 97.02, Test_accy 98.45:  28%|██▊       | 14/50 [04:16<10:08, 16.91s/it]Task 0, Epoch 15/50 => Loss 0.081, Train_accy 97.02, Test_accy 98.45:  30%|███       | 15/50 [04:16<09:55, 17.02s/it]Task 0, Epoch 16/50 => Loss 0.084, Train_accy 96.98, Test_accy 98.80:  30%|███       | 15/50 [04:33<09:55, 17.02s/it]Task 0, Epoch 16/50 => Loss 0.084, Train_accy 96.98, Test_accy 98.80:  32%|███▏      | 16/50 [04:33<09:35, 16.93s/it]Task 0, Epoch 17/50 => Loss 0.077, Train_accy 97.22, Test_accy 98.90:  32%|███▏      | 16/50 [04:50<09:35, 16.93s/it]Task 0, Epoch 17/50 => Loss 0.077, Train_accy 97.22, Test_accy 98.90:  34%|███▍      | 17/50 [04:50<09:18, 16.91s/it]Task 0, Epoch 18/50 => Loss 0.072, Train_accy 97.23, Test_accy 99.15:  34%|███▍      | 17/50 [05:06<09:18, 16.91s/it]Task 0, Epoch 18/50 => Loss 0.072, Train_accy 97.23, Test_accy 99.15:  36%|███▌      | 18/50 [05:06<09:00, 16.89s/it]Task 0, Epoch 19/50 => Loss 0.075, Train_accy 97.22, Test_accy 99.15:  36%|███▌      | 18/50 [05:23<09:00, 16.89s/it]Task 0, Epoch 19/50 => Loss 0.075, Train_accy 97.22, Test_accy 99.15:  38%|███▊      | 19/50 [05:23<08:42, 16.84s/it]Task 0, Epoch 20/50 => Loss 0.073, Train_accy 97.40, Test_accy 98.50:  38%|███▊      | 19/50 [05:40<08:42, 16.84s/it]Task 0, Epoch 20/50 => Loss 0.073, Train_accy 97.40, Test_accy 98.50:  40%|████      | 20/50 [05:40<08:24, 16.82s/it]Task 0, Epoch 21/50 => Loss 0.074, Train_accy 97.22, Test_accy 99.10:  40%|████      | 20/50 [05:57<08:24, 16.82s/it]Task 0, Epoch 21/50 => Loss 0.074, Train_accy 97.22, Test_accy 99.10:  42%|████▏     | 21/50 [05:57<08:09, 16.89s/it]Task 0, Epoch 22/50 => Loss 0.075, Train_accy 97.35, Test_accy 98.60:  42%|████▏     | 21/50 [06:14<08:09, 16.89s/it]Task 0, Epoch 22/50 => Loss 0.075, Train_accy 97.35, Test_accy 98.60:  44%|████▍     | 22/50 [06:14<07:56, 17.00s/it]Task 0, Epoch 23/50 => Loss 0.070, Train_accy 97.40, Test_accy 98.95:  44%|████▍     | 22/50 [06:31<07:56, 17.00s/it]Task 0, Epoch 23/50 => Loss 0.070, Train_accy 97.40, Test_accy 98.95:  46%|████▌     | 23/50 [06:31<07:40, 17.06s/it]Task 0, Epoch 24/50 => Loss 0.071, Train_accy 97.70, Test_accy 98.80:  46%|████▌     | 23/50 [06:48<07:40, 17.06s/it]Task 0, Epoch 24/50 => Loss 0.071, Train_accy 97.70, Test_accy 98.80:  48%|████▊     | 24/50 [06:48<07:22, 17.02s/it]Task 0, Epoch 25/50 => Loss 0.074, Train_accy 97.17, Test_accy 98.95:  48%|████▊     | 24/50 [07:05<07:22, 17.02s/it]Task 0, Epoch 25/50 => Loss 0.074, Train_accy 97.17, Test_accy 98.95:  50%|█████     | 25/50 [07:05<07:03, 16.95s/it]Task 0, Epoch 26/50 => Loss 0.065, Train_accy 97.72, Test_accy 99.05:  50%|█████     | 25/50 [07:22<07:03, 16.95s/it]Task 0, Epoch 26/50 => Loss 0.065, Train_accy 97.72, Test_accy 99.05:  52%|█████▏    | 26/50 [07:22<06:47, 16.99s/it]Task 0, Epoch 27/50 => Loss 0.072, Train_accy 97.53, Test_accy 99.05:  52%|█████▏    | 26/50 [07:39<06:47, 16.99s/it]Task 0, Epoch 27/50 => Loss 0.072, Train_accy 97.53, Test_accy 99.05:  54%|█████▍    | 27/50 [07:39<06:32, 17.05s/it]Task 0, Epoch 28/50 => Loss 0.064, Train_accy 97.57, Test_accy 99.15:  54%|█████▍    | 27/50 [07:56<06:32, 17.05s/it]Task 0, Epoch 28/50 => Loss 0.064, Train_accy 97.57, Test_accy 99.15:  56%|█████▌    | 28/50 [07:56<06:13, 16.96s/it]Task 0, Epoch 29/50 => Loss 0.068, Train_accy 97.73, Test_accy 98.95:  56%|█████▌    | 28/50 [08:13<06:13, 16.96s/it]Task 0, Epoch 29/50 => Loss 0.068, Train_accy 97.73, Test_accy 98.95:  58%|█████▊    | 29/50 [08:13<05:56, 16.98s/it]Task 0, Epoch 30/50 => Loss 0.060, Train_accy 97.88, Test_accy 99.15:  58%|█████▊    | 29/50 [08:30<05:56, 16.98s/it]Task 0, Epoch 30/50 => Loss 0.060, Train_accy 97.88, Test_accy 99.15:  60%|██████    | 30/50 [08:30<05:39, 16.98s/it]Task 0, Epoch 31/50 => Loss 0.069, Train_accy 97.62, Test_accy 98.95:  60%|██████    | 30/50 [08:47<05:39, 16.98s/it]Task 0, Epoch 31/50 => Loss 0.069, Train_accy 97.62, Test_accy 98.95:  62%|██████▏   | 31/50 [08:47<05:22, 16.97s/it]Task 0, Epoch 32/50 => Loss 0.066, Train_accy 97.93, Test_accy 99.15:  62%|██████▏   | 31/50 [09:04<05:22, 16.97s/it]Task 0, Epoch 32/50 => Loss 0.066, Train_accy 97.93, Test_accy 99.15:  64%|██████▍   | 32/50 [09:04<05:05, 16.96s/it]Task 0, Epoch 33/50 => Loss 0.060, Train_accy 97.92, Test_accy 98.70:  64%|██████▍   | 32/50 [09:21<05:05, 16.96s/it]Task 0, Epoch 33/50 => Loss 0.060, Train_accy 97.92, Test_accy 98.70:  66%|██████▌   | 33/50 [09:21<04:49, 17.02s/it]Task 0, Epoch 34/50 => Loss 0.062, Train_accy 97.82, Test_accy 99.05:  66%|██████▌   | 33/50 [09:38<04:49, 17.02s/it]Task 0, Epoch 34/50 => Loss 0.062, Train_accy 97.82, Test_accy 99.05:  68%|██████▊   | 34/50 [09:38<04:31, 16.97s/it]Task 0, Epoch 35/50 => Loss 0.064, Train_accy 97.85, Test_accy 99.20:  68%|██████▊   | 34/50 [09:55<04:31, 16.97s/it]Task 0, Epoch 35/50 => Loss 0.064, Train_accy 97.85, Test_accy 99.20:  70%|███████   | 35/50 [09:55<04:15, 17.07s/it]Task 0, Epoch 36/50 => Loss 0.067, Train_accy 97.43, Test_accy 99.00:  70%|███████   | 35/50 [10:13<04:15, 17.07s/it]Task 0, Epoch 36/50 => Loss 0.067, Train_accy 97.43, Test_accy 99.00:  72%|███████▏  | 36/50 [10:13<03:59, 17.13s/it]Task 0, Epoch 37/50 => Loss 0.066, Train_accy 97.72, Test_accy 99.20:  72%|███████▏  | 36/50 [10:30<03:59, 17.13s/it]Task 0, Epoch 37/50 => Loss 0.066, Train_accy 97.72, Test_accy 99.20:  74%|███████▍  | 37/50 [10:30<03:42, 17.14s/it]Task 0, Epoch 38/50 => Loss 0.063, Train_accy 97.77, Test_accy 99.25:  74%|███████▍  | 37/50 [10:47<03:42, 17.14s/it]Task 0, Epoch 38/50 => Loss 0.063, Train_accy 97.77, Test_accy 99.25:  76%|███████▌  | 38/50 [10:47<03:25, 17.14s/it]Task 0, Epoch 39/50 => Loss 0.066, Train_accy 97.70, Test_accy 99.30:  76%|███████▌  | 38/50 [11:05<03:25, 17.14s/it]Task 0, Epoch 39/50 => Loss 0.066, Train_accy 97.70, Test_accy 99.30:  78%|███████▊  | 39/50 [11:05<03:10, 17.30s/it]Task 0, Epoch 40/50 => Loss 0.060, Train_accy 97.95, Test_accy 99.25:  78%|███████▊  | 39/50 [11:22<03:10, 17.30s/it]Task 0, Epoch 40/50 => Loss 0.060, Train_accy 97.95, Test_accy 99.25:  80%|████████  | 40/50 [11:22<02:52, 17.23s/it]Task 0, Epoch 41/50 => Loss 0.062, Train_accy 97.80, Test_accy 99.20:  80%|████████  | 40/50 [11:39<02:52, 17.23s/it]Task 0, Epoch 41/50 => Loss 0.062, Train_accy 97.80, Test_accy 99.20:  82%|████████▏ | 41/50 [11:39<02:34, 17.12s/it]Task 0, Epoch 42/50 => Loss 0.061, Train_accy 97.88, Test_accy 99.10:  82%|████████▏ | 41/50 [11:56<02:34, 17.12s/it]Task 0, Epoch 42/50 => Loss 0.061, Train_accy 97.88, Test_accy 99.10:  84%|████████▍ | 42/50 [11:56<02:17, 17.19s/it]Task 0, Epoch 43/50 => Loss 0.064, Train_accy 97.73, Test_accy 99.15:  84%|████████▍ | 42/50 [12:13<02:17, 17.19s/it]Task 0, Epoch 43/50 => Loss 0.064, Train_accy 97.73, Test_accy 99.15:  86%|████████▌ | 43/50 [12:13<01:59, 17.10s/it]Task 0, Epoch 44/50 => Loss 0.057, Train_accy 97.95, Test_accy 99.25:  86%|████████▌ | 43/50 [12:30<01:59, 17.10s/it]Task 0, Epoch 44/50 => Loss 0.057, Train_accy 97.95, Test_accy 99.25:  88%|████████▊ | 44/50 [12:30<01:42, 17.07s/it]Task 0, Epoch 45/50 => Loss 0.062, Train_accy 98.07, Test_accy 99.20:  88%|████████▊ | 44/50 [12:47<01:42, 17.07s/it]Task 0, Epoch 45/50 => Loss 0.062, Train_accy 98.07, Test_accy 99.20:  90%|█████████ | 45/50 [12:47<01:26, 17.22s/it]Task 0, Epoch 46/50 => Loss 0.060, Train_accy 97.97, Test_accy 99.20:  90%|█████████ | 45/50 [13:05<01:26, 17.22s/it]Task 0, Epoch 46/50 => Loss 0.060, Train_accy 97.97, Test_accy 99.20:  92%|█████████▏| 46/50 [13:05<01:08, 17.20s/it]Task 0, Epoch 47/50 => Loss 0.060, Train_accy 98.00, Test_accy 99.20:  92%|█████████▏| 46/50 [13:22<01:08, 17.20s/it]Task 0, Epoch 47/50 => Loss 0.060, Train_accy 98.00, Test_accy 99.20:  94%|█████████▍| 47/50 [13:22<00:51, 17.18s/it]Task 0, Epoch 48/50 => Loss 0.061, Train_accy 97.93, Test_accy 99.20:  94%|█████████▍| 47/50 [13:39<00:51, 17.18s/it]Task 0, Epoch 48/50 => Loss 0.061, Train_accy 97.93, Test_accy 99.20:  96%|█████████▌| 48/50 [13:39<00:34, 17.15s/it]Task 0, Epoch 49/50 => Loss 0.063, Train_accy 97.75, Test_accy 99.20:  96%|█████████▌| 48/50 [13:56<00:34, 17.15s/it]Task 0, Epoch 49/50 => Loss 0.063, Train_accy 97.75, Test_accy 99.20:  98%|█████████▊| 49/50 [13:56<00:17, 17.12s/it]Task 0, Epoch 50/50 => Loss 0.063, Train_accy 97.97, Test_accy 99.20:  98%|█████████▊| 49/50 [14:13<00:17, 17.12s/it]Task 0, Epoch 50/50 => Loss 0.063, Train_accy 97.97, Test_accy 99.20: 100%|██████████| 50/50 [14:13<00:00, 17.06s/it]Task 0, Epoch 50/50 => Loss 0.063, Train_accy 97.97, Test_accy 99.20: 100%|██████████| 50/50 [14:13<00:00, 17.07s/it]
2024-06-13 10:20:15,805 [lora_prompt.py] => Task 0, Epoch 50/50 => Loss 0.063, Train_accy 97.97, Test_accy 99.20
2024-06-13 10:20:47,823 [lora_prompt.py] => Exemplar size: 0
2024-06-13 10:20:47,823 [trainer.py] => CNN: {'total': 99.2, '00-01': 99.2, 'old': 0, 'new': 99.2}
2024-06-13 10:20:47,823 [trainer.py] => CNN top1 curve: [99.2]
2024-06-13 10:20:47,827 [trainer.py] => All params: 581646337
2024-06-13 10:20:47,831 [trainer.py] => Trainable params: 204800
2024-06-13 10:20:47,831 [lora_prompt.py] => Learning on 2-4
Parameters to be updated: {'lora_image_model_pool.1.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'classifier_pool.1.ctx', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight'},count:204800
  0%|          | 0/30 [00:00<?, ?it/s]Task 1, Epoch 1/30 => Loss 0.651, Train_accy 62.62, Test_accy 77.21:   0%|          | 0/30 [00:13<?, ?it/s]Task 1, Epoch 1/30 => Loss 0.651, Train_accy 62.62, Test_accy 77.21:   3%|▎         | 1/30 [00:13<06:18, 13.06s/it]Task 1, Epoch 2/30 => Loss 0.500, Train_accy 73.54, Test_accy 89.14:   3%|▎         | 1/30 [00:26<06:18, 13.06s/it]Task 1, Epoch 2/30 => Loss 0.500, Train_accy 73.54, Test_accy 89.14:   7%|▋         | 2/30 [00:26<06:03, 12.99s/it]Task 1, Epoch 3/30 => Loss 0.337, Train_accy 85.17, Test_accy 93.11:   7%|▋         | 2/30 [00:38<06:03, 12.99s/it]Task 1, Epoch 3/30 => Loss 0.337, Train_accy 85.17, Test_accy 93.11:  10%|█         | 3/30 [00:38<05:45, 12.79s/it]Task 1, Epoch 4/30 => Loss 0.286, Train_accy 87.96, Test_accy 93.79:  10%|█         | 3/30 [00:51<05:45, 12.79s/it]Task 1, Epoch 4/30 => Loss 0.286, Train_accy 87.96, Test_accy 93.79:  13%|█▎        | 4/30 [00:51<05:30, 12.71s/it]Task 1, Epoch 5/30 => Loss 0.274, Train_accy 87.08, Test_accy 94.07:  13%|█▎        | 4/30 [01:03<05:30, 12.71s/it]Task 1, Epoch 5/30 => Loss 0.274, Train_accy 87.08, Test_accy 94.07:  17%|█▋        | 5/30 [01:03<05:17, 12.70s/it]Task 1, Epoch 6/30 => Loss 0.243, Train_accy 90.38, Test_accy 93.93:  17%|█▋        | 5/30 [01:16<05:17, 12.70s/it]Task 1, Epoch 6/30 => Loss 0.243, Train_accy 90.38, Test_accy 93.93:  20%|██        | 6/30 [01:16<05:04, 12.69s/it]Task 1, Epoch 7/30 => Loss 0.233, Train_accy 91.25, Test_accy 94.96:  20%|██        | 6/30 [01:29<05:04, 12.69s/it]Task 1, Epoch 7/30 => Loss 0.233, Train_accy 91.25, Test_accy 94.96:  23%|██▎       | 7/30 [01:29<04:51, 12.66s/it]Task 1, Epoch 8/30 => Loss 0.226, Train_accy 91.21, Test_accy 94.43:  23%|██▎       | 7/30 [01:41<04:51, 12.66s/it]Task 1, Epoch 8/30 => Loss 0.226, Train_accy 91.21, Test_accy 94.43:  27%|██▋       | 8/30 [01:41<04:35, 12.53s/it]Task 1, Epoch 9/30 => Loss 0.226, Train_accy 90.88, Test_accy 94.18:  27%|██▋       | 8/30 [01:53<04:35, 12.53s/it]Task 1, Epoch 9/30 => Loss 0.226, Train_accy 90.88, Test_accy 94.18:  30%|███       | 9/30 [01:53<04:23, 12.56s/it]Task 1, Epoch 10/30 => Loss 0.204, Train_accy 91.79, Test_accy 95.21:  30%|███       | 9/30 [02:06<04:23, 12.56s/it]Task 1, Epoch 10/30 => Loss 0.204, Train_accy 91.79, Test_accy 95.21:  33%|███▎      | 10/30 [02:06<04:13, 12.65s/it]Task 1, Epoch 11/30 => Loss 0.195, Train_accy 92.67, Test_accy 94.86:  33%|███▎      | 10/30 [02:19<04:13, 12.65s/it]Task 1, Epoch 11/30 => Loss 0.195, Train_accy 92.67, Test_accy 94.86:  37%|███▋      | 11/30 [02:19<04:00, 12.66s/it]Task 1, Epoch 12/30 => Loss 0.217, Train_accy 90.92, Test_accy 95.21:  37%|███▋      | 11/30 [02:32<04:00, 12.66s/it]Task 1, Epoch 12/30 => Loss 0.217, Train_accy 90.92, Test_accy 95.21:  40%|████      | 12/30 [02:32<03:47, 12.63s/it]Task 1, Epoch 13/30 => Loss 0.200, Train_accy 91.92, Test_accy 95.50:  40%|████      | 12/30 [02:44<03:47, 12.63s/it]Task 1, Epoch 13/30 => Loss 0.200, Train_accy 91.92, Test_accy 95.50:  43%|████▎     | 13/30 [02:44<03:35, 12.67s/it]Task 1, Epoch 14/30 => Loss 0.192, Train_accy 93.04, Test_accy 94.54:  43%|████▎     | 13/30 [02:57<03:35, 12.67s/it]Task 1, Epoch 14/30 => Loss 0.192, Train_accy 93.04, Test_accy 94.54:  47%|████▋     | 14/30 [02:57<03:22, 12.66s/it]Task 1, Epoch 15/30 => Loss 0.198, Train_accy 92.46, Test_accy 95.32:  47%|████▋     | 14/30 [03:10<03:22, 12.66s/it]Task 1, Epoch 15/30 => Loss 0.198, Train_accy 92.46, Test_accy 95.32:  50%|█████     | 15/30 [03:10<03:10, 12.73s/it]Task 1, Epoch 16/30 => Loss 0.199, Train_accy 92.62, Test_accy 95.00:  50%|█████     | 15/30 [03:22<03:10, 12.73s/it]Task 1, Epoch 16/30 => Loss 0.199, Train_accy 92.62, Test_accy 95.00:  53%|█████▎    | 16/30 [03:22<02:57, 12.66s/it]Task 1, Epoch 17/30 => Loss 0.187, Train_accy 93.12, Test_accy 95.39:  53%|█████▎    | 16/30 [03:35<02:57, 12.66s/it]Task 1, Epoch 17/30 => Loss 0.187, Train_accy 93.12, Test_accy 95.39:  57%|█████▋    | 17/30 [03:35<02:44, 12.68s/it]Task 1, Epoch 18/30 => Loss 0.203, Train_accy 91.92, Test_accy 95.50:  57%|█████▋    | 17/30 [03:48<02:44, 12.68s/it]Task 1, Epoch 18/30 => Loss 0.203, Train_accy 91.92, Test_accy 95.50:  60%|██████    | 18/30 [03:48<02:31, 12.64s/it]Task 1, Epoch 19/30 => Loss 0.183, Train_accy 93.42, Test_accy 95.71:  60%|██████    | 18/30 [04:01<02:31, 12.64s/it]Task 1, Epoch 19/30 => Loss 0.183, Train_accy 93.42, Test_accy 95.71:  63%|██████▎   | 19/30 [04:01<02:19, 12.72s/it]Task 1, Epoch 20/30 => Loss 0.178, Train_accy 93.50, Test_accy 95.25:  63%|██████▎   | 19/30 [04:13<02:19, 12.72s/it]Task 1, Epoch 20/30 => Loss 0.178, Train_accy 93.50, Test_accy 95.25:  67%|██████▋   | 20/30 [04:13<02:07, 12.78s/it]Task 1, Epoch 21/30 => Loss 0.176, Train_accy 93.38, Test_accy 95.18:  67%|██████▋   | 20/30 [04:26<02:07, 12.78s/it]Task 1, Epoch 21/30 => Loss 0.176, Train_accy 93.38, Test_accy 95.18:  70%|███████   | 21/30 [04:26<01:54, 12.72s/it]Task 1, Epoch 22/30 => Loss 0.177, Train_accy 93.25, Test_accy 95.07:  70%|███████   | 21/30 [04:39<01:54, 12.72s/it]Task 1, Epoch 22/30 => Loss 0.177, Train_accy 93.25, Test_accy 95.07:  73%|███████▎  | 22/30 [04:39<01:41, 12.69s/it]Task 1, Epoch 23/30 => Loss 0.178, Train_accy 93.33, Test_accy 95.14:  73%|███████▎  | 22/30 [04:51<01:41, 12.69s/it]Task 1, Epoch 23/30 => Loss 0.178, Train_accy 93.33, Test_accy 95.14:  77%|███████▋  | 23/30 [04:51<01:29, 12.72s/it]Task 1, Epoch 24/30 => Loss 0.175, Train_accy 93.00, Test_accy 95.00:  77%|███████▋  | 23/30 [05:04<01:29, 12.72s/it]Task 1, Epoch 24/30 => Loss 0.175, Train_accy 93.00, Test_accy 95.00:  80%|████████  | 24/30 [05:04<01:16, 12.75s/it]Task 1, Epoch 25/30 => Loss 0.178, Train_accy 93.46, Test_accy 95.04:  80%|████████  | 24/30 [05:17<01:16, 12.75s/it]Task 1, Epoch 25/30 => Loss 0.178, Train_accy 93.46, Test_accy 95.04:  83%|████████▎ | 25/30 [05:17<01:03, 12.70s/it]Task 1, Epoch 26/30 => Loss 0.172, Train_accy 93.83, Test_accy 95.14:  83%|████████▎ | 25/30 [05:29<01:03, 12.70s/it]Task 1, Epoch 26/30 => Loss 0.172, Train_accy 93.83, Test_accy 95.14:  87%|████████▋ | 26/30 [05:29<00:50, 12.67s/it]Task 1, Epoch 27/30 => Loss 0.179, Train_accy 93.54, Test_accy 95.32:  87%|████████▋ | 26/30 [05:42<00:50, 12.67s/it]Task 1, Epoch 27/30 => Loss 0.179, Train_accy 93.54, Test_accy 95.32:  90%|█████████ | 27/30 [05:42<00:38, 12.73s/it]Task 1, Epoch 28/30 => Loss 0.160, Train_accy 93.96, Test_accy 95.18:  90%|█████████ | 27/30 [05:55<00:38, 12.73s/it]Task 1, Epoch 28/30 => Loss 0.160, Train_accy 93.96, Test_accy 95.18:  93%|█████████▎| 28/30 [05:55<00:25, 12.73s/it]Task 1, Epoch 29/30 => Loss 0.176, Train_accy 93.04, Test_accy 95.21:  93%|█████████▎| 28/30 [06:08<00:25, 12.73s/it]Task 1, Epoch 29/30 => Loss 0.176, Train_accy 93.04, Test_accy 95.21:  97%|█████████▋| 29/30 [06:08<00:12, 12.71s/it]Task 1, Epoch 30/30 => Loss 0.157, Train_accy 94.50, Test_accy 95.18:  97%|█████████▋| 29/30 [06:20<00:12, 12.71s/it]Task 1, Epoch 30/30 => Loss 0.157, Train_accy 94.50, Test_accy 95.18: 100%|██████████| 30/30 [06:20<00:00, 12.72s/it]Task 1, Epoch 30/30 => Loss 0.157, Train_accy 94.50, Test_accy 95.18: 100%|██████████| 30/30 [06:20<00:00, 12.70s/it]
2024-06-13 10:27:08,829 [lora_prompt.py] => Task 1, Epoch 30/30 => Loss 0.157, Train_accy 94.50, Test_accy 95.18
2024-06-13 10:27:43,833 [lora_prompt.py] => Exemplar size: 0
2024-06-13 10:27:43,833 [trainer.py] => CNN: {'total': 97.29, '00-01': 98.75, '02-03': 93.62, 'old': 98.75, 'new': 93.62}
2024-06-13 10:27:43,833 [trainer.py] => CNN top1 curve: [99.2, 97.29]
2024-06-13 10:27:43,838 [trainer.py] => All params: 581646337
2024-06-13 10:27:43,842 [trainer.py] => Trainable params: 204800
2024-06-13 10:27:43,842 [lora_prompt.py] => Learning on 4-6
Parameters to be updated: {'lora_image_model_pool.2.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'classifier_pool.2.ctx', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight'},count:204800
  0%|          | 0/30 [00:00<?, ?it/s]Task 2, Epoch 1/30 => Loss 0.669, Train_accy 58.36, Test_accy 57.21:   0%|          | 0/30 [00:21<?, ?it/s]Task 2, Epoch 1/30 => Loss 0.669, Train_accy 58.36, Test_accy 57.21:   3%|▎         | 1/30 [00:21<10:11, 21.07s/it]Task 2, Epoch 2/30 => Loss 0.630, Train_accy 64.56, Test_accy 58.77:   3%|▎         | 1/30 [00:42<10:11, 21.07s/it]Task 2, Epoch 2/30 => Loss 0.630, Train_accy 64.56, Test_accy 58.77:   7%|▋         | 2/30 [00:42<09:50, 21.10s/it]Task 2, Epoch 3/30 => Loss 0.601, Train_accy 67.19, Test_accy 59.65:   7%|▋         | 2/30 [01:02<09:50, 21.10s/it]Task 2, Epoch 3/30 => Loss 0.601, Train_accy 67.19, Test_accy 59.65:  10%|█         | 3/30 [01:02<09:25, 20.96s/it]Task 2, Epoch 4/30 => Loss 0.576, Train_accy 69.22, Test_accy 61.90:  10%|█         | 3/30 [01:24<09:25, 20.96s/it]Task 2, Epoch 4/30 => Loss 0.576, Train_accy 69.22, Test_accy 61.90:  13%|█▎        | 4/30 [01:24<09:10, 21.19s/it]Task 2, Epoch 5/30 => Loss 0.562, Train_accy 70.72, Test_accy 63.48:  13%|█▎        | 4/30 [01:45<09:10, 21.19s/it]Task 2, Epoch 5/30 => Loss 0.562, Train_accy 70.72, Test_accy 63.48:  17%|█▋        | 5/30 [01:45<08:49, 21.18s/it]Task 2, Epoch 6/30 => Loss 0.552, Train_accy 71.26, Test_accy 63.36:  17%|█▋        | 5/30 [02:06<08:49, 21.18s/it]Task 2, Epoch 6/30 => Loss 0.552, Train_accy 71.26, Test_accy 63.36:  20%|██        | 6/30 [02:06<08:28, 21.19s/it]Task 2, Epoch 7/30 => Loss 0.564, Train_accy 69.91, Test_accy 63.93:  20%|██        | 6/30 [02:28<08:28, 21.19s/it]Task 2, Epoch 7/30 => Loss 0.564, Train_accy 69.91, Test_accy 63.93:  23%|██▎       | 7/30 [02:28<08:10, 21.31s/it]Task 2, Epoch 8/30 => Loss 0.542, Train_accy 72.29, Test_accy 65.08:  23%|██▎       | 7/30 [02:49<08:10, 21.31s/it]Task 2, Epoch 8/30 => Loss 0.542, Train_accy 72.29, Test_accy 65.08:  27%|██▋       | 8/30 [02:49<07:48, 21.30s/it]Task 2, Epoch 9/30 => Loss 0.542, Train_accy 72.63, Test_accy 65.02:  27%|██▋       | 8/30 [03:11<07:48, 21.30s/it]Task 2, Epoch 9/30 => Loss 0.542, Train_accy 72.63, Test_accy 65.02:  30%|███       | 9/30 [03:11<07:29, 21.43s/it]Task 2, Epoch 10/30 => Loss 0.530, Train_accy 72.71, Test_accy 66.65:  30%|███       | 9/30 [03:32<07:29, 21.43s/it]Task 2, Epoch 10/30 => Loss 0.530, Train_accy 72.71, Test_accy 66.65:  33%|███▎      | 10/30 [03:32<07:06, 21.31s/it]Task 2, Epoch 11/30 => Loss 0.524, Train_accy 73.08, Test_accy 65.62:  33%|███▎      | 10/30 [03:54<07:06, 21.31s/it]Task 2, Epoch 11/30 => Loss 0.524, Train_accy 73.08, Test_accy 65.62:  37%|███▋      | 11/30 [03:54<06:46, 21.37s/it]Task 2, Epoch 12/30 => Loss 0.519, Train_accy 74.34, Test_accy 65.62:  37%|███▋      | 11/30 [04:15<06:46, 21.37s/it]Task 2, Epoch 12/30 => Loss 0.519, Train_accy 74.34, Test_accy 65.62:  40%|████      | 12/30 [04:15<06:23, 21.30s/it]Task 2, Epoch 13/30 => Loss 0.522, Train_accy 74.02, Test_accy 67.49:  40%|████      | 12/30 [04:36<06:23, 21.30s/it]Task 2, Epoch 13/30 => Loss 0.522, Train_accy 74.02, Test_accy 67.49:  43%|████▎     | 13/30 [04:36<06:01, 21.24s/it]Task 2, Epoch 14/30 => Loss 0.516, Train_accy 74.58, Test_accy 68.50:  43%|████▎     | 13/30 [04:57<06:01, 21.24s/it]Task 2, Epoch 14/30 => Loss 0.516, Train_accy 74.58, Test_accy 68.50:  47%|████▋     | 14/30 [04:57<05:41, 21.31s/it]Task 2, Epoch 15/30 => Loss 0.532, Train_accy 73.34, Test_accy 66.85:  47%|████▋     | 14/30 [05:18<05:41, 21.31s/it]Task 2, Epoch 15/30 => Loss 0.532, Train_accy 73.34, Test_accy 66.85:  50%|█████     | 15/30 [05:18<05:18, 21.26s/it]Task 2, Epoch 16/30 => Loss 0.520, Train_accy 73.94, Test_accy 68.23:  50%|█████     | 15/30 [05:39<05:18, 21.26s/it]Task 2, Epoch 16/30 => Loss 0.520, Train_accy 73.94, Test_accy 68.23:  53%|█████▎    | 16/30 [05:39<04:57, 21.22s/it]Task 2, Epoch 17/30 => Loss 0.518, Train_accy 73.81, Test_accy 68.25:  53%|█████▎    | 16/30 [06:01<04:57, 21.22s/it]Task 2, Epoch 17/30 => Loss 0.518, Train_accy 73.81, Test_accy 68.25:  57%|█████▋    | 17/30 [06:01<04:35, 21.20s/it]Task 2, Epoch 18/30 => Loss 0.511, Train_accy 74.28, Test_accy 68.17:  57%|█████▋    | 17/30 [06:22<04:35, 21.20s/it]Task 2, Epoch 18/30 => Loss 0.511, Train_accy 74.28, Test_accy 68.17:  60%|██████    | 18/30 [06:22<04:15, 21.28s/it]Task 2, Epoch 19/30 => Loss 0.511, Train_accy 74.26, Test_accy 67.45:  60%|██████    | 18/30 [06:44<04:15, 21.28s/it]Task 2, Epoch 19/30 => Loss 0.511, Train_accy 74.26, Test_accy 67.45:  63%|██████▎   | 19/30 [06:44<03:54, 21.32s/it]Task 2, Epoch 20/30 => Loss 0.504, Train_accy 75.02, Test_accy 67.12:  63%|██████▎   | 19/30 [07:05<03:54, 21.32s/it]Task 2, Epoch 20/30 => Loss 0.504, Train_accy 75.02, Test_accy 67.12:  67%|██████▋   | 20/30 [07:05<03:33, 21.33s/it]Task 2, Epoch 21/30 => Loss 0.502, Train_accy 74.81, Test_accy 69.28:  67%|██████▋   | 20/30 [07:26<03:33, 21.33s/it]Task 2, Epoch 21/30 => Loss 0.502, Train_accy 74.81, Test_accy 69.28:  70%|███████   | 21/30 [07:26<03:11, 21.31s/it]Task 2, Epoch 22/30 => Loss 0.499, Train_accy 75.61, Test_accy 68.00:  70%|███████   | 21/30 [07:47<03:11, 21.31s/it]Task 2, Epoch 22/30 => Loss 0.499, Train_accy 75.61, Test_accy 68.00:  73%|███████▎  | 22/30 [07:47<02:50, 21.26s/it]Task 2, Epoch 23/30 => Loss 0.497, Train_accy 75.34, Test_accy 68.62:  73%|███████▎  | 22/30 [08:09<02:50, 21.26s/it]Task 2, Epoch 23/30 => Loss 0.497, Train_accy 75.34, Test_accy 68.62:  77%|███████▋  | 23/30 [08:09<02:29, 21.31s/it]Task 2, Epoch 24/30 => Loss 0.497, Train_accy 75.24, Test_accy 68.39:  77%|███████▋  | 23/30 [08:30<02:29, 21.31s/it]Task 2, Epoch 24/30 => Loss 0.497, Train_accy 75.24, Test_accy 68.39:  80%|████████  | 24/30 [08:30<02:08, 21.35s/it]Task 2, Epoch 25/30 => Loss 0.499, Train_accy 75.37, Test_accy 69.01:  80%|████████  | 24/30 [08:52<02:08, 21.35s/it]Task 2, Epoch 25/30 => Loss 0.499, Train_accy 75.37, Test_accy 69.01:  83%|████████▎ | 25/30 [08:52<01:46, 21.40s/it]Task 2, Epoch 26/30 => Loss 0.494, Train_accy 75.71, Test_accy 68.54:  83%|████████▎ | 25/30 [09:13<01:46, 21.40s/it]Task 2, Epoch 26/30 => Loss 0.494, Train_accy 75.71, Test_accy 68.54:  87%|████████▋ | 26/30 [09:13<01:25, 21.43s/it]Task 2, Epoch 27/30 => Loss 0.496, Train_accy 75.23, Test_accy 68.56:  87%|████████▋ | 26/30 [09:35<01:25, 21.43s/it]Task 2, Epoch 27/30 => Loss 0.496, Train_accy 75.23, Test_accy 68.56:  90%|█████████ | 27/30 [09:35<01:04, 21.44s/it]Task 2, Epoch 28/30 => Loss 0.493, Train_accy 76.21, Test_accy 68.54:  90%|█████████ | 27/30 [09:57<01:04, 21.44s/it]Task 2, Epoch 28/30 => Loss 0.493, Train_accy 76.21, Test_accy 68.54:  93%|█████████▎| 28/30 [09:57<00:43, 21.73s/it]Task 2, Epoch 29/30 => Loss 0.488, Train_accy 75.79, Test_accy 68.74:  93%|█████████▎| 28/30 [10:19<00:43, 21.73s/it]Task 2, Epoch 29/30 => Loss 0.488, Train_accy 75.79, Test_accy 68.74:  97%|█████████▋| 29/30 [10:19<00:21, 21.65s/it]Task 2, Epoch 30/30 => Loss 0.493, Train_accy 75.76, Test_accy 68.76:  97%|█████████▋| 29/30 [10:40<00:21, 21.65s/it]Task 2, Epoch 30/30 => Loss 0.493, Train_accy 75.76, Test_accy 68.76: 100%|██████████| 30/30 [10:40<00:00, 21.50s/it]Task 2, Epoch 30/30 => Loss 0.493, Train_accy 75.76, Test_accy 68.76: 100%|██████████| 30/30 [10:40<00:00, 21.34s/it]
2024-06-13 10:38:24,055 [lora_prompt.py] => Task 2, Epoch 30/30 => Loss 0.493, Train_accy 75.76, Test_accy 68.76
2024-06-13 10:39:25,258 [lora_prompt.py] => Exemplar size: 0
2024-06-13 10:39:25,258 [trainer.py] => CNN: {'total': 88.81, '00-01': 98.75, '02-03': 93.62, '04-05': 77.31, 'old': 97.29, 'new': 77.31}
2024-06-13 10:39:25,259 [trainer.py] => CNN top1 curve: [99.2, 97.29, 88.81]
2024-06-13 10:39:25,263 [trainer.py] => All params: 581646337
2024-06-13 10:39:25,266 [trainer.py] => Trainable params: 204800
2024-06-13 10:39:25,267 [lora_prompt.py] => Learning on 6-8
Parameters to be updated: {'lora_image_model_pool.3.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'classifier_pool.3.ctx', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight'},count:204800
  0%|          | 0/30 [00:00<?, ?it/s]Task 3, Epoch 1/30 => Loss 0.675, Train_accy 60.00, Test_accy 56.36:   0%|          | 0/30 [00:20<?, ?it/s]Task 3, Epoch 1/30 => Loss 0.675, Train_accy 60.00, Test_accy 56.36:   3%|▎         | 1/30 [00:20<10:04, 20.83s/it]Task 3, Epoch 2/30 => Loss 0.658, Train_accy 60.33, Test_accy 53.81:   3%|▎         | 1/30 [00:41<10:04, 20.83s/it]Task 3, Epoch 2/30 => Loss 0.658, Train_accy 60.33, Test_accy 53.81:   7%|▋         | 2/30 [00:41<09:39, 20.71s/it]Task 3, Epoch 3/30 => Loss 0.630, Train_accy 65.08, Test_accy 53.64:   7%|▋         | 2/30 [01:01<09:39, 20.71s/it]Task 3, Epoch 3/30 => Loss 0.630, Train_accy 65.08, Test_accy 53.64:  10%|█         | 3/30 [01:01<09:14, 20.52s/it]Task 3, Epoch 4/30 => Loss 0.554, Train_accy 71.00, Test_accy 55.98:  10%|█         | 3/30 [01:22<09:14, 20.52s/it]Task 3, Epoch 4/30 => Loss 0.554, Train_accy 71.00, Test_accy 55.98:  13%|█▎        | 4/30 [01:22<08:53, 20.54s/it]Task 3, Epoch 5/30 => Loss 0.533, Train_accy 73.25, Test_accy 61.14:  13%|█▎        | 4/30 [01:42<08:53, 20.54s/it]Task 3, Epoch 5/30 => Loss 0.533, Train_accy 73.25, Test_accy 61.14:  17%|█▋        | 5/30 [01:42<08:31, 20.47s/it]Task 3, Epoch 6/30 => Loss 0.456, Train_accy 77.83, Test_accy 62.53:  17%|█▋        | 5/30 [02:03<08:31, 20.47s/it]Task 3, Epoch 6/30 => Loss 0.456, Train_accy 77.83, Test_accy 62.53:  20%|██        | 6/30 [02:03<08:14, 20.60s/it]Task 3, Epoch 7/30 => Loss 0.423, Train_accy 81.00, Test_accy 62.51:  20%|██        | 6/30 [02:23<08:14, 20.60s/it]Task 3, Epoch 7/30 => Loss 0.423, Train_accy 81.00, Test_accy 62.51:  23%|██▎       | 7/30 [02:23<07:51, 20.52s/it]Task 3, Epoch 8/30 => Loss 0.410, Train_accy 80.08, Test_accy 62.76:  23%|██▎       | 7/30 [02:44<07:51, 20.52s/it]Task 3, Epoch 8/30 => Loss 0.410, Train_accy 80.08, Test_accy 62.76:  27%|██▋       | 8/30 [02:44<07:34, 20.66s/it]Task 3, Epoch 9/30 => Loss 0.371, Train_accy 82.58, Test_accy 66.90:  27%|██▋       | 8/30 [03:05<07:34, 20.66s/it]Task 3, Epoch 9/30 => Loss 0.371, Train_accy 82.58, Test_accy 66.90:  30%|███       | 9/30 [03:05<07:13, 20.64s/it]Task 3, Epoch 10/30 => Loss 0.348, Train_accy 84.42, Test_accy 63.67:  30%|███       | 9/30 [03:25<07:13, 20.64s/it]Task 3, Epoch 10/30 => Loss 0.348, Train_accy 84.42, Test_accy 63.67:  33%|███▎      | 10/30 [03:25<06:48, 20.43s/it]Task 3, Epoch 11/30 => Loss 0.363, Train_accy 85.00, Test_accy 63.08:  33%|███▎      | 10/30 [03:45<06:48, 20.43s/it]Task 3, Epoch 11/30 => Loss 0.363, Train_accy 85.00, Test_accy 63.08:  37%|███▋      | 11/30 [03:45<06:24, 20.23s/it]Task 3, Epoch 12/30 => Loss 0.352, Train_accy 83.25, Test_accy 68.44:  37%|███▋      | 11/30 [04:05<06:24, 20.23s/it]Task 3, Epoch 12/30 => Loss 0.352, Train_accy 83.25, Test_accy 68.44:  40%|████      | 12/30 [04:05<06:04, 20.25s/it]Task 3, Epoch 13/30 => Loss 0.329, Train_accy 85.25, Test_accy 68.12:  40%|████      | 12/30 [04:26<06:04, 20.25s/it]Task 3, Epoch 13/30 => Loss 0.329, Train_accy 85.25, Test_accy 68.12:  43%|████▎     | 13/30 [04:26<05:45, 20.34s/it]Task 3, Epoch 14/30 => Loss 0.329, Train_accy 85.25, Test_accy 65.21:  43%|████▎     | 13/30 [04:46<05:45, 20.34s/it]Task 3, Epoch 14/30 => Loss 0.329, Train_accy 85.25, Test_accy 65.21:  47%|████▋     | 14/30 [04:46<05:24, 20.27s/it]Task 3, Epoch 15/30 => Loss 0.325, Train_accy 85.75, Test_accy 65.93:  47%|████▋     | 14/30 [05:06<05:24, 20.27s/it]Task 3, Epoch 15/30 => Loss 0.325, Train_accy 85.75, Test_accy 65.93:  50%|█████     | 15/30 [05:06<05:05, 20.39s/it]Task 3, Epoch 16/30 => Loss 0.299, Train_accy 86.00, Test_accy 64.58:  50%|█████     | 15/30 [05:26<05:05, 20.39s/it]Task 3, Epoch 16/30 => Loss 0.299, Train_accy 86.00, Test_accy 64.58:  53%|█████▎    | 16/30 [05:26<04:43, 20.28s/it]Task 3, Epoch 17/30 => Loss 0.284, Train_accy 87.83, Test_accy 68.74:  53%|█████▎    | 16/30 [05:47<04:43, 20.28s/it]Task 3, Epoch 17/30 => Loss 0.284, Train_accy 87.83, Test_accy 68.74:  57%|█████▋    | 17/30 [05:47<04:24, 20.33s/it]Task 3, Epoch 18/30 => Loss 0.307, Train_accy 86.08, Test_accy 65.80:  57%|█████▋    | 17/30 [06:07<04:24, 20.33s/it]Task 3, Epoch 18/30 => Loss 0.307, Train_accy 86.08, Test_accy 65.80:  60%|██████    | 18/30 [06:07<04:03, 20.31s/it]Task 3, Epoch 19/30 => Loss 0.298, Train_accy 87.58, Test_accy 69.60:  60%|██████    | 18/30 [06:27<04:03, 20.31s/it]Task 3, Epoch 19/30 => Loss 0.298, Train_accy 87.58, Test_accy 69.60:  63%|██████▎   | 19/30 [06:27<03:42, 20.19s/it]Task 3, Epoch 20/30 => Loss 0.273, Train_accy 88.25, Test_accy 67.47:  63%|██████▎   | 19/30 [06:47<03:42, 20.19s/it]Task 3, Epoch 20/30 => Loss 0.273, Train_accy 88.25, Test_accy 67.47:  67%|██████▋   | 20/30 [06:47<03:20, 20.07s/it]Task 3, Epoch 21/30 => Loss 0.282, Train_accy 89.17, Test_accy 67.62:  67%|██████▋   | 20/30 [07:07<03:20, 20.07s/it]Task 3, Epoch 21/30 => Loss 0.282, Train_accy 89.17, Test_accy 67.62:  70%|███████   | 21/30 [07:07<03:00, 20.05s/it]Task 3, Epoch 22/30 => Loss 0.252, Train_accy 89.67, Test_accy 69.77:  70%|███████   | 21/30 [07:27<03:00, 20.05s/it]Task 3, Epoch 22/30 => Loss 0.252, Train_accy 89.67, Test_accy 69.77:  73%|███████▎  | 22/30 [07:27<02:40, 20.06s/it]Task 3, Epoch 23/30 => Loss 0.260, Train_accy 89.25, Test_accy 67.81:  73%|███████▎  | 22/30 [07:47<02:40, 20.06s/it]Task 3, Epoch 23/30 => Loss 0.260, Train_accy 89.25, Test_accy 67.81:  77%|███████▋  | 23/30 [07:47<02:19, 19.98s/it]Task 3, Epoch 24/30 => Loss 0.259, Train_accy 89.08, Test_accy 68.35:  77%|███████▋  | 23/30 [08:06<02:19, 19.98s/it]Task 3, Epoch 24/30 => Loss 0.259, Train_accy 89.08, Test_accy 68.35:  80%|████████  | 24/30 [08:06<01:59, 19.93s/it]Task 3, Epoch 25/30 => Loss 0.254, Train_accy 89.58, Test_accy 68.71:  80%|████████  | 24/30 [08:27<01:59, 19.93s/it]Task 3, Epoch 25/30 => Loss 0.254, Train_accy 89.58, Test_accy 68.71:  83%|████████▎ | 25/30 [08:27<01:40, 20.03s/it]Task 3, Epoch 26/30 => Loss 0.242, Train_accy 89.50, Test_accy 68.52:  83%|████████▎ | 25/30 [08:47<01:40, 20.03s/it]Task 3, Epoch 26/30 => Loss 0.242, Train_accy 89.50, Test_accy 68.52:  87%|████████▋ | 26/30 [08:47<01:20, 20.03s/it]Task 3, Epoch 27/30 => Loss 0.232, Train_accy 90.92, Test_accy 68.73:  87%|████████▋ | 26/30 [09:07<01:20, 20.03s/it]Task 3, Epoch 27/30 => Loss 0.232, Train_accy 90.92, Test_accy 68.73:  90%|█████████ | 27/30 [09:07<01:00, 20.06s/it]Task 3, Epoch 28/30 => Loss 0.256, Train_accy 90.17, Test_accy 68.67:  90%|█████████ | 27/30 [09:28<01:00, 20.06s/it]Task 3, Epoch 28/30 => Loss 0.256, Train_accy 90.17, Test_accy 68.67:  93%|█████████▎| 28/30 [09:28<00:40, 20.29s/it]Task 3, Epoch 29/30 => Loss 0.236, Train_accy 91.33, Test_accy 68.61:  93%|█████████▎| 28/30 [09:48<00:40, 20.29s/it]Task 3, Epoch 29/30 => Loss 0.236, Train_accy 91.33, Test_accy 68.61:  97%|█████████▋| 29/30 [09:48<00:20, 20.37s/it]Task 3, Epoch 30/30 => Loss 0.239, Train_accy 90.42, Test_accy 68.67:  97%|█████████▋| 29/30 [10:09<00:20, 20.37s/it]Task 3, Epoch 30/30 => Loss 0.239, Train_accy 90.42, Test_accy 68.67: 100%|██████████| 30/30 [10:09<00:00, 20.39s/it]Task 3, Epoch 30/30 => Loss 0.239, Train_accy 90.42, Test_accy 68.67: 100%|██████████| 30/30 [10:09<00:00, 20.30s/it]
2024-06-13 10:49:34,469 [lora_prompt.py] => Task 3, Epoch 30/30 => Loss 0.239, Train_accy 90.42, Test_accy 68.67
2024-06-13 10:50:37,117 [lora_prompt.py] => Exemplar size: 0
2024-06-13 10:50:37,118 [trainer.py] => CNN: {'total': 88.6, '00-01': 98.8, '02-03': 93.38, '04-05': 77.31, '06-07': 86.25, 'old': 88.79, 'new': 86.25}
2024-06-13 10:50:37,118 [trainer.py] => CNN top1 curve: [99.2, 97.29, 88.81, 88.6]
2024-06-13 10:50:37,122 [trainer.py] => All params: 581646337
2024-06-13 10:50:37,125 [trainer.py] => Trainable params: 204800
2024-06-13 10:50:37,125 [lora_prompt.py] => Learning on 8-10
Parameters to be updated: {'lora_image_model_pool.4.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'classifier_pool.4.ctx'},count:204800
  0%|          | 0/30 [00:00<?, ?it/s]Task 4, Epoch 1/30 => Loss 0.753, Train_accy 49.62, Test_accy 50.48:   0%|          | 0/30 [00:15<?, ?it/s]Task 4, Epoch 1/30 => Loss 0.753, Train_accy 49.62, Test_accy 50.48:   3%|▎         | 1/30 [00:15<07:16, 15.05s/it]Task 4, Epoch 2/30 => Loss 0.758, Train_accy 49.62, Test_accy 54.04:   3%|▎         | 1/30 [00:30<07:16, 15.05s/it]Task 4, Epoch 2/30 => Loss 0.758, Train_accy 49.62, Test_accy 54.04:   7%|▋         | 2/30 [00:30<07:00, 15.02s/it]Task 4, Epoch 3/30 => Loss 0.675, Train_accy 66.54, Test_accy 55.50:   7%|▋         | 2/30 [00:45<07:00, 15.02s/it]Task 4, Epoch 3/30 => Loss 0.675, Train_accy 66.54, Test_accy 55.50:  10%|█         | 3/30 [00:45<06:46, 15.05s/it]Task 4, Epoch 4/30 => Loss 0.676, Train_accy 56.54, Test_accy 54.60:  10%|█         | 3/30 [01:00<06:46, 15.05s/it]Task 4, Epoch 4/30 => Loss 0.676, Train_accy 56.54, Test_accy 54.60:  13%|█▎        | 4/30 [01:00<06:32, 15.11s/it]Task 4, Epoch 5/30 => Loss 0.649, Train_accy 61.54, Test_accy 53.67:  13%|█▎        | 4/30 [01:15<06:32, 15.11s/it]Task 4, Epoch 5/30 => Loss 0.649, Train_accy 61.54, Test_accy 53.67:  17%|█▋        | 5/30 [01:15<06:16, 15.04s/it]Task 4, Epoch 6/30 => Loss 0.666, Train_accy 68.46, Test_accy 52.76:  17%|█▋        | 5/30 [01:30<06:16, 15.04s/it]Task 4, Epoch 6/30 => Loss 0.666, Train_accy 68.46, Test_accy 52.76:  20%|██        | 6/30 [01:30<06:00, 15.03s/it]Task 4, Epoch 7/30 => Loss 0.670, Train_accy 78.46, Test_accy 53.90:  20%|██        | 6/30 [01:45<06:00, 15.03s/it]Task 4, Epoch 7/30 => Loss 0.670, Train_accy 78.46, Test_accy 53.90:  23%|██▎       | 7/30 [01:45<05:46, 15.07s/it]Task 4, Epoch 8/30 => Loss 0.548, Train_accy 75.00, Test_accy 50.78:  23%|██▎       | 7/30 [02:00<05:46, 15.07s/it]Task 4, Epoch 8/30 => Loss 0.548, Train_accy 75.00, Test_accy 50.78:  27%|██▋       | 8/30 [02:00<05:30, 15.02s/it]Task 4, Epoch 9/30 => Loss 0.601, Train_accy 70.38, Test_accy 50.48:  27%|██▋       | 8/30 [02:15<05:30, 15.02s/it]Task 4, Epoch 9/30 => Loss 0.601, Train_accy 70.38, Test_accy 50.48:  30%|███       | 9/30 [02:15<05:16, 15.09s/it]Task 4, Epoch 10/30 => Loss 0.548, Train_accy 71.15, Test_accy 51.41:  30%|███       | 9/30 [02:30<05:16, 15.09s/it]Task 4, Epoch 10/30 => Loss 0.548, Train_accy 71.15, Test_accy 51.41:  33%|███▎      | 10/30 [02:30<05:03, 15.17s/it]Task 4, Epoch 11/30 => Loss 0.530, Train_accy 70.77, Test_accy 51.88:  33%|███▎      | 10/30 [02:46<05:03, 15.17s/it]Task 4, Epoch 11/30 => Loss 0.530, Train_accy 70.77, Test_accy 51.88:  37%|███▋      | 11/30 [02:46<04:48, 15.18s/it]Task 4, Epoch 12/30 => Loss 0.524, Train_accy 80.38, Test_accy 52.29:  37%|███▋      | 11/30 [03:00<04:48, 15.18s/it]Task 4, Epoch 12/30 => Loss 0.524, Train_accy 80.38, Test_accy 52.29:  40%|████      | 12/30 [03:00<04:31, 15.07s/it]Task 4, Epoch 13/30 => Loss 0.458, Train_accy 80.77, Test_accy 51.58:  40%|████      | 12/30 [03:15<04:31, 15.07s/it]Task 4, Epoch 13/30 => Loss 0.458, Train_accy 80.77, Test_accy 51.58:  43%|████▎     | 13/30 [03:15<04:16, 15.06s/it]Task 4, Epoch 14/30 => Loss 0.348, Train_accy 85.77, Test_accy 50.29:  43%|████▎     | 13/30 [03:30<04:16, 15.06s/it]Task 4, Epoch 14/30 => Loss 0.348, Train_accy 85.77, Test_accy 50.29:  47%|████▋     | 14/30 [03:30<03:59, 14.99s/it]Task 4, Epoch 15/30 => Loss 0.373, Train_accy 85.38, Test_accy 48.01:  47%|████▋     | 14/30 [03:45<03:59, 14.99s/it]Task 4, Epoch 15/30 => Loss 0.373, Train_accy 85.38, Test_accy 48.01:  50%|█████     | 15/30 [03:45<03:45, 15.00s/it]Task 4, Epoch 16/30 => Loss 0.391, Train_accy 83.46, Test_accy 52.33:  50%|█████     | 15/30 [04:00<03:45, 15.00s/it]Task 4, Epoch 16/30 => Loss 0.391, Train_accy 83.46, Test_accy 52.33:  53%|█████▎    | 16/30 [04:00<03:30, 15.01s/it]Task 4, Epoch 17/30 => Loss 0.279, Train_accy 90.38, Test_accy 52.27:  53%|█████▎    | 16/30 [04:16<03:30, 15.01s/it]Task 4, Epoch 17/30 => Loss 0.279, Train_accy 90.38, Test_accy 52.27:  57%|█████▋    | 17/30 [04:16<03:16, 15.10s/it]Task 4, Epoch 18/30 => Loss 0.200, Train_accy 93.08, Test_accy 51.69:  57%|█████▋    | 17/30 [04:31<03:16, 15.10s/it]Task 4, Epoch 18/30 => Loss 0.200, Train_accy 93.08, Test_accy 51.69:  60%|██████    | 18/30 [04:31<03:01, 15.14s/it]Task 4, Epoch 19/30 => Loss 0.190, Train_accy 91.15, Test_accy 52.03:  60%|██████    | 18/30 [04:46<03:01, 15.14s/it]Task 4, Epoch 19/30 => Loss 0.190, Train_accy 91.15, Test_accy 52.03:  63%|██████▎   | 19/30 [04:46<02:45, 15.08s/it]Task 4, Epoch 20/30 => Loss 0.243, Train_accy 92.69, Test_accy 52.08:  63%|██████▎   | 19/30 [05:01<02:45, 15.08s/it]Task 4, Epoch 20/30 => Loss 0.243, Train_accy 92.69, Test_accy 52.08:  67%|██████▋   | 20/30 [05:01<02:31, 15.11s/it]Task 4, Epoch 21/30 => Loss 0.193, Train_accy 91.15, Test_accy 51.91:  67%|██████▋   | 20/30 [05:16<02:31, 15.11s/it]Task 4, Epoch 21/30 => Loss 0.193, Train_accy 91.15, Test_accy 51.91:  70%|███████   | 21/30 [05:16<02:15, 15.09s/it]Task 4, Epoch 22/30 => Loss 0.212, Train_accy 92.69, Test_accy 51.75:  70%|███████   | 21/30 [05:32<02:15, 15.09s/it]Task 4, Epoch 22/30 => Loss 0.212, Train_accy 92.69, Test_accy 51.75:  73%|███████▎  | 22/30 [05:32<02:01, 15.25s/it]Task 4, Epoch 23/30 => Loss 0.164, Train_accy 95.00, Test_accy 51.67:  73%|███████▎  | 22/30 [05:47<02:01, 15.25s/it]Task 4, Epoch 23/30 => Loss 0.164, Train_accy 95.00, Test_accy 51.67:  77%|███████▋  | 23/30 [05:47<01:46, 15.15s/it]Task 4, Epoch 24/30 => Loss 0.327, Train_accy 95.77, Test_accy 50.78:  77%|███████▋  | 23/30 [06:02<01:46, 15.15s/it]Task 4, Epoch 24/30 => Loss 0.327, Train_accy 95.77, Test_accy 50.78:  80%|████████  | 24/30 [06:02<01:30, 15.09s/it]Task 4, Epoch 25/30 => Loss 0.118, Train_accy 94.62, Test_accy 50.68:  80%|████████  | 24/30 [06:16<01:30, 15.09s/it]Task 4, Epoch 25/30 => Loss 0.118, Train_accy 94.62, Test_accy 50.68:  83%|████████▎ | 25/30 [06:16<01:15, 15.01s/it]Task 4, Epoch 26/30 => Loss 0.176, Train_accy 91.92, Test_accy 51.22:  83%|████████▎ | 25/30 [06:31<01:15, 15.01s/it]Task 4, Epoch 26/30 => Loss 0.176, Train_accy 91.92, Test_accy 51.22:  87%|████████▋ | 26/30 [06:31<00:59, 14.96s/it]Task 4, Epoch 27/30 => Loss 0.325, Train_accy 91.92, Test_accy 51.34:  87%|████████▋ | 26/30 [06:47<00:59, 14.96s/it]Task 4, Epoch 27/30 => Loss 0.325, Train_accy 91.92, Test_accy 51.34:  90%|█████████ | 27/30 [06:47<00:45, 15.20s/it]Task 4, Epoch 28/30 => Loss 0.166, Train_accy 93.46, Test_accy 51.19:  90%|█████████ | 27/30 [07:02<00:45, 15.20s/it]Task 4, Epoch 28/30 => Loss 0.166, Train_accy 93.46, Test_accy 51.19:  93%|█████████▎| 28/30 [07:02<00:30, 15.17s/it]Task 4, Epoch 29/30 => Loss 0.133, Train_accy 95.38, Test_accy 51.50:  93%|█████████▎| 28/30 [07:17<00:30, 15.17s/it]Task 4, Epoch 29/30 => Loss 0.133, Train_accy 95.38, Test_accy 51.50:  97%|█████████▋| 29/30 [07:17<00:15, 15.14s/it]Task 4, Epoch 30/30 => Loss 0.117, Train_accy 93.85, Test_accy 51.60:  97%|█████████▋| 29/30 [07:32<00:15, 15.14s/it]Task 4, Epoch 30/30 => Loss 0.117, Train_accy 93.85, Test_accy 51.60: 100%|██████████| 30/30 [07:32<00:00, 15.13s/it]Task 4, Epoch 30/30 => Loss 0.117, Train_accy 93.85, Test_accy 51.60: 100%|██████████| 30/30 [07:32<00:00, 15.09s/it]
2024-06-13 10:58:09,894 [lora_prompt.py] => Task 4, Epoch 30/30 => Loss 0.117, Train_accy 93.85, Test_accy 51.60
2024-06-13 10:59:07,761 [lora_prompt.py] => Exemplar size: 0
2024-06-13 10:59:07,762 [trainer.py] => CNN: {'total': 87.61, '00-01': 98.3, '02-03': 91.62, '04-05': 77.17, '06-07': 86.25, '08-09': 60.0, 'old': 88.09, 'new': 60.0}
2024-06-13 10:59:07,762 [trainer.py] => CNN top1 curve: [99.2, 97.29, 88.81, 88.6, 87.61]
