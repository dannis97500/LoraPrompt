Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
Initializing a generic context
Initial context: "X X X X X X X X X X X X X X X X"
Number of context words (tokens): 16
2024-06-13 22:08:00,269 [trainer.py] => All params: 840861697
2024-06-13 22:08:00,274 [trainer.py] => Trainable params: 151320577
2024-06-13 22:08:00,274 [lora_prompt.py] => Learning on 0-50
Parameters to be updated: {'lora_image_model_pool.0.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'classifier_pool.0.ctx', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.0.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]
Task 0, Epoch 1/50 => Loss 2.069, Train_accy 24.55, Test_accy 36.48:   0%|          | 0/50 [01:30<?, ?it/s]
Task 0, Epoch 1/50 => Loss 2.069, Train_accy 24.55, Test_accy 36.48:   2%|▏         | 1/50 [01:30<1:13:34, 90.10s/it]
Task 0, Epoch 1/50 => Loss 2.069, Train_accy 24.55, Test_accy 36.48:   0%|          | 0/50 [03:04<?, ?it/s]
Task 0, Epoch 1/50 => Loss 2.069, Train_accy 24.55, Test_accy 36.48:   2%|▏         | 1/50 [03:04<2:30:22, 184.14s/it]
Task 0, Epoch 2/50 => Loss 1.354, Train_accy 56.87, Test_accy 64.82:   2%|▏         | 1/50 [03:05<1:13:34, 90.10s/it]
Task 0, Epoch 2/50 => Loss 1.354, Train_accy 56.87, Test_accy 64.82:   4%|▍         | 2/50 [03:05<1:14:28, 93.10s/it]
Task 0, Epoch 2/50 => Loss 1.354, Train_accy 56.87, Test_accy 64.82:   2%|▏         | 1/50 [05:58<2:30:22, 184.14s/it]
Task 0, Epoch 2/50 => Loss 1.354, Train_accy 56.87, Test_accy 64.82:   4%|▍         | 2/50 [05:58<2:22:35, 178.24s/it]
Task 0, Epoch 3/50 => Loss 0.980, Train_accy 72.48, Test_accy 70.33:   4%|▍         | 2/50 [04:42<1:14:28, 93.10s/it]
Task 0, Epoch 3/50 => Loss 0.980, Train_accy 72.48, Test_accy 70.33:   6%|▌         | 3/50 [04:42<1:14:32, 95.17s/it]
Task 0, Epoch 4/50 => Loss 0.837, Train_accy 77.25, Test_accy 72.63:   6%|▌         | 3/50 [06:22<1:14:32, 95.17s/it]
Task 0, Epoch 4/50 => Loss 0.837, Train_accy 77.25, Test_accy 72.63:   8%|▊         | 4/50 [06:22<1:14:25, 97.09s/it]
Task 0, Epoch 3/50 => Loss 0.980, Train_accy 72.48, Test_accy 70.33:   4%|▍         | 2/50 [08:58<2:22:35, 178.24s/it]
Task 0, Epoch 3/50 => Loss 0.980, Train_accy 72.48, Test_accy 70.33:   6%|▌         | 3/50 [08:58<2:20:20, 179.17s/it]
Task 0, Epoch 5/50 => Loss 0.795, Train_accy 78.62, Test_accy 76.77:   8%|▊         | 4/50 [08:01<1:14:25, 97.09s/it]
Task 0, Epoch 5/50 => Loss 0.795, Train_accy 78.62, Test_accy 76.77:  10%|█         | 5/50 [08:01<1:13:20, 97.79s/it]
Task 0, Epoch 6/50 => Loss 0.733, Train_accy 80.94, Test_accy 77.43:  10%|█         | 5/50 [09:37<1:13:20, 97.79s/it]
Task 0, Epoch 6/50 => Loss 0.733, Train_accy 80.94, Test_accy 77.43:  12%|█▏        | 6/50 [09:37<1:11:15, 97.17s/it]
Task 0, Epoch 4/50 => Loss 0.837, Train_accy 77.25, Test_accy 72.63:   6%|▌         | 3/50 [11:54<2:20:20, 179.17s/it]
Task 0, Epoch 4/50 => Loss 0.837, Train_accy 77.25, Test_accy 72.63:   8%|▊         | 4/50 [11:54<2:16:23, 177.89s/it]
Task 0, Epoch 7/50 => Loss 0.694, Train_accy 82.06, Test_accy 77.68:  12%|█▏        | 6/50 [11:15<1:11:15, 97.17s/it]
Task 0, Epoch 7/50 => Loss 0.694, Train_accy 82.06, Test_accy 77.68:  14%|█▍        | 7/50 [11:15<1:09:38, 97.18s/it]
Task 0, Epoch 8/50 => Loss 0.684, Train_accy 81.88, Test_accy 77.61:  14%|█▍        | 7/50 [12:52<1:09:38, 97.18s/it]
Task 0, Epoch 8/50 => Loss 0.684, Train_accy 81.88, Test_accy 77.61:  16%|█▌        | 8/50 [12:52<1:08:07, 97.32s/it]
Task 0, Epoch 5/50 => Loss 0.795, Train_accy 78.62, Test_accy 76.77:   8%|▊         | 4/50 [14:52<2:16:23, 177.89s/it]
Task 0, Epoch 5/50 => Loss 0.795, Train_accy 78.62, Test_accy 76.77:  10%|█         | 5/50 [14:52<2:13:25, 177.91s/it]
Task 0, Epoch 9/50 => Loss 0.673, Train_accy 82.30, Test_accy 77.45:  16%|█▌        | 8/50 [14:31<1:08:07, 97.32s/it]
Task 0, Epoch 9/50 => Loss 0.673, Train_accy 82.30, Test_accy 77.45:  18%|█▊        | 9/50 [14:31<1:06:50, 97.81s/it]
Task 0, Epoch 10/50 => Loss 0.641, Train_accy 83.12, Test_accy 79.76:  18%|█▊        | 9/50 [16:08<1:06:50, 97.81s/it]
Task 0, Epoch 10/50 => Loss 0.641, Train_accy 83.12, Test_accy 79.76:  20%|██        | 10/50 [16:08<1:04:55, 97.39s/it]
Task 0, Epoch 6/50 => Loss 0.733, Train_accy 80.94, Test_accy 77.43:  10%|█         | 5/50 [17:49<2:13:25, 177.91s/it]
Task 0, Epoch 6/50 => Loss 0.733, Train_accy 80.94, Test_accy 77.43:  12%|█▏        | 6/50 [17:49<2:10:20, 177.73s/it]
Task 0, Epoch 11/50 => Loss 0.634, Train_accy 83.48, Test_accy 78.40:  20%|██        | 10/50 [17:47<1:04:55, 97.39s/it]
Task 0, Epoch 11/50 => Loss 0.634, Train_accy 83.48, Test_accy 78.40:  22%|██▏       | 11/50 [17:47<1:03:46, 98.11s/it]
Task 0, Epoch 7/50 => Loss 0.694, Train_accy 82.06, Test_accy 77.68:  12%|█▏        | 6/50 [20:45<2:10:20, 177.73s/it]
Task 0, Epoch 7/50 => Loss 0.694, Train_accy 82.06, Test_accy 77.68:  14%|█▍        | 7/50 [20:45<2:06:52, 177.04s/it]
Task 0, Epoch 12/50 => Loss 0.620, Train_accy 83.99, Test_accy 76.74:  22%|██▏       | 11/50 [19:28<1:03:46, 98.11s/it]
Task 0, Epoch 12/50 => Loss 0.620, Train_accy 83.99, Test_accy 76.74:  24%|██▍       | 12/50 [19:28<1:02:40, 98.96s/it]
Task 0, Epoch 13/50 => Loss 0.616, Train_accy 84.24, Test_accy 78.21:  24%|██▍       | 12/50 [21:08<1:02:40, 98.96s/it]
Task 0, Epoch 13/50 => Loss 0.616, Train_accy 84.24, Test_accy 78.21:  26%|██▌       | 13/50 [21:08<1:01:12, 99.27s/it]
Task 0, Epoch 8/50 => Loss 0.684, Train_accy 81.88, Test_accy 77.61:  14%|█▍        | 7/50 [23:44<2:06:52, 177.04s/it]
Task 0, Epoch 8/50 => Loss 0.684, Train_accy 81.88, Test_accy 77.61:  16%|█▌        | 8/50 [23:44<2:04:25, 177.74s/it]
Task 0, Epoch 14/50 => Loss 0.586, Train_accy 84.88, Test_accy 79.10:  26%|██▌       | 13/50 [22:46<1:01:12, 99.27s/it]
Task 0, Epoch 14/50 => Loss 0.586, Train_accy 84.88, Test_accy 79.10:  28%|██▊       | 14/50 [22:46<59:20, 98.91s/it]  
Task 0, Epoch 15/50 => Loss 0.573, Train_accy 84.84, Test_accy 80.34:  28%|██▊       | 14/50 [24:24<59:20, 98.91s/it]
Task 0, Epoch 15/50 => Loss 0.573, Train_accy 84.84, Test_accy 80.34:  30%|███       | 15/50 [24:24<57:31, 98.61s/it]
Task 0, Epoch 9/50 => Loss 0.673, Train_accy 82.30, Test_accy 77.45:  16%|█▌        | 8/50 [26:38<2:04:25, 177.74s/it]
Task 0, Epoch 9/50 => Loss 0.673, Train_accy 82.30, Test_accy 77.45:  18%|█▊        | 9/50 [26:38<2:00:43, 176.68s/it]
Task 0, Epoch 16/50 => Loss 0.561, Train_accy 85.45, Test_accy 81.09:  30%|███       | 15/50 [26:03<57:31, 98.61s/it]
Task 0, Epoch 16/50 => Loss 0.561, Train_accy 85.45, Test_accy 81.09:  32%|███▏      | 16/50 [26:03<55:58, 98.78s/it]
Task 0, Epoch 17/50 => Loss 0.574, Train_accy 85.19, Test_accy 81.68:  32%|███▏      | 16/50 [27:44<55:58, 98.78s/it]
Task 0, Epoch 17/50 => Loss 0.574, Train_accy 85.19, Test_accy 81.68:  34%|███▍      | 17/50 [27:44<54:35, 99.24s/it]
Task 0, Epoch 10/50 => Loss 0.641, Train_accy 83.12, Test_accy 79.76:  18%|█▊        | 9/50 [29:38<2:00:43, 176.68s/it]
Task 0, Epoch 10/50 => Loss 0.641, Train_accy 83.12, Test_accy 79.76:  20%|██        | 10/50 [29:38<1:58:24, 177.62s/it]
Task 0, Epoch 18/50 => Loss 0.562, Train_accy 85.29, Test_accy 80.91:  34%|███▍      | 17/50 [29:22<54:35, 99.24s/it]
Task 0, Epoch 18/50 => Loss 0.562, Train_accy 85.29, Test_accy 80.91:  36%|███▌      | 18/50 [29:22<52:48, 99.00s/it]
Task 0, Epoch 19/50 => Loss 0.561, Train_accy 85.37, Test_accy 80.37:  36%|███▌      | 18/50 [31:01<52:48, 99.00s/it]
Task 0, Epoch 19/50 => Loss 0.561, Train_accy 85.37, Test_accy 80.37:  38%|███▊      | 19/50 [31:01<51:07, 98.97s/it]
Task 0, Epoch 11/50 => Loss 0.634, Train_accy 83.48, Test_accy 78.40:  20%|██        | 10/50 [32:34<1:58:24, 177.62s/it]
Task 0, Epoch 11/50 => Loss 0.634, Train_accy 83.48, Test_accy 78.40:  22%|██▏       | 11/50 [32:34<1:55:07, 177.13s/it]
Task 0, Epoch 20/50 => Loss 0.550, Train_accy 85.84, Test_accy 80.40:  38%|███▊      | 19/50 [32:35<51:07, 98.97s/it]
Task 0, Epoch 20/50 => Loss 0.550, Train_accy 85.84, Test_accy 80.40:  40%|████      | 20/50 [32:35<48:44, 97.47s/it]
Task 0, Epoch 21/50 => Loss 0.536, Train_accy 86.21, Test_accy 80.62:  40%|████      | 20/50 [34:15<48:44, 97.47s/it]
Task 0, Epoch 21/50 => Loss 0.536, Train_accy 86.21, Test_accy 80.62:  42%|████▏     | 21/50 [34:15<47:27, 98.19s/it]
Task 0, Epoch 12/50 => Loss 0.620, Train_accy 83.99, Test_accy 76.74:  22%|██▏       | 11/50 [35:35<1:55:07, 177.13s/it]
Task 0, Epoch 12/50 => Loss 0.620, Train_accy 83.99, Test_accy 76.74:  24%|██▍       | 12/50 [35:35<1:52:54, 178.27s/it]
Task 0, Epoch 22/50 => Loss 0.525, Train_accy 86.55, Test_accy 81.97:  42%|████▏     | 21/50 [35:55<47:27, 98.19s/it]
Task 0, Epoch 22/50 => Loss 0.525, Train_accy 86.55, Test_accy 81.97:  44%|████▍     | 22/50 [35:55<46:02, 98.66s/it]
Task 0, Epoch 13/50 => Loss 0.616, Train_accy 84.24, Test_accy 78.21:  24%|██▍       | 12/50 [38:30<1:52:54, 178.27s/it]
Task 0, Epoch 13/50 => Loss 0.616, Train_accy 84.24, Test_accy 78.21:  26%|██▌       | 13/50 [38:30<1:49:14, 177.14s/it]
Task 0, Epoch 23/50 => Loss 0.523, Train_accy 86.40, Test_accy 81.85:  44%|████▍     | 22/50 [37:32<46:02, 98.66s/it]
Task 0, Epoch 23/50 => Loss 0.523, Train_accy 86.40, Test_accy 81.85:  46%|████▌     | 23/50 [37:32<44:11, 98.21s/it]
Task 0, Epoch 24/50 => Loss 0.535, Train_accy 86.04, Test_accy 82.50:  46%|████▌     | 23/50 [39:11<44:11, 98.21s/it]
Task 0, Epoch 24/50 => Loss 0.535, Train_accy 86.04, Test_accy 82.50:  48%|████▊     | 24/50 [39:11<42:41, 98.52s/it]
Task 0, Epoch 14/50 => Loss 0.586, Train_accy 84.88, Test_accy 79.10:  26%|██▌       | 13/50 [41:30<1:49:14, 177.14s/it]
Task 0, Epoch 14/50 => Loss 0.586, Train_accy 84.88, Test_accy 79.10:  28%|██▊       | 14/50 [41:30<1:46:49, 178.03s/it]
Task 0, Epoch 25/50 => Loss 0.518, Train_accy 86.78, Test_accy 81.43:  48%|████▊     | 24/50 [40:52<42:41, 98.52s/it]
Task 0, Epoch 25/50 => Loss 0.518, Train_accy 86.78, Test_accy 81.43:  50%|█████     | 25/50 [40:52<41:22, 99.29s/it]
Task 0, Epoch 26/50 => Loss 0.530, Train_accy 86.19, Test_accy 80.70:  50%|█████     | 25/50 [42:30<41:22, 99.29s/it]
Task 0, Epoch 26/50 => Loss 0.530, Train_accy 86.19, Test_accy 80.70:  52%|█████▏    | 26/50 [42:30<39:29, 98.73s/it]
Task 0, Epoch 15/50 => Loss 0.573, Train_accy 84.84, Test_accy 80.34:  28%|██▊       | 14/50 [44:23<1:46:49, 178.03s/it]
Task 0, Epoch 15/50 => Loss 0.573, Train_accy 84.84, Test_accy 80.34:  30%|███       | 15/50 [44:23<1:43:00, 176.59s/it]
Task 0, Epoch 27/50 => Loss 0.519, Train_accy 86.63, Test_accy 82.64:  52%|█████▏    | 26/50 [44:07<39:29, 98.73s/it]
Task 0, Epoch 27/50 => Loss 0.519, Train_accy 86.63, Test_accy 82.64:  54%|█████▍    | 27/50 [44:07<37:38, 98.20s/it]
Task 0, Epoch 28/50 => Loss 0.512, Train_accy 87.00, Test_accy 81.41:  54%|█████▍    | 27/50 [45:46<37:38, 98.20s/it]
Task 0, Epoch 28/50 => Loss 0.512, Train_accy 87.00, Test_accy 81.41:  56%|█████▌    | 28/50 [45:46<36:11, 98.70s/it]
Task 0, Epoch 16/50 => Loss 0.561, Train_accy 85.45, Test_accy 81.09:  30%|███       | 15/50 [47:19<1:43:00, 176.59s/it]
Task 0, Epoch 16/50 => Loss 0.561, Train_accy 85.45, Test_accy 81.09:  32%|███▏      | 16/50 [47:19<1:39:57, 176.39s/it]
Task 0, Epoch 29/50 => Loss 0.498, Train_accy 87.50, Test_accy 81.60:  56%|█████▌    | 28/50 [47:27<36:11, 98.70s/it]
Task 0, Epoch 29/50 => Loss 0.498, Train_accy 87.50, Test_accy 81.60:  58%|█████▊    | 29/50 [47:27<34:46, 99.33s/it]
Task 0, Epoch 17/50 => Loss 0.574, Train_accy 85.19, Test_accy 81.68:  32%|███▏      | 16/50 [50:16<1:39:57, 176.39s/it]
Task 0, Epoch 17/50 => Loss 0.574, Train_accy 85.19, Test_accy 81.68:  34%|███▍      | 17/50 [50:16<1:37:09, 176.65s/it]
Task 0, Epoch 30/50 => Loss 0.495, Train_accy 87.12, Test_accy 81.90:  58%|█████▊    | 29/50 [49:06<34:46, 99.33s/it]
Task 0, Epoch 30/50 => Loss 0.495, Train_accy 87.12, Test_accy 81.90:  60%|██████    | 30/50 [49:06<33:05, 99.26s/it]
Task 0, Epoch 31/50 => Loss 0.494, Train_accy 87.03, Test_accy 81.23:  60%|██████    | 30/50 [50:46<33:05, 99.26s/it]
Task 0, Epoch 31/50 => Loss 0.494, Train_accy 87.03, Test_accy 81.23:  62%|██████▏   | 31/50 [50:46<31:28, 99.42s/it]
Task 0, Epoch 18/50 => Loss 0.562, Train_accy 85.29, Test_accy 80.91:  34%|███▍      | 17/50 [53:13<1:37:09, 176.65s/it]
Task 0, Epoch 18/50 => Loss 0.562, Train_accy 85.29, Test_accy 80.91:  36%|███▌      | 18/50 [53:13<1:34:16, 176.75s/it]
Task 0, Epoch 32/50 => Loss 0.504, Train_accy 87.07, Test_accy 81.79:  62%|██████▏   | 31/50 [52:27<31:28, 99.42s/it]
Task 0, Epoch 32/50 => Loss 0.504, Train_accy 87.07, Test_accy 81.79:  64%|██████▍   | 32/50 [52:27<29:56, 99.78s/it]
Task 0, Epoch 33/50 => Loss 0.490, Train_accy 87.46, Test_accy 82.06:  64%|██████▍   | 32/50 [54:06<29:56, 99.78s/it]
Task 0, Epoch 33/50 => Loss 0.490, Train_accy 87.46, Test_accy 82.06:  66%|██████▌   | 33/50 [54:06<28:11, 99.51s/it]
Task 0, Epoch 19/50 => Loss 0.561, Train_accy 85.37, Test_accy 80.37:  36%|███▌      | 18/50 [56:09<1:34:16, 176.75s/it]
Task 0, Epoch 19/50 => Loss 0.561, Train_accy 85.37, Test_accy 80.37:  38%|███▊      | 19/50 [56:09<1:31:09, 176.43s/it]
Task 0, Epoch 34/50 => Loss 0.483, Train_accy 87.72, Test_accy 81.92:  66%|██████▌   | 33/50 [55:46<28:11, 99.51s/it]
Task 0, Epoch 34/50 => Loss 0.483, Train_accy 87.72, Test_accy 81.92:  68%|██████▊   | 34/50 [55:46<26:34, 99.65s/it]
Task 0, Epoch 35/50 => Loss 0.486, Train_accy 87.55, Test_accy 81.34:  68%|██████▊   | 34/50 [57:23<26:34, 99.65s/it]
Task 0, Epoch 35/50 => Loss 0.486, Train_accy 87.55, Test_accy 81.34:  70%|███████   | 35/50 [57:23<24:46, 99.09s/it]
Task 0, Epoch 20/50 => Loss 0.550, Train_accy 85.84, Test_accy 80.40:  38%|███▊      | 19/50 [59:01<1:31:09, 176.43s/it]
Task 0, Epoch 20/50 => Loss 0.550, Train_accy 85.84, Test_accy 80.40:  40%|████      | 20/50 [59:01<1:27:37, 175.24s/it]
Task 0, Epoch 36/50 => Loss 0.491, Train_accy 87.12, Test_accy 81.39:  70%|███████   | 35/50 [59:02<24:46, 99.09s/it]
Task 0, Epoch 36/50 => Loss 0.491, Train_accy 87.12, Test_accy 81.39:  72%|███████▏  | 36/50 [59:02<23:04, 98.92s/it]
Task 0, Epoch 37/50 => Loss 0.484, Train_accy 87.67, Test_accy 82.33:  72%|███████▏  | 36/50 [1:00:41<23:04, 98.92s/it]
Task 0, Epoch 37/50 => Loss 0.484, Train_accy 87.67, Test_accy 82.33:  74%|███████▍  | 37/50 [1:00:41<21:25, 98.88s/it]
Task 0, Epoch 21/50 => Loss 0.536, Train_accy 86.21, Test_accy 80.62:  40%|████      | 20/50 [1:02:00<1:27:37, 175.24s/it]
Task 0, Epoch 21/50 => Loss 0.536, Train_accy 86.21, Test_accy 80.62:  42%|████▏     | 21/50 [1:02:00<1:25:12, 176.28s/it]
Task 0, Epoch 38/50 => Loss 0.460, Train_accy 88.15, Test_accy 82.47:  74%|███████▍  | 37/50 [1:02:18<21:25, 98.88s/it]
Task 0, Epoch 38/50 => Loss 0.460, Train_accy 88.15, Test_accy 82.47:  76%|███████▌  | 38/50 [1:02:18<19:40, 98.41s/it]
Task 0, Epoch 22/50 => Loss 0.525, Train_accy 86.55, Test_accy 81.97:  42%|████▏     | 21/50 [1:04:54<1:25:12, 176.28s/it]
Task 0, Epoch 22/50 => Loss 0.525, Train_accy 86.55, Test_accy 81.97:  44%|████▍     | 22/50 [1:04:54<1:21:56, 175.60s/it]
Task 0, Epoch 39/50 => Loss 0.462, Train_accy 88.39, Test_accy 82.89:  76%|███████▌  | 38/50 [1:04:00<19:40, 98.41s/it]
Task 0, Epoch 39/50 => Loss 0.462, Train_accy 88.39, Test_accy 82.89:  78%|███████▊  | 39/50 [1:04:00<18:13, 99.42s/it]
Task 0, Epoch 40/50 => Loss 0.455, Train_accy 88.56, Test_accy 81.86:  78%|███████▊  | 39/50 [1:05:40<18:13, 99.42s/it]
Task 0, Epoch 40/50 => Loss 0.455, Train_accy 88.56, Test_accy 81.86:  80%|████████  | 40/50 [1:05:40<16:36, 99.64s/it]
Task 0, Epoch 23/50 => Loss 0.523, Train_accy 86.40, Test_accy 81.85:  44%|████▍     | 22/50 [1:07:51<1:21:56, 175.60s/it]
Task 0, Epoch 23/50 => Loss 0.523, Train_accy 86.40, Test_accy 81.85:  46%|████▌     | 23/50 [1:07:51<1:19:15, 176.12s/it]
Task 0, Epoch 41/50 => Loss 0.453, Train_accy 88.72, Test_accy 81.62:  80%|████████  | 40/50 [1:07:19<16:36, 99.64s/it]
Task 0, Epoch 41/50 => Loss 0.453, Train_accy 88.72, Test_accy 81.62:  82%|████████▏ | 41/50 [1:07:19<14:54, 99.34s/it]
Task 0, Epoch 42/50 => Loss 0.471, Train_accy 87.93, Test_accy 82.40:  82%|████████▏ | 41/50 [1:08:57<14:54, 99.34s/it]
Task 0, Epoch 42/50 => Loss 0.471, Train_accy 87.93, Test_accy 82.40:  84%|████████▍ | 42/50 [1:08:57<13:12, 99.09s/it]
Task 0, Epoch 24/50 => Loss 0.535, Train_accy 86.04, Test_accy 82.50:  46%|████▌     | 23/50 [1:10:43<1:19:15, 176.12s/it]
Task 0, Epoch 24/50 => Loss 0.535, Train_accy 86.04, Test_accy 82.50:  48%|████▊     | 24/50 [1:10:43<1:15:42, 174.72s/it]
Task 0, Epoch 43/50 => Loss 0.444, Train_accy 88.79, Test_accy 81.93:  84%|████████▍ | 42/50 [1:10:34<13:12, 99.09s/it]
Task 0, Epoch 43/50 => Loss 0.444, Train_accy 88.79, Test_accy 81.93:  86%|████████▌ | 43/50 [1:10:34<11:28, 98.41s/it]
Task 0, Epoch 44/50 => Loss 0.454, Train_accy 88.65, Test_accy 82.22:  86%|████████▌ | 43/50 [1:12:12<11:28, 98.41s/it]
Task 0, Epoch 44/50 => Loss 0.454, Train_accy 88.65, Test_accy 82.22:  88%|████████▊ | 44/50 [1:12:12<09:50, 98.38s/it]
Task 0, Epoch 25/50 => Loss 0.518, Train_accy 86.78, Test_accy 81.43:  48%|████▊     | 24/50 [1:13:39<1:15:42, 174.72s/it]
Task 0, Epoch 25/50 => Loss 0.518, Train_accy 86.78, Test_accy 81.43:  50%|█████     | 25/50 [1:13:39<1:12:58, 175.14s/it]
Task 0, Epoch 45/50 => Loss 0.449, Train_accy 88.67, Test_accy 82.69:  88%|████████▊ | 44/50 [1:13:50<09:50, 98.38s/it]
Task 0, Epoch 45/50 => Loss 0.449, Train_accy 88.67, Test_accy 82.69:  90%|█████████ | 45/50 [1:13:50<08:10, 98.11s/it]
Task 0, Epoch 26/50 => Loss 0.530, Train_accy 86.19, Test_accy 80.70:  50%|█████     | 25/50 [1:16:33<1:12:58, 175.14s/it]
Task 0, Epoch 26/50 => Loss 0.530, Train_accy 86.19, Test_accy 80.70:  52%|█████▏    | 26/50 [1:16:33<1:09:54, 174.78s/it]
Task 0, Epoch 46/50 => Loss 0.453, Train_accy 88.69, Test_accy 82.24:  90%|█████████ | 45/50 [1:15:27<08:10, 98.11s/it]
Task 0, Epoch 46/50 => Loss 0.453, Train_accy 88.69, Test_accy 82.24:  92%|█████████▏| 46/50 [1:15:27<06:31, 97.77s/it]
Task 0, Epoch 47/50 => Loss 0.443, Train_accy 88.95, Test_accy 82.31:  92%|█████████▏| 46/50 [1:17:01<06:31, 97.77s/it]
Task 0, Epoch 47/50 => Loss 0.443, Train_accy 88.95, Test_accy 82.31:  94%|█████████▍| 47/50 [1:17:01<04:49, 96.59s/it]
Task 0, Epoch 27/50 => Loss 0.519, Train_accy 86.63, Test_accy 82.64:  52%|█████▏    | 26/50 [1:19:31<1:09:54, 174.78s/it]
Task 0, Epoch 27/50 => Loss 0.519, Train_accy 86.63, Test_accy 82.64:  54%|█████▍    | 27/50 [1:19:31<1:07:21, 175.72s/it]
Task 0, Epoch 48/50 => Loss 0.457, Train_accy 88.85, Test_accy 82.32:  94%|█████████▍| 47/50 [1:18:36<04:49, 96.59s/it]
Task 0, Epoch 48/50 => Loss 0.457, Train_accy 88.85, Test_accy 82.32:  96%|█████████▌| 48/50 [1:18:36<03:12, 96.23s/it]
Task 0, Epoch 49/50 => Loss 0.435, Train_accy 89.17, Test_accy 82.40:  96%|█████████▌| 48/50 [1:20:14<03:12, 96.23s/it]
Task 0, Epoch 49/50 => Loss 0.435, Train_accy 89.17, Test_accy 82.40:  98%|█████████▊| 49/50 [1:20:14<01:36, 96.84s/it]
Task 0, Epoch 28/50 => Loss 0.512, Train_accy 87.00, Test_accy 81.41:  54%|█████▍    | 27/50 [1:22:27<1:07:21, 175.72s/it]
Task 0, Epoch 28/50 => Loss 0.512, Train_accy 87.00, Test_accy 81.41:  56%|█████▌    | 28/50 [1:22:27<1:04:26, 175.74s/it]
Task 0, Epoch 50/50 => Loss 0.443, Train_accy 89.05, Test_accy 82.39:  98%|█████████▊| 49/50 [1:21:52<01:36, 96.84s/it]
Task 0, Epoch 50/50 => Loss 0.443, Train_accy 89.05, Test_accy 82.39: 100%|██████████| 50/50 [1:21:52<00:00, 97.18s/it]
Task 0, Epoch 50/50 => Loss 0.443, Train_accy 89.05, Test_accy 82.39: 100%|██████████| 50/50 [1:21:52<00:00, 98.25s/it]
2024-06-13 23:29:57,930 [lora_prompt.py] => Task 0, Epoch 50/50 => Loss 0.443, Train_accy 89.05, Test_accy 82.39

Task 0, Epoch 29/50 => Loss 0.498, Train_accy 87.50, Test_accy 81.60:  56%|█████▌    | 28/50 [1:25:23<1:04:26, 175.74s/it]
Task 0, Epoch 29/50 => Loss 0.498, Train_accy 87.50, Test_accy 81.60:  58%|█████▊    | 29/50 [1:25:23<1:01:35, 175.99s/it]
Task 0, Epoch 30/50 => Loss 0.495, Train_accy 87.12, Test_accy 81.90:  58%|█████▊    | 29/50 [1:28:19<1:01:35, 175.99s/it]
Task 0, Epoch 30/50 => Loss 0.495, Train_accy 87.12, Test_accy 81.90:  60%|██████    | 30/50 [1:28:19<58:37, 175.89s/it]  
Task 0, Epoch 31/50 => Loss 0.494, Train_accy 87.03, Test_accy 81.23:  60%|██████    | 30/50 [1:31:15<58:37, 175.89s/it]
Task 0, Epoch 31/50 => Loss 0.494, Train_accy 87.03, Test_accy 81.23:  62%|██████▏   | 31/50 [1:31:15<55:43, 175.97s/it]2024-06-13 23:38:08,407 [lora_prompt.py] => Exemplar size: 0
2024-06-13 23:38:08,408 [trainer.py] => CNN: {'total': 82.45, '00-49': 82.45, 'old': 0, 'new': 82.45}
2024-06-13 23:38:08,408 [trainer.py] => CNN top1 curve: [82.45]
2024-06-13 23:38:08,413 [trainer.py] => All params: 840861697
2024-06-13 23:38:08,418 [trainer.py] => Trainable params: 204800
2024-06-13 23:38:08,419 [lora_prompt.py] => Learning on 50-100
Parameters to be updated: {'lora_image_model_pool.1.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'classifier_pool.1.ctx', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]
Task 1, Epoch 1/50 => Loss 2.089, Train_accy 21.90, Test_accy 33.91:   0%|          | 0/50 [01:34<?, ?it/s]
Task 1, Epoch 1/50 => Loss 2.089, Train_accy 21.90, Test_accy 33.91:   2%|▏         | 1/50 [01:34<1:17:15, 94.60s/it]
Task 0, Epoch 32/50 => Loss 0.504, Train_accy 87.07, Test_accy 81.79:  62%|██████▏   | 31/50 [1:34:11<55:43, 175.97s/it]
Task 0, Epoch 32/50 => Loss 0.504, Train_accy 87.07, Test_accy 81.79:  64%|██████▍   | 32/50 [1:34:11<52:48, 176.01s/it]
Task 1, Epoch 2/50 => Loss 1.507, Train_accy 51.78, Test_accy 60.48:   2%|▏         | 1/50 [03:10<1:17:15, 94.60s/it]
Task 1, Epoch 2/50 => Loss 1.507, Train_accy 51.78, Test_accy 60.48:   4%|▍         | 2/50 [03:10<1:16:25, 95.53s/it]
Task 1, Epoch 3/50 => Loss 1.035, Train_accy 70.58, Test_accy 62.15:   4%|▍         | 2/50 [04:49<1:16:25, 95.53s/it]
Task 1, Epoch 3/50 => Loss 1.035, Train_accy 70.58, Test_accy 62.15:   6%|▌         | 3/50 [04:49<1:15:58, 96.99s/it]
Task 0, Epoch 33/50 => Loss 0.490, Train_accy 87.46, Test_accy 82.06:  64%|██████▍   | 32/50 [1:37:05<52:48, 176.01s/it]
Task 0, Epoch 33/50 => Loss 0.490, Train_accy 87.46, Test_accy 82.06:  66%|██████▌   | 33/50 [1:37:05<49:42, 175.44s/it]
Task 1, Epoch 4/50 => Loss 0.885, Train_accy 76.83, Test_accy 73.47:   6%|▌         | 3/50 [06:30<1:15:58, 96.99s/it]
Task 1, Epoch 4/50 => Loss 0.885, Train_accy 76.83, Test_accy 73.47:   8%|▊         | 4/50 [06:30<1:15:35, 98.61s/it]
Task 1, Epoch 5/50 => Loss 0.765, Train_accy 79.91, Test_accy 75.20:   8%|▊         | 4/50 [08:07<1:15:35, 98.61s/it]
Task 1, Epoch 5/50 => Loss 0.765, Train_accy 79.91, Test_accy 75.20:  10%|█         | 5/50 [08:07<1:13:35, 98.12s/it]
Task 0, Epoch 34/50 => Loss 0.483, Train_accy 87.72, Test_accy 81.92:  66%|██████▌   | 33/50 [1:40:03<49:42, 175.44s/it]
Task 0, Epoch 34/50 => Loss 0.483, Train_accy 87.72, Test_accy 81.92:  68%|██████▊   | 34/50 [1:40:03<46:56, 176.05s/it]
Task 1, Epoch 6/50 => Loss 0.705, Train_accy 81.78, Test_accy 77.41:  10%|█         | 5/50 [09:44<1:13:35, 98.12s/it]
Task 1, Epoch 6/50 => Loss 0.705, Train_accy 81.78, Test_accy 77.41:  12%|█▏        | 6/50 [09:44<1:11:34, 97.60s/it]
Task 1, Epoch 7/50 => Loss 0.679, Train_accy 82.97, Test_accy 77.19:  12%|█▏        | 6/50 [11:24<1:11:34, 97.60s/it]
Task 1, Epoch 7/50 => Loss 0.679, Train_accy 82.97, Test_accy 77.19:  14%|█▍        | 7/50 [11:24<1:10:24, 98.25s/it]
Task 0, Epoch 35/50 => Loss 0.486, Train_accy 87.55, Test_accy 81.34:  68%|██████▊   | 34/50 [1:42:56<46:56, 176.05s/it]
Task 0, Epoch 35/50 => Loss 0.486, Train_accy 87.55, Test_accy 81.34:  70%|███████   | 35/50 [1:42:56<43:50, 175.34s/it]
Task 1, Epoch 8/50 => Loss 0.642, Train_accy 83.43, Test_accy 77.02:  14%|█▍        | 7/50 [13:02<1:10:24, 98.25s/it]
Task 1, Epoch 8/50 => Loss 0.642, Train_accy 83.43, Test_accy 77.02:  16%|█▌        | 8/50 [13:02<1:08:46, 98.25s/it]
Task 0, Epoch 36/50 => Loss 0.491, Train_accy 87.12, Test_accy 81.39:  70%|███████   | 35/50 [1:45:54<43:50, 175.34s/it]
Task 0, Epoch 36/50 => Loss 0.491, Train_accy 87.12, Test_accy 81.39:  72%|███████▏  | 36/50 [1:45:54<41:03, 175.99s/it]
Task 1, Epoch 9/50 => Loss 0.638, Train_accy 83.75, Test_accy 75.88:  16%|█▌        | 8/50 [14:41<1:08:46, 98.25s/it]
Task 1, Epoch 9/50 => Loss 0.638, Train_accy 83.75, Test_accy 75.88:  18%|█▊        | 9/50 [14:41<1:07:20, 98.56s/it]
Task 1, Epoch 10/50 => Loss 0.616, Train_accy 84.60, Test_accy 79.18:  18%|█▊        | 9/50 [16:19<1:07:20, 98.56s/it]
Task 1, Epoch 10/50 => Loss 0.616, Train_accy 84.60, Test_accy 79.18:  20%|██        | 10/50 [16:19<1:05:35, 98.38s/it]
Task 0, Epoch 37/50 => Loss 0.484, Train_accy 87.67, Test_accy 82.33:  72%|███████▏  | 36/50 [1:48:47<41:03, 175.99s/it]
Task 0, Epoch 37/50 => Loss 0.484, Train_accy 87.67, Test_accy 82.33:  74%|███████▍  | 37/50 [1:48:47<37:56, 175.11s/it]
Task 1, Epoch 11/50 => Loss 0.585, Train_accy 85.26, Test_accy 79.47:  20%|██        | 10/50 [17:58<1:05:35, 98.38s/it]
Task 1, Epoch 11/50 => Loss 0.585, Train_accy 85.26, Test_accy 79.47:  22%|██▏       | 11/50 [17:58<1:04:08, 98.68s/it]
Task 1, Epoch 12/50 => Loss 0.569, Train_accy 86.03, Test_accy 77.93:  22%|██▏       | 11/50 [19:36<1:04:08, 98.68s/it]
Task 1, Epoch 12/50 => Loss 0.569, Train_accy 86.03, Test_accy 77.93:  24%|██▍       | 12/50 [19:36<1:02:18, 98.37s/it]
Task 0, Epoch 38/50 => Loss 0.460, Train_accy 88.15, Test_accy 82.47:  74%|███████▍  | 37/50 [1:51:45<37:56, 175.11s/it]
Task 0, Epoch 38/50 => Loss 0.460, Train_accy 88.15, Test_accy 82.47:  76%|███████▌  | 38/50 [1:51:45<35:11, 175.97s/it]
Task 1, Epoch 13/50 => Loss 0.567, Train_accy 85.84, Test_accy 78.22:  24%|██▍       | 12/50 [21:15<1:02:18, 98.37s/it]
Task 1, Epoch 13/50 => Loss 0.567, Train_accy 85.84, Test_accy 78.22:  26%|██▌       | 13/50 [21:15<1:00:44, 98.51s/it]
Task 1, Epoch 14/50 => Loss 0.563, Train_accy 85.54, Test_accy 76.56:  26%|██▌       | 13/50 [22:53<1:00:44, 98.51s/it]
Task 1, Epoch 14/50 => Loss 0.563, Train_accy 85.54, Test_accy 76.56:  28%|██▊       | 14/50 [22:53<58:58, 98.30s/it]  
Task 0, Epoch 39/50 => Loss 0.462, Train_accy 88.39, Test_accy 82.89:  76%|███████▌  | 38/50 [1:54:38<35:11, 175.97s/it]
Task 0, Epoch 39/50 => Loss 0.462, Train_accy 88.39, Test_accy 82.89:  78%|███████▊  | 39/50 [1:54:38<32:07, 175.25s/it]
Task 1, Epoch 15/50 => Loss 0.560, Train_accy 85.92, Test_accy 78.48:  28%|██▊       | 14/50 [24:33<58:58, 98.30s/it]
Task 1, Epoch 15/50 => Loss 0.560, Train_accy 85.92, Test_accy 78.48:  30%|███       | 15/50 [24:33<57:39, 98.85s/it]
Task 1, Epoch 16/50 => Loss 0.542, Train_accy 86.15, Test_accy 78.71:  30%|███       | 15/50 [26:11<57:39, 98.85s/it]
Task 1, Epoch 16/50 => Loss 0.542, Train_accy 86.15, Test_accy 78.71:  32%|███▏      | 16/50 [26:11<55:50, 98.53s/it]
Task 0, Epoch 40/50 => Loss 0.455, Train_accy 88.56, Test_accy 81.86:  78%|███████▊  | 39/50 [1:57:36<32:07, 175.25s/it]
Task 0, Epoch 40/50 => Loss 0.455, Train_accy 88.56, Test_accy 81.86:  80%|████████  | 40/50 [1:57:36<29:20, 176.06s/it]
Task 1, Epoch 17/50 => Loss 0.529, Train_accy 86.88, Test_accy 78.95:  32%|███▏      | 16/50 [27:51<55:50, 98.53s/it]
Task 1, Epoch 17/50 => Loss 0.529, Train_accy 86.88, Test_accy 78.95:  34%|███▍      | 17/50 [27:51<54:26, 98.98s/it]
Task 0, Epoch 41/50 => Loss 0.453, Train_accy 88.72, Test_accy 81.62:  80%|████████  | 40/50 [2:00:30<29:20, 176.06s/it]
Task 0, Epoch 41/50 => Loss 0.453, Train_accy 88.72, Test_accy 81.62:  82%|████████▏ | 41/50 [2:00:30<26:19, 175.47s/it]
Task 1, Epoch 18/50 => Loss 0.538, Train_accy 86.32, Test_accy 80.10:  34%|███▍      | 17/50 [29:29<54:26, 98.98s/it]
Task 1, Epoch 18/50 => Loss 0.538, Train_accy 86.32, Test_accy 80.10:  36%|███▌      | 18/50 [29:29<52:42, 98.83s/it]
Task 1, Epoch 19/50 => Loss 0.517, Train_accy 87.14, Test_accy 78.53:  36%|███▌      | 18/50 [31:07<52:42, 98.83s/it]
Task 1, Epoch 19/50 => Loss 0.517, Train_accy 87.14, Test_accy 78.53:  38%|███▊      | 19/50 [31:07<50:52, 98.48s/it]
Task 0, Epoch 42/50 => Loss 0.471, Train_accy 87.93, Test_accy 82.40:  82%|████████▏ | 41/50 [2:03:26<26:19, 175.47s/it]
Task 0, Epoch 42/50 => Loss 0.471, Train_accy 87.93, Test_accy 82.40:  84%|████████▍ | 42/50 [2:03:26<23:24, 175.60s/it]
Task 1, Epoch 20/50 => Loss 0.515, Train_accy 87.20, Test_accy 80.15:  38%|███▊      | 19/50 [32:46<50:52, 98.48s/it]
Task 1, Epoch 20/50 => Loss 0.515, Train_accy 87.20, Test_accy 80.15:  40%|████      | 20/50 [32:46<49:19, 98.64s/it]
Task 1, Epoch 21/50 => Loss 0.507, Train_accy 87.01, Test_accy 80.22:  40%|████      | 20/50 [34:24<49:19, 98.64s/it]
Task 1, Epoch 21/50 => Loss 0.507, Train_accy 87.01, Test_accy 80.22:  42%|████▏     | 21/50 [34:24<47:34, 98.45s/it]
Task 0, Epoch 43/50 => Loss 0.444, Train_accy 88.79, Test_accy 81.93:  84%|████████▍ | 42/50 [2:06:22<23:24, 175.60s/it]
Task 0, Epoch 43/50 => Loss 0.444, Train_accy 88.79, Test_accy 81.93:  86%|████████▌ | 43/50 [2:06:22<20:29, 175.69s/it]
Task 1, Epoch 22/50 => Loss 0.498, Train_accy 87.42, Test_accy 79.28:  42%|████▏     | 21/50 [36:03<47:34, 98.45s/it]
Task 1, Epoch 22/50 => Loss 0.498, Train_accy 87.42, Test_accy 79.28:  44%|████▍     | 22/50 [36:03<46:03, 98.71s/it]
Task 1, Epoch 23/50 => Loss 0.511, Train_accy 87.25, Test_accy 80.88:  44%|████▍     | 22/50 [37:42<46:03, 98.71s/it]
Task 1, Epoch 23/50 => Loss 0.511, Train_accy 87.25, Test_accy 80.88:  46%|████▌     | 23/50 [37:42<44:27, 98.81s/it]
Task 0, Epoch 44/50 => Loss 0.454, Train_accy 88.65, Test_accy 82.22:  86%|████████▌ | 43/50 [2:09:19<20:29, 175.69s/it]
Task 0, Epoch 44/50 => Loss 0.454, Train_accy 88.65, Test_accy 82.22:  88%|████████▊ | 44/50 [2:09:19<17:35, 175.92s/it]
Task 1, Epoch 24/50 => Loss 0.506, Train_accy 87.13, Test_accy 81.23:  46%|████▌     | 23/50 [39:21<44:27, 98.81s/it]
Task 1, Epoch 24/50 => Loss 0.506, Train_accy 87.13, Test_accy 81.23:  48%|████▊     | 24/50 [39:21<42:47, 98.74s/it]
Task 0, Epoch 45/50 => Loss 0.449, Train_accy 88.67, Test_accy 82.69:  88%|████████▊ | 44/50 [2:12:12<17:35, 175.92s/it]
Task 0, Epoch 45/50 => Loss 0.449, Train_accy 88.67, Test_accy 82.69:  90%|█████████ | 45/50 [2:12:12<14:36, 175.25s/it]
Task 1, Epoch 25/50 => Loss 0.504, Train_accy 87.76, Test_accy 79.61:  48%|████▊     | 24/50 [41:00<42:47, 98.74s/it]
Task 1, Epoch 25/50 => Loss 0.504, Train_accy 87.76, Test_accy 79.61:  50%|█████     | 25/50 [41:00<41:13, 98.94s/it]
Task 1, Epoch 26/50 => Loss 0.496, Train_accy 87.38, Test_accy 81.38:  50%|█████     | 25/50 [42:38<41:13, 98.94s/it]
Task 1, Epoch 26/50 => Loss 0.496, Train_accy 87.38, Test_accy 81.38:  52%|█████▏    | 26/50 [42:38<39:28, 98.70s/it]
Task 0, Epoch 46/50 => Loss 0.453, Train_accy 88.69, Test_accy 82.24:  90%|█████████ | 45/50 [2:15:03<14:36, 175.25s/it]
Task 0, Epoch 46/50 => Loss 0.453, Train_accy 88.69, Test_accy 82.24:  92%|█████████▏| 46/50 [2:15:03<11:35, 173.99s/it]
Task 1, Epoch 27/50 => Loss 0.483, Train_accy 87.95, Test_accy 79.78:  52%|█████▏    | 26/50 [44:17<39:28, 98.70s/it]
Task 1, Epoch 27/50 => Loss 0.483, Train_accy 87.95, Test_accy 79.78:  54%|█████▍    | 27/50 [44:17<37:48, 98.65s/it]
Task 1, Epoch 28/50 => Loss 0.463, Train_accy 88.54, Test_accy 80.66:  54%|█████▍    | 27/50 [45:56<37:48, 98.65s/it]
Task 1, Epoch 28/50 => Loss 0.463, Train_accy 88.54, Test_accy 80.66:  56%|█████▌    | 28/50 [45:56<36:10, 98.67s/it]
Task 0, Epoch 47/50 => Loss 0.443, Train_accy 88.95, Test_accy 82.31:  92%|█████████▏| 46/50 [2:18:00<11:35, 173.99s/it]
Task 0, Epoch 47/50 => Loss 0.443, Train_accy 88.95, Test_accy 82.31:  94%|█████████▍| 47/50 [2:18:00<08:44, 174.72s/it]
Task 1, Epoch 29/50 => Loss 0.466, Train_accy 88.25, Test_accy 81.02:  56%|█████▌    | 28/50 [47:36<36:10, 98.67s/it]
Task 1, Epoch 29/50 => Loss 0.466, Train_accy 88.25, Test_accy 81.02:  58%|█████▊    | 29/50 [47:36<34:43, 99.21s/it]
Task 1, Epoch 30/50 => Loss 0.486, Train_accy 87.88, Test_accy 79.97:  58%|█████▊    | 29/50 [49:17<34:43, 99.21s/it]
Task 1, Epoch 30/50 => Loss 0.486, Train_accy 87.88, Test_accy 79.97:  60%|██████    | 30/50 [49:17<33:14, 99.75s/it]
Task 0, Epoch 48/50 => Loss 0.457, Train_accy 88.85, Test_accy 82.32:  94%|█████████▍| 47/50 [2:20:53<08:44, 174.72s/it]
Task 0, Epoch 48/50 => Loss 0.457, Train_accy 88.85, Test_accy 82.32:  96%|█████████▌| 48/50 [2:20:53<05:48, 174.12s/it]
Task 1, Epoch 31/50 => Loss 0.463, Train_accy 88.55, Test_accy 80.13:  60%|██████    | 30/50 [50:55<33:14, 99.75s/it]
Task 1, Epoch 31/50 => Loss 0.463, Train_accy 88.55, Test_accy 80.13:  62%|██████▏   | 31/50 [50:55<31:23, 99.14s/it]
Task 0, Epoch 49/50 => Loss 0.435, Train_accy 89.17, Test_accy 82.40:  96%|█████████▌| 48/50 [2:23:51<05:48, 174.12s/it]
Task 0, Epoch 49/50 => Loss 0.435, Train_accy 89.17, Test_accy 82.40:  98%|█████████▊| 49/50 [2:23:51<02:55, 175.40s/it]
Task 1, Epoch 32/50 => Loss 0.467, Train_accy 88.44, Test_accy 81.41:  62%|██████▏   | 31/50 [52:36<31:23, 99.14s/it]
Task 1, Epoch 32/50 => Loss 0.467, Train_accy 88.44, Test_accy 81.41:  64%|██████▍   | 32/50 [52:36<29:54, 99.69s/it]
Task 1, Epoch 33/50 => Loss 0.467, Train_accy 88.27, Test_accy 81.56:  64%|██████▍   | 32/50 [54:14<29:54, 99.69s/it]
Task 1, Epoch 33/50 => Loss 0.467, Train_accy 88.27, Test_accy 81.56:  66%|██████▌   | 33/50 [54:14<28:08, 99.34s/it]
Task 0, Epoch 50/50 => Loss 0.443, Train_accy 89.05, Test_accy 82.39:  98%|█████████▊| 49/50 [2:26:45<02:55, 175.40s/it]
Task 0, Epoch 50/50 => Loss 0.443, Train_accy 89.05, Test_accy 82.39: 100%|██████████| 50/50 [2:26:45<00:00, 174.96s/it]
Task 0, Epoch 50/50 => Loss 0.443, Train_accy 89.05, Test_accy 82.39: 100%|██████████| 50/50 [2:26:45<00:00, 176.11s/it]
2024-06-14 00:33:33,937 [lora_prompt.py] => Task 0, Epoch 50/50 => Loss 0.443, Train_accy 89.05, Test_accy 82.39

Task 1, Epoch 34/50 => Loss 0.456, Train_accy 88.58, Test_accy 81.36:  66%|██████▌   | 33/50 [55:54<28:08, 99.34s/it]
Task 1, Epoch 34/50 => Loss 0.456, Train_accy 88.58, Test_accy 81.36:  68%|██████▊   | 34/50 [55:54<26:30, 99.41s/it]
Task 1, Epoch 35/50 => Loss 0.453, Train_accy 88.74, Test_accy 81.57:  68%|██████▊   | 34/50 [57:30<26:30, 99.41s/it]
Task 1, Epoch 35/50 => Loss 0.453, Train_accy 88.74, Test_accy 81.57:  70%|███████   | 35/50 [57:30<24:37, 98.53s/it]
Task 1, Epoch 36/50 => Loss 0.463, Train_accy 88.48, Test_accy 81.59:  70%|███████   | 35/50 [59:08<24:37, 98.53s/it]
Task 1, Epoch 36/50 => Loss 0.463, Train_accy 88.48, Test_accy 81.59:  72%|███████▏  | 36/50 [59:08<22:56, 98.32s/it]
Task 1, Epoch 37/50 => Loss 0.459, Train_accy 89.06, Test_accy 81.01:  72%|███████▏  | 36/50 [1:00:46<22:56, 98.32s/it]
Task 1, Epoch 37/50 => Loss 0.459, Train_accy 89.06, Test_accy 81.01:  74%|███████▍  | 37/50 [1:00:46<21:18, 98.32s/it]
Task 1, Epoch 38/50 => Loss 0.453, Train_accy 88.97, Test_accy 81.51:  74%|███████▍  | 37/50 [1:02:25<21:18, 98.32s/it]
Task 1, Epoch 38/50 => Loss 0.453, Train_accy 88.97, Test_accy 81.51:  76%|███████▌  | 38/50 [1:02:25<19:40, 98.40s/it]
Task 1, Epoch 39/50 => Loss 0.445, Train_accy 88.94, Test_accy 80.86:  76%|███████▌  | 38/50 [1:04:04<19:40, 98.40s/it]
Task 1, Epoch 39/50 => Loss 0.445, Train_accy 88.94, Test_accy 80.86:  78%|███████▊  | 39/50 [1:04:04<18:03, 98.47s/it]
Task 1, Epoch 40/50 => Loss 0.444, Train_accy 89.00, Test_accy 81.76:  78%|███████▊  | 39/50 [1:05:41<18:03, 98.47s/it]
Task 1, Epoch 40/50 => Loss 0.444, Train_accy 89.00, Test_accy 81.76:  80%|████████  | 40/50 [1:05:41<16:22, 98.24s/it]2024-06-14 00:45:26,201 [lora_prompt.py] => Exemplar size: 0
2024-06-14 00:45:26,202 [trainer.py] => CNN: {'total': 82.45, '00-49': 82.45, 'old': 0, 'new': 82.45}
2024-06-14 00:45:26,202 [trainer.py] => CNN top1 curve: [82.45]
2024-06-14 00:45:26,208 [trainer.py] => All params: 840861697
2024-06-14 00:45:26,214 [trainer.py] => Trainable params: 204800
2024-06-14 00:45:26,214 [lora_prompt.py] => Learning on 50-100
Parameters to be updated: {'lora_image_model_pool.1.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'classifier_pool.1.ctx', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.1.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]
Task 1, Epoch 41/50 => Loss 0.440, Train_accy 89.42, Test_accy 82.03:  80%|████████  | 40/50 [1:07:20<16:22, 98.24s/it]
Task 1, Epoch 41/50 => Loss 0.440, Train_accy 89.42, Test_accy 82.03:  82%|████████▏ | 41/50 [1:07:20<14:44, 98.29s/it]
Task 1, Epoch 42/50 => Loss 0.439, Train_accy 89.18, Test_accy 81.85:  82%|████████▏ | 41/50 [1:08:59<14:44, 98.29s/it]
Task 1, Epoch 42/50 => Loss 0.439, Train_accy 89.18, Test_accy 81.85:  84%|████████▍ | 42/50 [1:08:59<13:07, 98.49s/it]
Task 1, Epoch 1/50 => Loss 2.089, Train_accy 21.90, Test_accy 33.91:   0%|          | 0/50 [02:57<?, ?it/s]
Task 1, Epoch 1/50 => Loss 2.089, Train_accy 21.90, Test_accy 33.91:   2%|▏         | 1/50 [02:57<2:25:07, 177.71s/it]
Task 1, Epoch 43/50 => Loss 0.441, Train_accy 89.25, Test_accy 82.22:  84%|████████▍ | 42/50 [1:10:37<13:07, 98.49s/it]
Task 1, Epoch 43/50 => Loss 0.441, Train_accy 89.25, Test_accy 82.22:  86%|████████▌ | 43/50 [1:10:37<11:29, 98.46s/it]
Task 1, Epoch 44/50 => Loss 0.433, Train_accy 89.38, Test_accy 81.53:  86%|████████▌ | 43/50 [1:12:17<11:29, 98.46s/it]
Task 1, Epoch 44/50 => Loss 0.433, Train_accy 89.38, Test_accy 81.53:  88%|████████▊ | 44/50 [1:12:17<09:53, 98.86s/it]
Task 1, Epoch 2/50 => Loss 1.507, Train_accy 51.78, Test_accy 60.48:   2%|▏         | 1/50 [05:51<2:25:07, 177.71s/it]
Task 1, Epoch 2/50 => Loss 1.507, Train_accy 51.78, Test_accy 60.48:   4%|▍         | 2/50 [05:51<2:20:20, 175.42s/it]
Task 1, Epoch 45/50 => Loss 0.432, Train_accy 89.36, Test_accy 81.78:  88%|████████▊ | 44/50 [1:13:56<09:53, 98.86s/it]
Task 1, Epoch 45/50 => Loss 0.432, Train_accy 89.36, Test_accy 81.78:  90%|█████████ | 45/50 [1:13:56<08:14, 98.81s/it]
Task 1, Epoch 46/50 => Loss 0.428, Train_accy 89.79, Test_accy 81.82:  90%|█████████ | 45/50 [1:15:33<08:14, 98.81s/it]
Task 1, Epoch 46/50 => Loss 0.428, Train_accy 89.79, Test_accy 81.82:  92%|█████████▏| 46/50 [1:15:33<06:34, 98.50s/it]
Task 1, Epoch 3/50 => Loss 1.035, Train_accy 70.58, Test_accy 62.15:   4%|▍         | 2/50 [08:49<2:20:20, 175.42s/it]
Task 1, Epoch 3/50 => Loss 1.035, Train_accy 70.58, Test_accy 62.15:   6%|▌         | 3/50 [08:49<2:18:26, 176.73s/it]
Task 1, Epoch 47/50 => Loss 0.420, Train_accy 89.66, Test_accy 81.86:  92%|█████████▏| 46/50 [1:17:11<06:34, 98.50s/it]
Task 1, Epoch 47/50 => Loss 0.420, Train_accy 89.66, Test_accy 81.86:  94%|█████████▍| 47/50 [1:17:11<04:54, 98.17s/it]
Task 1, Epoch 48/50 => Loss 0.438, Train_accy 89.24, Test_accy 81.91:  94%|█████████▍| 47/50 [1:18:51<04:54, 98.17s/it]
Task 1, Epoch 48/50 => Loss 0.438, Train_accy 89.24, Test_accy 81.91:  96%|█████████▌| 48/50 [1:18:51<03:17, 98.84s/it]
Task 1, Epoch 4/50 => Loss 0.885, Train_accy 76.83, Test_accy 73.47:   6%|▌         | 3/50 [11:44<2:18:26, 176.73s/it]
Task 1, Epoch 4/50 => Loss 0.885, Train_accy 76.83, Test_accy 73.47:   8%|▊         | 4/50 [11:44<2:14:57, 176.02s/it]
Task 1, Epoch 49/50 => Loss 0.434, Train_accy 89.56, Test_accy 81.89:  96%|█████████▌| 48/50 [1:20:31<03:17, 98.84s/it]
Task 1, Epoch 49/50 => Loss 0.434, Train_accy 89.56, Test_accy 81.89:  98%|█████████▊| 49/50 [1:20:31<01:39, 99.12s/it]
Task 1, Epoch 5/50 => Loss 0.765, Train_accy 79.91, Test_accy 75.20:   8%|▊         | 4/50 [14:39<2:14:57, 176.02s/it]
Task 1, Epoch 5/50 => Loss 0.765, Train_accy 79.91, Test_accy 75.20:  10%|█         | 5/50 [14:39<2:11:40, 175.57s/it]
Task 1, Epoch 50/50 => Loss 0.427, Train_accy 89.72, Test_accy 81.92:  98%|█████████▊| 49/50 [1:22:09<01:39, 99.12s/it]
Task 1, Epoch 50/50 => Loss 0.427, Train_accy 89.72, Test_accy 81.92: 100%|██████████| 50/50 [1:22:09<00:00, 98.76s/it]
Task 1, Epoch 50/50 => Loss 0.427, Train_accy 89.72, Test_accy 81.92: 100%|██████████| 50/50 [1:22:09<00:00, 98.59s/it]
2024-06-14 01:00:20,255 [lora_prompt.py] => Task 1, Epoch 50/50 => Loss 0.427, Train_accy 89.72, Test_accy 81.92

Task 1, Epoch 6/50 => Loss 0.705, Train_accy 81.78, Test_accy 77.41:  10%|█         | 5/50 [17:33<2:11:40, 175.57s/it]
Task 1, Epoch 6/50 => Loss 0.705, Train_accy 81.78, Test_accy 77.41:  12%|█▏        | 6/50 [17:33<2:08:17, 174.94s/it]
Task 1, Epoch 7/50 => Loss 0.679, Train_accy 82.97, Test_accy 77.19:  12%|█▏        | 6/50 [20:21<2:08:17, 174.94s/it]
Task 1, Epoch 7/50 => Loss 0.679, Train_accy 82.97, Test_accy 77.19:  14%|█▍        | 7/50 [20:21<2:03:50, 172.81s/it]/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 01:08:27,201 [lora_prompt.py] => Exemplar size: 0
2024-06-14 01:08:27,202 [trainer.py] => CNN: {'total': 82.5, '00-49': 82.5, 'old': 82.5, 'new': nan}
2024-06-14 01:08:27,202 [trainer.py] => CNN top1 curve: [82.45, 82.5]
2024-06-14 01:08:27,208 [trainer.py] => All params: 840861697
2024-06-14 01:08:27,214 [trainer.py] => Trainable params: 204800
2024-06-14 01:08:27,214 [lora_prompt.py] => Learning on 100-150
Parameters to be updated: {'lora_image_model_pool.2.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'classifier_pool.2.ctx', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]
Task 1, Epoch 8/50 => Loss 0.642, Train_accy 83.43, Test_accy 77.02:  14%|█▍        | 7/50 [23:14<2:03:50, 172.81s/it]
Task 1, Epoch 8/50 => Loss 0.642, Train_accy 83.43, Test_accy 77.02:  16%|█▌        | 8/50 [23:14<2:01:02, 172.92s/it]
Task 2, Epoch 1/50 => Loss 1.957, Train_accy 29.02, Test_accy 45.42:   0%|          | 0/50 [01:36<?, ?it/s]
Task 2, Epoch 1/50 => Loss 1.957, Train_accy 29.02, Test_accy 45.42:   2%|▏         | 1/50 [01:36<1:18:41, 96.36s/it]
Task 1, Epoch 9/50 => Loss 0.638, Train_accy 83.75, Test_accy 75.88:  16%|█▌        | 8/50 [26:06<2:01:02, 172.92s/it]
Task 1, Epoch 9/50 => Loss 0.638, Train_accy 83.75, Test_accy 75.88:  18%|█▊        | 9/50 [26:06<1:57:53, 172.52s/it]
Task 2, Epoch 2/50 => Loss 1.311, Train_accy 62.16, Test_accy 66.28:   2%|▏         | 1/50 [03:13<1:18:41, 96.36s/it]
Task 2, Epoch 2/50 => Loss 1.311, Train_accy 62.16, Test_accy 66.28:   4%|▍         | 2/50 [03:13<1:17:28, 96.85s/it]
Task 2, Epoch 3/50 => Loss 0.947, Train_accy 74.43, Test_accy 73.65:   4%|▍         | 2/50 [04:55<1:17:28, 96.85s/it]
Task 2, Epoch 3/50 => Loss 0.947, Train_accy 74.43, Test_accy 73.65:   6%|▌         | 3/50 [04:55<1:17:30, 98.96s/it]
Task 1, Epoch 10/50 => Loss 0.616, Train_accy 84.60, Test_accy 79.18:  18%|█▊        | 9/50 [29:03<1:57:53, 172.52s/it]
Task 1, Epoch 10/50 => Loss 0.616, Train_accy 84.60, Test_accy 79.18:  20%|██        | 10/50 [29:03<1:56:00, 174.00s/it]
Task 2, Epoch 4/50 => Loss 0.837, Train_accy 78.42, Test_accy 77.25:   6%|▌         | 3/50 [06:36<1:17:30, 98.96s/it]
Task 2, Epoch 4/50 => Loss 0.837, Train_accy 78.42, Test_accy 77.25:   8%|▊         | 4/50 [06:36<1:16:39, 99.99s/it]
Task 2, Epoch 5/50 => Loss 0.791, Train_accy 79.73, Test_accy 78.30:   8%|▊         | 4/50 [08:12<1:16:39, 99.99s/it]
Task 2, Epoch 5/50 => Loss 0.791, Train_accy 79.73, Test_accy 78.30:  10%|█         | 5/50 [08:12<1:13:51, 98.47s/it]
Task 1, Epoch 11/50 => Loss 0.585, Train_accy 85.26, Test_accy 79.47:  20%|██        | 10/50 [31:55<1:56:00, 174.00s/it]
Task 1, Epoch 11/50 => Loss 0.585, Train_accy 85.26, Test_accy 79.47:  22%|██▏       | 11/50 [31:55<1:52:33, 173.16s/it]
Task 2, Epoch 6/50 => Loss 0.768, Train_accy 80.09, Test_accy 78.12:  10%|█         | 5/50 [09:51<1:13:51, 98.47s/it]
Task 2, Epoch 6/50 => Loss 0.768, Train_accy 80.09, Test_accy 78.12:  12%|█▏        | 6/50 [09:51<1:12:16, 98.55s/it]
Task 2, Epoch 7/50 => Loss 0.708, Train_accy 81.28, Test_accy 79.50:  12%|█▏        | 6/50 [11:27<1:12:16, 98.55s/it]
Task 2, Epoch 7/50 => Loss 0.708, Train_accy 81.28, Test_accy 79.50:  14%|█▍        | 7/50 [11:27<1:10:10, 97.91s/it]
Task 1, Epoch 12/50 => Loss 0.569, Train_accy 86.03, Test_accy 77.93:  22%|██▏       | 11/50 [34:49<1:52:33, 173.16s/it]
Task 1, Epoch 12/50 => Loss 0.569, Train_accy 86.03, Test_accy 77.93:  24%|██▍       | 12/50 [34:49<1:49:50, 173.44s/it]
Task 2, Epoch 8/50 => Loss 0.693, Train_accy 82.19, Test_accy 80.81:  14%|█▍        | 7/50 [13:07<1:10:10, 97.91s/it]
Task 2, Epoch 8/50 => Loss 0.693, Train_accy 82.19, Test_accy 80.81:  16%|█▌        | 8/50 [13:07<1:08:54, 98.44s/it]
Task 1, Epoch 13/50 => Loss 0.567, Train_accy 85.84, Test_accy 78.22:  24%|██▍       | 12/50 [37:43<1:49:50, 173.44s/it]
Task 1, Epoch 13/50 => Loss 0.567, Train_accy 85.84, Test_accy 78.22:  26%|██▌       | 13/50 [37:43<1:47:09, 173.76s/it]
Task 2, Epoch 9/50 => Loss 0.689, Train_accy 82.16, Test_accy 79.67:  16%|█▌        | 8/50 [14:45<1:08:54, 98.44s/it]
Task 2, Epoch 9/50 => Loss 0.689, Train_accy 82.16, Test_accy 79.67:  18%|█▊        | 9/50 [14:45<1:07:12, 98.35s/it]
Task 2, Epoch 10/50 => Loss 0.681, Train_accy 82.64, Test_accy 79.98:  18%|█▊        | 9/50 [16:27<1:07:12, 98.35s/it]
Task 2, Epoch 10/50 => Loss 0.681, Train_accy 82.64, Test_accy 79.98:  20%|██        | 10/50 [16:27<1:06:22, 99.56s/it]
Task 1, Epoch 14/50 => Loss 0.563, Train_accy 85.54, Test_accy 76.56:  26%|██▌       | 13/50 [40:36<1:47:09, 173.76s/it]
Task 1, Epoch 14/50 => Loss 0.563, Train_accy 85.54, Test_accy 76.56:  28%|██▊       | 14/50 [40:36<1:44:09, 173.61s/it]
Task 2, Epoch 11/50 => Loss 0.670, Train_accy 82.76, Test_accy 79.76:  20%|██        | 10/50 [18:05<1:06:22, 99.56s/it]
Task 2, Epoch 11/50 => Loss 0.670, Train_accy 82.76, Test_accy 79.76:  22%|██▏       | 11/50 [18:05<1:04:23, 99.05s/it]
Task 2, Epoch 12/50 => Loss 0.650, Train_accy 83.62, Test_accy 79.47:  22%|██▏       | 11/50 [19:41<1:04:23, 99.05s/it]
Task 2, Epoch 12/50 => Loss 0.650, Train_accy 83.62, Test_accy 79.47:  24%|██▍       | 12/50 [19:41<1:02:10, 98.17s/it]
Task 1, Epoch 15/50 => Loss 0.560, Train_accy 85.92, Test_accy 78.48:  28%|██▊       | 14/50 [43:33<1:44:09, 173.61s/it]
Task 1, Epoch 15/50 => Loss 0.560, Train_accy 85.92, Test_accy 78.48:  30%|███       | 15/50 [43:33<1:41:51, 174.62s/it]
Task 2, Epoch 13/50 => Loss 0.630, Train_accy 83.84, Test_accy 80.02:  24%|██▍       | 12/50 [21:19<1:02:10, 98.17s/it]
Task 2, Epoch 13/50 => Loss 0.630, Train_accy 83.84, Test_accy 80.02:  26%|██▌       | 13/50 [21:19<1:00:30, 98.11s/it]
Task 2, Epoch 14/50 => Loss 0.622, Train_accy 83.94, Test_accy 81.09:  26%|██▌       | 13/50 [22:59<1:00:30, 98.11s/it]
Task 2, Epoch 14/50 => Loss 0.622, Train_accy 83.94, Test_accy 81.09:  28%|██▊       | 14/50 [22:59<59:05, 98.49s/it]  
Task 1, Epoch 16/50 => Loss 0.542, Train_accy 86.15, Test_accy 78.71:  30%|███       | 15/50 [46:25<1:41:51, 174.62s/it]
Task 1, Epoch 16/50 => Loss 0.542, Train_accy 86.15, Test_accy 78.71:  32%|███▏      | 16/50 [46:25<1:38:26, 173.73s/it]
Task 2, Epoch 15/50 => Loss 0.627, Train_accy 83.93, Test_accy 81.51:  28%|██▊       | 14/50 [24:35<59:05, 98.49s/it]
Task 2, Epoch 15/50 => Loss 0.627, Train_accy 83.93, Test_accy 81.51:  30%|███       | 15/50 [24:35<57:04, 97.85s/it]
Task 2, Epoch 16/50 => Loss 0.631, Train_accy 83.56, Test_accy 81.10:  30%|███       | 15/50 [26:12<57:04, 97.85s/it]
Task 2, Epoch 16/50 => Loss 0.631, Train_accy 83.56, Test_accy 81.10:  32%|███▏      | 16/50 [26:12<55:18, 97.59s/it]
Task 1, Epoch 17/50 => Loss 0.529, Train_accy 86.88, Test_accy 78.95:  32%|███▏      | 16/50 [49:22<1:38:26, 173.73s/it]
Task 1, Epoch 17/50 => Loss 0.529, Train_accy 86.88, Test_accy 78.95:  34%|███▍      | 17/50 [49:22<1:36:01, 174.60s/it]
Task 2, Epoch 17/50 => Loss 0.608, Train_accy 84.15, Test_accy 81.38:  32%|███▏      | 16/50 [27:49<55:18, 97.59s/it]
Task 2, Epoch 17/50 => Loss 0.608, Train_accy 84.15, Test_accy 81.38:  34%|███▍      | 17/50 [27:49<53:34, 97.41s/it]
Task 1, Epoch 18/50 => Loss 0.538, Train_accy 86.32, Test_accy 80.10:  34%|███▍      | 17/50 [52:12<1:36:01, 174.60s/it]
Task 1, Epoch 18/50 => Loss 0.538, Train_accy 86.32, Test_accy 80.10:  36%|███▌      | 18/50 [52:12<1:32:25, 173.31s/it]
Task 2, Epoch 18/50 => Loss 0.605, Train_accy 84.47, Test_accy 81.49:  34%|███▍      | 17/50 [29:26<53:34, 97.41s/it]
Task 2, Epoch 18/50 => Loss 0.605, Train_accy 84.47, Test_accy 81.49:  36%|███▌      | 18/50 [29:26<51:57, 97.41s/it]
Task 2, Epoch 19/50 => Loss 0.601, Train_accy 84.46, Test_accy 82.41:  36%|███▌      | 18/50 [31:06<51:57, 97.41s/it]
Task 2, Epoch 19/50 => Loss 0.601, Train_accy 84.46, Test_accy 82.41:  38%|███▊      | 19/50 [31:06<50:38, 98.00s/it]
Task 1, Epoch 19/50 => Loss 0.517, Train_accy 87.14, Test_accy 78.53:  36%|███▌      | 18/50 [55:10<1:32:25, 173.31s/it]
Task 1, Epoch 19/50 => Loss 0.517, Train_accy 87.14, Test_accy 78.53:  38%|███▊      | 19/50 [55:10<1:30:16, 174.73s/it]
Task 2, Epoch 20/50 => Loss 0.585, Train_accy 84.91, Test_accy 81.26:  38%|███▊      | 19/50 [32:45<50:38, 98.00s/it]
Task 2, Epoch 20/50 => Loss 0.585, Train_accy 84.91, Test_accy 81.26:  40%|████      | 20/50 [32:45<49:10, 98.36s/it]
Task 2, Epoch 21/50 => Loss 0.584, Train_accy 85.14, Test_accy 82.37:  40%|████      | 20/50 [34:22<49:10, 98.36s/it]
Task 2, Epoch 21/50 => Loss 0.584, Train_accy 85.14, Test_accy 82.37:  42%|████▏     | 21/50 [34:22<47:23, 98.06s/it]
Task 1, Epoch 20/50 => Loss 0.515, Train_accy 87.20, Test_accy 80.15:  38%|███▊      | 19/50 [58:04<1:30:16, 174.73s/it]
Task 1, Epoch 20/50 => Loss 0.515, Train_accy 87.20, Test_accy 80.15:  40%|████      | 20/50 [58:04<1:27:15, 174.52s/it]
Task 2, Epoch 22/50 => Loss 0.582, Train_accy 85.21, Test_accy 82.03:  42%|████▏     | 21/50 [36:01<47:23, 98.06s/it]
Task 2, Epoch 22/50 => Loss 0.582, Train_accy 85.21, Test_accy 82.03:  44%|████▍     | 22/50 [36:01<45:47, 98.14s/it]
Task 2, Epoch 23/50 => Loss 0.585, Train_accy 85.09, Test_accy 81.70:  44%|████▍     | 22/50 [37:37<45:47, 98.14s/it]
Task 2, Epoch 23/50 => Loss 0.585, Train_accy 85.09, Test_accy 81.70:  46%|████▌     | 23/50 [37:37<43:58, 97.73s/it]
Task 1, Epoch 21/50 => Loss 0.507, Train_accy 87.01, Test_accy 80.22:  40%|████      | 20/50 [1:00:56<1:27:15, 174.52s/it]
Task 1, Epoch 21/50 => Loss 0.507, Train_accy 87.01, Test_accy 80.22:  42%|████▏     | 21/50 [1:00:56<1:24:01, 173.85s/it]
Task 2, Epoch 24/50 => Loss 0.564, Train_accy 85.44, Test_accy 82.12:  46%|████▌     | 23/50 [39:16<43:58, 97.73s/it]
Task 2, Epoch 24/50 => Loss 0.564, Train_accy 85.44, Test_accy 82.12:  48%|████▊     | 24/50 [39:16<42:24, 97.88s/it]
Task 1, Epoch 22/50 => Loss 0.498, Train_accy 87.42, Test_accy 79.28:  42%|████▏     | 21/50 [1:03:49<1:24:01, 173.85s/it]
Task 1, Epoch 22/50 => Loss 0.498, Train_accy 87.42, Test_accy 79.28:  44%|████▍     | 22/50 [1:03:49<1:21:02, 173.65s/it]
Task 2, Epoch 25/50 => Loss 0.570, Train_accy 85.34, Test_accy 82.51:  48%|████▊     | 24/50 [40:51<42:24, 97.88s/it]
Task 2, Epoch 25/50 => Loss 0.570, Train_accy 85.34, Test_accy 82.51:  50%|█████     | 25/50 [40:51<40:30, 97.22s/it]
Task 2, Epoch 26/50 => Loss 0.547, Train_accy 85.97, Test_accy 81.96:  50%|█████     | 25/50 [42:29<40:30, 97.22s/it]
Task 2, Epoch 26/50 => Loss 0.547, Train_accy 85.97, Test_accy 81.96:  52%|█████▏    | 26/50 [42:29<38:57, 97.39s/it]
Task 1, Epoch 23/50 => Loss 0.511, Train_accy 87.25, Test_accy 80.88:  44%|████▍     | 22/50 [1:06:41<1:21:02, 173.65s/it]
Task 1, Epoch 23/50 => Loss 0.511, Train_accy 87.25, Test_accy 80.88:  46%|████▌     | 23/50 [1:06:41<1:17:52, 173.06s/it]
Task 2, Epoch 27/50 => Loss 0.549, Train_accy 86.09, Test_accy 82.56:  52%|█████▏    | 26/50 [44:06<38:57, 97.39s/it]
Task 2, Epoch 27/50 => Loss 0.549, Train_accy 86.09, Test_accy 82.56:  54%|█████▍    | 27/50 [44:06<37:15, 97.20s/it]
Task 2, Epoch 28/50 => Loss 0.551, Train_accy 85.81, Test_accy 81.89:  54%|█████▍    | 27/50 [45:42<37:15, 97.20s/it]
Task 2, Epoch 28/50 => Loss 0.551, Train_accy 85.81, Test_accy 81.89:  56%|█████▌    | 28/50 [45:42<35:32, 96.93s/it]
Task 1, Epoch 24/50 => Loss 0.506, Train_accy 87.13, Test_accy 81.23:  46%|████▌     | 23/50 [1:09:37<1:17:52, 173.06s/it]
Task 1, Epoch 24/50 => Loss 0.506, Train_accy 87.13, Test_accy 81.23:  48%|████▊     | 24/50 [1:09:37<1:15:21, 173.90s/it]
Task 2, Epoch 29/50 => Loss 0.546, Train_accy 86.09, Test_accy 82.24:  56%|█████▌    | 28/50 [47:18<35:32, 96.93s/it]
Task 2, Epoch 29/50 => Loss 0.546, Train_accy 86.09, Test_accy 82.24:  58%|█████▊    | 29/50 [47:18<33:49, 96.64s/it]
Task 2, Epoch 30/50 => Loss 0.548, Train_accy 85.90, Test_accy 82.68:  58%|█████▊    | 29/50 [48:57<33:49, 96.64s/it]
Task 2, Epoch 30/50 => Loss 0.548, Train_accy 85.90, Test_accy 82.68:  60%|██████    | 30/50 [48:57<32:27, 97.37s/it]
Task 1, Epoch 25/50 => Loss 0.504, Train_accy 87.76, Test_accy 79.61:  48%|████▊     | 24/50 [1:12:26<1:15:21, 173.90s/it]
Task 1, Epoch 25/50 => Loss 0.504, Train_accy 87.76, Test_accy 79.61:  50%|█████     | 25/50 [1:12:26<1:11:49, 172.37s/it]
Task 2, Epoch 31/50 => Loss 0.554, Train_accy 86.00, Test_accy 82.21:  60%|██████    | 30/50 [50:37<32:27, 97.37s/it]
Task 2, Epoch 31/50 => Loss 0.554, Train_accy 86.00, Test_accy 82.21:  62%|██████▏   | 31/50 [50:37<31:03, 98.09s/it]
Task 2, Epoch 32/50 => Loss 0.554, Train_accy 85.96, Test_accy 82.97:  62%|██████▏   | 31/50 [52:15<31:03, 98.09s/it]
Task 2, Epoch 32/50 => Loss 0.554, Train_accy 85.96, Test_accy 82.97:  64%|██████▍   | 32/50 [52:15<29:25, 98.09s/it]
Task 1, Epoch 26/50 => Loss 0.496, Train_accy 87.38, Test_accy 81.38:  50%|█████     | 25/50 [1:15:23<1:11:49, 172.37s/it]
Task 1, Epoch 26/50 => Loss 0.496, Train_accy 87.38, Test_accy 81.38:  52%|█████▏    | 26/50 [1:15:23<1:09:31, 173.79s/it]
Task 2, Epoch 33/50 => Loss 0.533, Train_accy 86.31, Test_accy 82.20:  64%|██████▍   | 32/50 [53:52<29:25, 98.09s/it]
Task 2, Epoch 33/50 => Loss 0.533, Train_accy 86.31, Test_accy 82.20:  66%|██████▌   | 33/50 [53:52<27:39, 97.64s/it]
Task 1, Epoch 27/50 => Loss 0.483, Train_accy 87.95, Test_accy 79.78:  52%|█████▏    | 26/50 [1:18:15<1:09:31, 173.79s/it]
Task 1, Epoch 27/50 => Loss 0.483, Train_accy 87.95, Test_accy 79.78:  54%|█████▍    | 27/50 [1:18:15<1:06:25, 173.29s/it]
Task 2, Epoch 34/50 => Loss 0.521, Train_accy 86.51, Test_accy 81.72:  66%|██████▌   | 33/50 [55:31<27:39, 97.64s/it]
Task 2, Epoch 34/50 => Loss 0.521, Train_accy 86.51, Test_accy 81.72:  68%|██████▊   | 34/50 [55:31<26:10, 98.15s/it]
Task 2, Epoch 35/50 => Loss 0.526, Train_accy 86.41, Test_accy 82.84:  68%|██████▊   | 34/50 [57:09<26:10, 98.15s/it]
Task 2, Epoch 35/50 => Loss 0.526, Train_accy 86.41, Test_accy 82.84:  70%|███████   | 35/50 [57:09<24:33, 98.24s/it]
Task 1, Epoch 28/50 => Loss 0.463, Train_accy 88.54, Test_accy 80.66:  54%|█████▍    | 27/50 [1:21:09<1:06:25, 173.29s/it]
Task 1, Epoch 28/50 => Loss 0.463, Train_accy 88.54, Test_accy 80.66:  56%|█████▌    | 28/50 [1:21:09<1:03:37, 173.54s/it]
Task 2, Epoch 36/50 => Loss 0.524, Train_accy 86.74, Test_accy 82.22:  70%|███████   | 35/50 [58:47<24:33, 98.24s/it]
Task 2, Epoch 36/50 => Loss 0.524, Train_accy 86.74, Test_accy 82.22:  72%|███████▏  | 36/50 [58:47<22:53, 98.11s/it]
Task 2, Epoch 37/50 => Loss 0.519, Train_accy 86.88, Test_accy 82.20:  72%|███████▏  | 36/50 [1:00:24<22:53, 98.11s/it]
Task 2, Epoch 37/50 => Loss 0.519, Train_accy 86.88, Test_accy 82.20:  74%|███████▍  | 37/50 [1:00:24<21:12, 97.85s/it]
Task 1, Epoch 29/50 => Loss 0.466, Train_accy 88.25, Test_accy 81.02:  56%|█████▌    | 28/50 [1:24:03<1:03:37, 173.54s/it]
Task 1, Epoch 29/50 => Loss 0.466, Train_accy 88.25, Test_accy 81.02:  58%|█████▊    | 29/50 [1:24:03<1:00:48, 173.72s/it]
Task 2, Epoch 38/50 => Loss 0.522, Train_accy 86.89, Test_accy 82.88:  74%|███████▍  | 37/50 [1:02:02<21:12, 97.85s/it]
Task 2, Epoch 38/50 => Loss 0.522, Train_accy 86.89, Test_accy 82.88:  76%|███████▌  | 38/50 [1:02:02<19:34, 97.89s/it]
Task 2, Epoch 39/50 => Loss 0.531, Train_accy 86.77, Test_accy 83.15:  76%|███████▌  | 38/50 [1:03:38<19:34, 97.89s/it]
Task 2, Epoch 39/50 => Loss 0.531, Train_accy 86.77, Test_accy 83.15:  78%|███████▊  | 39/50 [1:03:38<17:48, 97.13s/it]
Task 1, Epoch 30/50 => Loss 0.486, Train_accy 87.88, Test_accy 79.97:  58%|█████▊    | 29/50 [1:26:54<1:00:48, 173.72s/it]
Task 1, Epoch 30/50 => Loss 0.486, Train_accy 87.88, Test_accy 79.97:  60%|██████    | 30/50 [1:26:54<57:37, 172.88s/it]  
Task 2, Epoch 40/50 => Loss 0.522, Train_accy 86.84, Test_accy 82.86:  78%|███████▊  | 39/50 [1:05:13<17:48, 97.13s/it]
Task 2, Epoch 40/50 => Loss 0.522, Train_accy 86.84, Test_accy 82.86:  80%|████████  | 40/50 [1:05:13<16:06, 96.66s/it]
Task 1, Epoch 31/50 => Loss 0.463, Train_accy 88.55, Test_accy 80.13:  60%|██████    | 30/50 [1:29:48<57:37, 172.88s/it]
Task 1, Epoch 31/50 => Loss 0.463, Train_accy 88.55, Test_accy 80.13:  62%|██████▏   | 31/50 [1:29:48<54:48, 173.08s/it]
Task 2, Epoch 41/50 => Loss 0.520, Train_accy 86.75, Test_accy 83.10:  80%|████████  | 40/50 [1:06:50<16:06, 96.66s/it]
Task 2, Epoch 41/50 => Loss 0.520, Train_accy 86.75, Test_accy 83.10:  82%|████████▏ | 41/50 [1:06:50<14:31, 96.79s/it]
Task 2, Epoch 42/50 => Loss 0.491, Train_accy 87.35, Test_accy 83.31:  82%|████████▏ | 41/50 [1:08:29<14:31, 96.79s/it]
Task 2, Epoch 42/50 => Loss 0.491, Train_accy 87.35, Test_accy 83.31:  84%|████████▍ | 42/50 [1:08:29<12:58, 97.27s/it]
Task 1, Epoch 32/50 => Loss 0.467, Train_accy 88.44, Test_accy 81.41:  62%|██████▏   | 31/50 [1:32:39<54:48, 173.08s/it]
Task 1, Epoch 32/50 => Loss 0.467, Train_accy 88.44, Test_accy 81.41:  64%|██████▍   | 32/50 [1:32:39<51:43, 172.40s/it]
Task 2, Epoch 43/50 => Loss 0.510, Train_accy 87.18, Test_accy 83.02:  84%|████████▍ | 42/50 [1:10:07<12:58, 97.27s/it]
Task 2, Epoch 43/50 => Loss 0.510, Train_accy 87.18, Test_accy 83.02:  86%|████████▌ | 43/50 [1:10:07<11:22, 97.55s/it]
Task 2, Epoch 44/50 => Loss 0.508, Train_accy 87.01, Test_accy 83.04:  86%|████████▌ | 43/50 [1:11:43<11:22, 97.55s/it]
Task 2, Epoch 44/50 => Loss 0.508, Train_accy 87.01, Test_accy 83.04:  88%|████████▊ | 44/50 [1:11:43<09:42, 97.11s/it]
Task 1, Epoch 33/50 => Loss 0.467, Train_accy 88.27, Test_accy 81.56:  64%|██████▍   | 32/50 [1:35:34<51:43, 172.40s/it]
Task 1, Epoch 33/50 => Loss 0.467, Train_accy 88.27, Test_accy 81.56:  66%|██████▌   | 33/50 [1:35:34<49:07, 173.40s/it]
Task 2, Epoch 45/50 => Loss 0.514, Train_accy 87.32, Test_accy 83.21:  88%|████████▊ | 44/50 [1:13:21<09:42, 97.11s/it]
Task 2, Epoch 45/50 => Loss 0.514, Train_accy 87.32, Test_accy 83.21:  90%|█████████ | 45/50 [1:13:21<08:07, 97.47s/it]
Task 2, Epoch 46/50 => Loss 0.500, Train_accy 87.74, Test_accy 83.18:  90%|█████████ | 45/50 [1:15:01<08:07, 97.47s/it]
Task 2, Epoch 46/50 => Loss 0.500, Train_accy 87.74, Test_accy 83.18:  92%|█████████▏| 46/50 [1:15:01<06:32, 98.04s/it]
Task 1, Epoch 34/50 => Loss 0.456, Train_accy 88.58, Test_accy 81.36:  66%|██████▌   | 33/50 [1:38:24<49:07, 173.40s/it]
Task 1, Epoch 34/50 => Loss 0.456, Train_accy 88.58, Test_accy 81.36:  68%|██████▊   | 34/50 [1:38:24<45:56, 172.27s/it]
Task 2, Epoch 47/50 => Loss 0.499, Train_accy 87.52, Test_accy 83.17:  92%|█████████▏| 46/50 [1:16:38<06:32, 98.04s/it]
Task 2, Epoch 47/50 => Loss 0.499, Train_accy 87.52, Test_accy 83.17:  94%|█████████▍| 47/50 [1:16:38<04:53, 97.67s/it]
Task 1, Epoch 35/50 => Loss 0.453, Train_accy 88.74, Test_accy 81.57:  68%|██████▊   | 34/50 [1:41:17<45:56, 172.27s/it]
Task 1, Epoch 35/50 => Loss 0.453, Train_accy 88.74, Test_accy 81.57:  70%|███████   | 35/50 [1:41:17<43:07, 172.51s/it]
Task 2, Epoch 48/50 => Loss 0.503, Train_accy 87.44, Test_accy 83.11:  94%|█████████▍| 47/50 [1:18:17<04:53, 97.67s/it]
Task 2, Epoch 48/50 => Loss 0.503, Train_accy 87.44, Test_accy 83.11:  96%|█████████▌| 48/50 [1:18:17<03:16, 98.06s/it]
Task 2, Epoch 49/50 => Loss 0.502, Train_accy 87.36, Test_accy 83.14:  96%|█████████▌| 48/50 [1:19:52<03:16, 98.06s/it]
Task 2, Epoch 49/50 => Loss 0.502, Train_accy 87.36, Test_accy 83.14:  98%|█████████▊| 49/50 [1:19:52<01:37, 97.32s/it]
Task 1, Epoch 36/50 => Loss 0.463, Train_accy 88.48, Test_accy 81.59:  70%|███████   | 35/50 [1:44:10<43:07, 172.51s/it]
Task 1, Epoch 36/50 => Loss 0.463, Train_accy 88.48, Test_accy 81.59:  72%|███████▏  | 36/50 [1:44:10<40:15, 172.56s/it]
Task 2, Epoch 50/50 => Loss 0.510, Train_accy 87.42, Test_accy 83.15:  98%|█████████▊| 49/50 [1:21:30<01:37, 97.32s/it]
Task 2, Epoch 50/50 => Loss 0.510, Train_accy 87.42, Test_accy 83.15: 100%|██████████| 50/50 [1:21:30<00:00, 97.53s/it]
Task 2, Epoch 50/50 => Loss 0.510, Train_accy 87.42, Test_accy 83.15: 100%|██████████| 50/50 [1:21:30<00:00, 97.81s/it]
2024-06-14 02:30:00,442 [lora_prompt.py] => Task 2, Epoch 50/50 => Loss 0.510, Train_accy 87.42, Test_accy 83.15

Task 1, Epoch 37/50 => Loss 0.459, Train_accy 89.06, Test_accy 81.01:  72%|███████▏  | 36/50 [1:47:01<40:15, 172.56s/it]
Task 1, Epoch 37/50 => Loss 0.459, Train_accy 89.06, Test_accy 81.01:  74%|███████▍  | 37/50 [1:47:01<37:20, 172.33s/it]
Task 1, Epoch 38/50 => Loss 0.453, Train_accy 88.97, Test_accy 81.51:  74%|███████▍  | 37/50 [1:49:55<37:20, 172.33s/it]
Task 1, Epoch 38/50 => Loss 0.453, Train_accy 88.97, Test_accy 81.51:  76%|███████▌  | 38/50 [1:49:55<34:32, 172.68s/it]
Task 1, Epoch 39/50 => Loss 0.445, Train_accy 88.94, Test_accy 80.86:  76%|███████▌  | 38/50 [1:52:47<34:32, 172.68s/it]
Task 1, Epoch 39/50 => Loss 0.445, Train_accy 88.94, Test_accy 80.86:  78%|███████▊  | 39/50 [1:52:47<31:37, 172.49s/it]/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 02:38:16,838 [lora_prompt.py] => Exemplar size: 0
2024-06-14 02:38:16,839 [trainer.py] => CNN: {'total': 83.76, '00-49': 83.76, 'old': 83.76, 'new': nan}
2024-06-14 02:38:16,840 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76]
2024-06-14 02:38:16,851 [trainer.py] => All params: 840861697
2024-06-14 02:38:16,857 [trainer.py] => Trainable params: 204800
2024-06-14 02:38:16,857 [lora_prompt.py] => Learning on 150-200
Parameters to be updated: {'lora_image_model_pool.3.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'classifier_pool.3.ctx', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]
Task 3, Epoch 1/50 => Loss 2.020, Train_accy 31.71, Test_accy 56.30:   0%|          | 0/50 [01:33<?, ?it/s]
Task 3, Epoch 1/50 => Loss 2.020, Train_accy 31.71, Test_accy 56.30:   2%|▏         | 1/50 [01:33<1:16:38, 93.85s/it]
Task 1, Epoch 40/50 => Loss 0.444, Train_accy 89.00, Test_accy 81.76:  78%|███████▊  | 39/50 [1:55:43<31:37, 172.49s/it]
Task 1, Epoch 40/50 => Loss 0.444, Train_accy 89.00, Test_accy 81.76:  80%|████████  | 40/50 [1:55:43<28:54, 173.43s/it]
Task 3, Epoch 2/50 => Loss 1.372, Train_accy 61.28, Test_accy 69.09:   2%|▏         | 1/50 [03:10<1:16:38, 93.85s/it]
Task 3, Epoch 2/50 => Loss 1.372, Train_accy 61.28, Test_accy 69.09:   4%|▍         | 2/50 [03:10<1:16:20, 95.42s/it]
Task 3, Epoch 3/50 => Loss 1.113, Train_accy 69.80, Test_accy 76.16:   4%|▍         | 2/50 [04:46<1:16:20, 95.42s/it]
Task 3, Epoch 3/50 => Loss 1.113, Train_accy 69.80, Test_accy 76.16:   6%|▌         | 3/50 [04:46<1:14:52, 95.59s/it]
Task 1, Epoch 41/50 => Loss 0.440, Train_accy 89.42, Test_accy 82.03:  80%|████████  | 40/50 [1:58:31<28:54, 173.43s/it]
Task 1, Epoch 41/50 => Loss 0.440, Train_accy 89.42, Test_accy 82.03:  82%|████████▏ | 41/50 [1:58:31<25:48, 172.05s/it]
Task 3, Epoch 4/50 => Loss 0.975, Train_accy 74.48, Test_accy 75.30:   6%|▌         | 3/50 [06:23<1:14:52, 95.59s/it]
Task 3, Epoch 4/50 => Loss 0.975, Train_accy 74.48, Test_accy 75.30:   8%|▊         | 4/50 [06:23<1:13:57, 96.47s/it]
Task 3, Epoch 5/50 => Loss 0.930, Train_accy 75.78, Test_accy 77.35:   8%|▊         | 4/50 [07:59<1:13:57, 96.47s/it]
Task 3, Epoch 5/50 => Loss 0.930, Train_accy 75.78, Test_accy 77.35:  10%|█         | 5/50 [07:59<1:12:04, 96.10s/it]
Task 1, Epoch 42/50 => Loss 0.439, Train_accy 89.18, Test_accy 81.85:  82%|████████▏ | 41/50 [2:01:27<25:48, 172.05s/it]
Task 1, Epoch 42/50 => Loss 0.439, Train_accy 89.18, Test_accy 81.85:  84%|████████▍ | 42/50 [2:01:27<23:05, 173.14s/it]
Task 3, Epoch 6/50 => Loss 0.910, Train_accy 76.23, Test_accy 78.33:  10%|█         | 5/50 [09:35<1:12:04, 96.10s/it]
Task 3, Epoch 6/50 => Loss 0.910, Train_accy 76.23, Test_accy 78.33:  12%|█▏        | 6/50 [09:35<1:10:26, 96.06s/it]
Task 3, Epoch 7/50 => Loss 0.871, Train_accy 77.82, Test_accy 78.15:  12%|█▏        | 6/50 [11:12<1:10:26, 96.06s/it]
Task 3, Epoch 7/50 => Loss 0.871, Train_accy 77.82, Test_accy 78.15:  14%|█▍        | 7/50 [11:12<1:09:09, 96.50s/it]
Task 1, Epoch 43/50 => Loss 0.441, Train_accy 89.25, Test_accy 82.22:  84%|████████▍ | 42/50 [2:04:17<23:05, 173.14s/it]
Task 1, Epoch 43/50 => Loss 0.441, Train_accy 89.25, Test_accy 82.22:  86%|████████▌ | 43/50 [2:04:17<20:04, 172.01s/it]
Task 3, Epoch 8/50 => Loss 0.826, Train_accy 78.38, Test_accy 80.04:  14%|█▍        | 7/50 [12:49<1:09:09, 96.50s/it]
Task 3, Epoch 8/50 => Loss 0.826, Train_accy 78.38, Test_accy 80.04:  16%|█▌        | 8/50 [12:49<1:07:38, 96.64s/it]
Task 1, Epoch 44/50 => Loss 0.433, Train_accy 89.38, Test_accy 81.53:  86%|████████▌ | 43/50 [2:07:12<20:04, 172.01s/it]
Task 1, Epoch 44/50 => Loss 0.433, Train_accy 89.38, Test_accy 81.53:  88%|████████▊ | 44/50 [2:07:12<17:18, 173.12s/it]
Task 3, Epoch 9/50 => Loss 0.842, Train_accy 78.22, Test_accy 79.21:  16%|█▌        | 8/50 [14:26<1:07:38, 96.64s/it]
Task 3, Epoch 9/50 => Loss 0.842, Train_accy 78.22, Test_accy 79.21:  18%|█▊        | 9/50 [14:26<1:06:08, 96.78s/it]
Task 3, Epoch 10/50 => Loss 0.832, Train_accy 78.44, Test_accy 81.42:  18%|█▊        | 9/50 [16:03<1:06:08, 96.78s/it]
Task 3, Epoch 10/50 => Loss 0.832, Train_accy 78.44, Test_accy 81.42:  20%|██        | 10/50 [16:03<1:04:24, 96.61s/it]
Task 1, Epoch 45/50 => Loss 0.432, Train_accy 89.36, Test_accy 81.78:  88%|████████▊ | 44/50 [2:10:04<17:18, 173.12s/it]
Task 1, Epoch 45/50 => Loss 0.432, Train_accy 89.36, Test_accy 81.78:  90%|█████████ | 45/50 [2:10:04<14:23, 172.77s/it]
Task 3, Epoch 11/50 => Loss 0.813, Train_accy 79.17, Test_accy 79.83:  20%|██        | 10/50 [17:39<1:04:24, 96.61s/it]
Task 3, Epoch 11/50 => Loss 0.813, Train_accy 79.17, Test_accy 79.83:  22%|██▏       | 11/50 [17:39<1:02:48, 96.62s/it]
Task 3, Epoch 12/50 => Loss 0.811, Train_accy 78.92, Test_accy 80.40:  22%|██▏       | 11/50 [19:16<1:02:48, 96.62s/it]
Task 3, Epoch 12/50 => Loss 0.811, Train_accy 78.92, Test_accy 80.40:  24%|██▍       | 12/50 [19:16<1:01:18, 96.81s/it]
Task 1, Epoch 46/50 => Loss 0.428, Train_accy 89.79, Test_accy 81.82:  90%|█████████ | 45/50 [2:12:56<14:23, 172.77s/it]
Task 1, Epoch 46/50 => Loss 0.428, Train_accy 89.79, Test_accy 81.82:  92%|█████████▏| 46/50 [2:12:56<11:29, 172.43s/it]
Task 3, Epoch 13/50 => Loss 0.772, Train_accy 79.99, Test_accy 80.51:  24%|██▍       | 12/50 [20:52<1:01:18, 96.81s/it]
Task 3, Epoch 13/50 => Loss 0.772, Train_accy 79.99, Test_accy 80.51:  26%|██▌       | 13/50 [20:52<59:30, 96.50s/it]  
Task 3, Epoch 14/50 => Loss 0.775, Train_accy 80.41, Test_accy 77.70:  26%|██▌       | 13/50 [22:27<59:30, 96.50s/it]
Task 3, Epoch 14/50 => Loss 0.775, Train_accy 80.41, Test_accy 77.70:  28%|██▊       | 14/50 [22:27<57:35, 96.00s/it]
Task 1, Epoch 47/50 => Loss 0.420, Train_accy 89.66, Test_accy 81.86:  92%|█████████▏| 46/50 [2:15:48<11:29, 172.43s/it]
Task 1, Epoch 47/50 => Loss 0.420, Train_accy 89.66, Test_accy 81.86:  94%|█████████▍| 47/50 [2:15:48<08:37, 172.49s/it]
Task 3, Epoch 15/50 => Loss 0.794, Train_accy 79.70, Test_accy 80.91:  28%|██▊       | 14/50 [24:04<57:35, 96.00s/it]
Task 3, Epoch 15/50 => Loss 0.794, Train_accy 79.70, Test_accy 80.91:  30%|███       | 15/50 [24:04<56:12, 96.36s/it]
Task 3, Epoch 16/50 => Loss 0.769, Train_accy 80.01, Test_accy 80.39:  30%|███       | 15/50 [25:42<56:12, 96.36s/it]
Task 3, Epoch 16/50 => Loss 0.769, Train_accy 80.01, Test_accy 80.39:  32%|███▏      | 16/50 [25:42<54:52, 96.85s/it]
Task 1, Epoch 48/50 => Loss 0.438, Train_accy 89.24, Test_accy 81.91:  94%|█████████▍| 47/50 [2:18:39<08:37, 172.49s/it]
Task 1, Epoch 48/50 => Loss 0.438, Train_accy 89.24, Test_accy 81.91:  96%|█████████▌| 48/50 [2:18:39<05:43, 171.90s/it]
Task 3, Epoch 17/50 => Loss 0.749, Train_accy 81.12, Test_accy 80.08:  32%|███▏      | 16/50 [27:19<54:52, 96.85s/it]
Task 3, Epoch 17/50 => Loss 0.749, Train_accy 81.12, Test_accy 80.08:  34%|███▍      | 17/50 [27:19<53:10, 96.67s/it]
Task 1, Epoch 49/50 => Loss 0.434, Train_accy 89.56, Test_accy 81.89:  96%|█████████▌| 48/50 [2:21:34<05:43, 171.90s/it]
Task 1, Epoch 49/50 => Loss 0.434, Train_accy 89.56, Test_accy 81.89:  98%|█████████▊| 49/50 [2:21:34<02:52, 172.88s/it]
Task 3, Epoch 18/50 => Loss 0.740, Train_accy 81.35, Test_accy 81.39:  34%|███▍      | 17/50 [28:56<53:10, 96.67s/it]
Task 3, Epoch 18/50 => Loss 0.740, Train_accy 81.35, Test_accy 81.39:  36%|███▌      | 18/50 [28:56<51:42, 96.95s/it]
Task 3, Epoch 19/50 => Loss 0.744, Train_accy 80.90, Test_accy 81.20:  36%|███▌      | 18/50 [30:32<51:42, 96.95s/it]
Task 3, Epoch 19/50 => Loss 0.744, Train_accy 80.90, Test_accy 81.20:  38%|███▊      | 19/50 [30:32<49:56, 96.65s/it]
Task 1, Epoch 50/50 => Loss 0.427, Train_accy 89.72, Test_accy 81.92:  98%|█████████▊| 49/50 [2:24:24<02:52, 172.88s/it]
Task 1, Epoch 50/50 => Loss 0.427, Train_accy 89.72, Test_accy 81.92: 100%|██████████| 50/50 [2:24:24<00:00, 171.82s/it]
Task 1, Epoch 50/50 => Loss 0.427, Train_accy 89.72, Test_accy 81.92: 100%|██████████| 50/50 [2:24:24<00:00, 173.28s/it]
2024-06-14 03:09:52,794 [lora_prompt.py] => Task 1, Epoch 50/50 => Loss 0.427, Train_accy 89.72, Test_accy 81.92

Task 3, Epoch 20/50 => Loss 0.725, Train_accy 81.64, Test_accy 81.27:  38%|███▊      | 19/50 [32:09<49:56, 96.65s/it]
Task 3, Epoch 20/50 => Loss 0.725, Train_accy 81.64, Test_accy 81.27:  40%|████      | 20/50 [32:09<48:18, 96.62s/it]
Task 3, Epoch 21/50 => Loss 0.724, Train_accy 81.60, Test_accy 82.99:  40%|████      | 20/50 [33:44<48:18, 96.62s/it]
Task 3, Epoch 21/50 => Loss 0.724, Train_accy 81.60, Test_accy 82.99:  42%|████▏     | 21/50 [33:44<46:31, 96.26s/it]
Task 3, Epoch 22/50 => Loss 0.739, Train_accy 81.21, Test_accy 80.92:  42%|████▏     | 21/50 [35:19<46:31, 96.26s/it]
Task 3, Epoch 22/50 => Loss 0.739, Train_accy 81.21, Test_accy 80.92:  44%|████▍     | 22/50 [35:19<44:44, 95.89s/it]
Task 3, Epoch 23/50 => Loss 0.728, Train_accy 81.35, Test_accy 81.39:  44%|████▍     | 22/50 [36:57<44:44, 95.89s/it]
Task 3, Epoch 23/50 => Loss 0.728, Train_accy 81.35, Test_accy 81.39:  46%|████▌     | 23/50 [36:57<43:24, 96.44s/it]
Task 3, Epoch 24/50 => Loss 0.713, Train_accy 81.93, Test_accy 81.88:  46%|████▌     | 23/50 [38:33<43:24, 96.44s/it]
Task 3, Epoch 24/50 => Loss 0.713, Train_accy 81.93, Test_accy 81.88:  48%|████▊     | 24/50 [38:33<41:45, 96.37s/it]
Task 3, Epoch 25/50 => Loss 0.698, Train_accy 82.04, Test_accy 82.70:  48%|████▊     | 24/50 [40:08<41:45, 96.37s/it]
Task 3, Epoch 25/50 => Loss 0.698, Train_accy 82.04, Test_accy 82.70:  50%|█████     | 25/50 [40:08<40:00, 96.03s/it]
Task 3, Epoch 26/50 => Loss 0.679, Train_accy 82.63, Test_accy 83.11:  50%|█████     | 25/50 [41:46<40:00, 96.03s/it]
Task 3, Epoch 26/50 => Loss 0.679, Train_accy 82.63, Test_accy 83.11:  52%|█████▏    | 26/50 [41:46<38:37, 96.58s/it]
Task 3, Epoch 27/50 => Loss 0.681, Train_accy 82.61, Test_accy 82.23:  52%|█████▏    | 26/50 [43:23<38:37, 96.58s/it]
Task 3, Epoch 27/50 => Loss 0.681, Train_accy 82.61, Test_accy 82.23:  54%|█████▍    | 27/50 [43:23<37:05, 96.76s/it]/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 03:21:51,409 [lora_prompt.py] => Exemplar size: 0
2024-06-14 03:21:51,410 [trainer.py] => CNN: {'total': 82.5, '00-49': 82.5, 'old': 82.5, 'new': nan}
2024-06-14 03:21:51,410 [trainer.py] => CNN top1 curve: [82.45, 82.5]
2024-06-14 03:21:51,417 [trainer.py] => All params: 840861697
2024-06-14 03:21:51,423 [trainer.py] => Trainable params: 204800
2024-06-14 03:21:51,424 [lora_prompt.py] => Learning on 100-150
Parameters to be updated: {'lora_image_model_pool.2.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'classifier_pool.2.ctx', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.2.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]
Task 3, Epoch 28/50 => Loss 0.665, Train_accy 83.14, Test_accy 82.40:  54%|█████▍    | 27/50 [44:59<37:05, 96.76s/it]
Task 3, Epoch 28/50 => Loss 0.665, Train_accy 83.14, Test_accy 82.40:  56%|█████▌    | 28/50 [44:59<35:23, 96.53s/it]
Task 2, Epoch 1/50 => Loss 1.957, Train_accy 29.02, Test_accy 45.42:   0%|          | 0/50 [02:52<?, ?it/s]
Task 2, Epoch 1/50 => Loss 1.957, Train_accy 29.02, Test_accy 45.42:   2%|▏         | 1/50 [02:52<2:20:28, 172.01s/it]
Task 3, Epoch 29/50 => Loss 0.685, Train_accy 82.70, Test_accy 81.87:  56%|█████▌    | 28/50 [46:34<35:23, 96.53s/it]
Task 3, Epoch 29/50 => Loss 0.685, Train_accy 82.70, Test_accy 81.87:  58%|█████▊    | 29/50 [46:34<33:38, 96.10s/it]
Task 3, Epoch 30/50 => Loss 0.675, Train_accy 82.89, Test_accy 82.33:  58%|█████▊    | 29/50 [48:11<33:38, 96.10s/it]
Task 3, Epoch 30/50 => Loss 0.675, Train_accy 82.89, Test_accy 82.33:  60%|██████    | 30/50 [48:11<32:05, 96.28s/it]
Task 2, Epoch 2/50 => Loss 1.311, Train_accy 62.16, Test_accy 66.28:   2%|▏         | 1/50 [05:42<2:20:28, 172.01s/it]
Task 2, Epoch 2/50 => Loss 1.311, Train_accy 62.16, Test_accy 66.28:   4%|▍         | 2/50 [05:42<2:17:05, 171.37s/it]
Task 3, Epoch 31/50 => Loss 0.674, Train_accy 82.85, Test_accy 82.85:  60%|██████    | 30/50 [49:49<32:05, 96.28s/it]
Task 3, Epoch 31/50 => Loss 0.674, Train_accy 82.85, Test_accy 82.85:  62%|██████▏   | 31/50 [49:49<30:39, 96.82s/it]
Task 3, Epoch 32/50 => Loss 0.673, Train_accy 83.23, Test_accy 82.94:  62%|██████▏   | 31/50 [51:25<30:39, 96.82s/it]
Task 3, Epoch 32/50 => Loss 0.673, Train_accy 83.23, Test_accy 82.94:  64%|██████▍   | 32/50 [51:25<28:54, 96.38s/it]
Task 2, Epoch 3/50 => Loss 0.947, Train_accy 74.43, Test_accy 73.65:   4%|▍         | 2/50 [08:36<2:17:05, 171.37s/it]
Task 2, Epoch 3/50 => Loss 0.947, Train_accy 74.43, Test_accy 73.65:   6%|▌         | 3/50 [08:36<2:15:10, 172.57s/it]
Task 3, Epoch 33/50 => Loss 0.674, Train_accy 83.05, Test_accy 82.89:  64%|██████▍   | 32/50 [53:00<28:54, 96.38s/it]
Task 3, Epoch 33/50 => Loss 0.674, Train_accy 83.05, Test_accy 82.89:  66%|██████▌   | 33/50 [53:00<27:15, 96.18s/it]
Task 3, Epoch 34/50 => Loss 0.666, Train_accy 83.09, Test_accy 83.28:  66%|██████▌   | 33/50 [54:37<27:15, 96.18s/it]
Task 3, Epoch 34/50 => Loss 0.666, Train_accy 83.09, Test_accy 83.28:  68%|██████▊   | 34/50 [54:37<25:42, 96.42s/it]
Task 2, Epoch 4/50 => Loss 0.837, Train_accy 78.42, Test_accy 77.25:   6%|▌         | 3/50 [11:25<2:15:10, 172.57s/it]
Task 2, Epoch 4/50 => Loss 0.837, Train_accy 78.42, Test_accy 77.25:   8%|▊         | 4/50 [11:25<2:11:05, 170.98s/it]
Task 3, Epoch 35/50 => Loss 0.666, Train_accy 83.21, Test_accy 82.89:  68%|██████▊   | 34/50 [56:14<25:42, 96.42s/it]
Task 3, Epoch 35/50 => Loss 0.666, Train_accy 83.21, Test_accy 82.89:  70%|███████   | 35/50 [56:14<24:08, 96.56s/it]
Task 3, Epoch 36/50 => Loss 0.650, Train_accy 83.39, Test_accy 83.66:  70%|███████   | 35/50 [57:50<24:08, 96.56s/it]
Task 3, Epoch 36/50 => Loss 0.650, Train_accy 83.39, Test_accy 83.66:  72%|███████▏  | 36/50 [57:50<22:27, 96.22s/it]
Task 2, Epoch 5/50 => Loss 0.791, Train_accy 79.73, Test_accy 78.30:   8%|▊         | 4/50 [14:16<2:11:05, 170.98s/it]
Task 2, Epoch 5/50 => Loss 0.791, Train_accy 79.73, Test_accy 78.30:  10%|█         | 5/50 [14:16<2:08:07, 170.84s/it]
Task 3, Epoch 37/50 => Loss 0.669, Train_accy 83.10, Test_accy 83.95:  72%|███████▏  | 36/50 [59:24<22:27, 96.22s/it]
Task 3, Epoch 37/50 => Loss 0.669, Train_accy 83.10, Test_accy 83.95:  74%|███████▍  | 37/50 [59:24<20:42, 95.57s/it]
Task 2, Epoch 6/50 => Loss 0.768, Train_accy 80.09, Test_accy 78.12:  10%|█         | 5/50 [17:10<2:08:07, 170.84s/it]
Task 2, Epoch 6/50 => Loss 0.768, Train_accy 80.09, Test_accy 78.12:  12%|█▏        | 6/50 [17:10<2:06:05, 171.95s/it]
Task 3, Epoch 38/50 => Loss 0.660, Train_accy 83.61, Test_accy 83.70:  74%|███████▍  | 37/50 [1:00:58<20:42, 95.57s/it]
Task 3, Epoch 38/50 => Loss 0.660, Train_accy 83.61, Test_accy 83.70:  76%|███████▌  | 38/50 [1:00:58<19:04, 95.34s/it]
Task 3, Epoch 39/50 => Loss 0.650, Train_accy 83.70, Test_accy 83.84:  76%|███████▌  | 38/50 [1:02:33<19:04, 95.34s/it]
Task 3, Epoch 39/50 => Loss 0.650, Train_accy 83.70, Test_accy 83.84:  78%|███████▊  | 39/50 [1:02:33<17:26, 95.18s/it]
Task 2, Epoch 7/50 => Loss 0.708, Train_accy 81.28, Test_accy 79.50:  12%|█▏        | 6/50 [19:59<2:06:05, 171.95s/it]
Task 2, Epoch 7/50 => Loss 0.708, Train_accy 81.28, Test_accy 79.50:  14%|█▍        | 7/50 [19:59<2:02:30, 170.94s/it]
Task 3, Epoch 40/50 => Loss 0.640, Train_accy 83.82, Test_accy 83.23:  78%|███████▊  | 39/50 [1:04:09<17:26, 95.18s/it]
Task 3, Epoch 40/50 => Loss 0.640, Train_accy 83.82, Test_accy 83.23:  80%|████████  | 40/50 [1:04:09<15:52, 95.29s/it]
Task 3, Epoch 41/50 => Loss 0.656, Train_accy 83.49, Test_accy 83.57:  80%|████████  | 40/50 [1:05:44<15:52, 95.29s/it]
Task 3, Epoch 41/50 => Loss 0.656, Train_accy 83.49, Test_accy 83.57:  82%|████████▏ | 41/50 [1:05:44<14:18, 95.43s/it]
Task 2, Epoch 8/50 => Loss 0.693, Train_accy 82.19, Test_accy 80.81:  14%|█▍        | 7/50 [22:52<2:02:30, 170.94s/it]
Task 2, Epoch 8/50 => Loss 0.693, Train_accy 82.19, Test_accy 80.81:  16%|█▌        | 8/50 [22:52<2:00:11, 171.71s/it]
Task 3, Epoch 42/50 => Loss 0.638, Train_accy 84.03, Test_accy 83.52:  82%|████████▏ | 41/50 [1:07:19<14:18, 95.43s/it]
Task 3, Epoch 42/50 => Loss 0.638, Train_accy 84.03, Test_accy 83.52:  84%|████████▍ | 42/50 [1:07:19<12:41, 95.25s/it]
Task 3, Epoch 43/50 => Loss 0.632, Train_accy 84.26, Test_accy 83.20:  84%|████████▍ | 42/50 [1:08:56<12:41, 95.25s/it]
Task 3, Epoch 43/50 => Loss 0.632, Train_accy 84.26, Test_accy 83.20:  86%|████████▌ | 43/50 [1:08:56<11:10, 95.78s/it]
Task 2, Epoch 9/50 => Loss 0.689, Train_accy 82.16, Test_accy 79.67:  16%|█▌        | 8/50 [25:40<2:00:11, 171.71s/it]
Task 2, Epoch 9/50 => Loss 0.689, Train_accy 82.16, Test_accy 79.67:  18%|█▊        | 9/50 [25:40<1:56:29, 170.48s/it]
Task 3, Epoch 44/50 => Loss 0.634, Train_accy 83.99, Test_accy 83.47:  86%|████████▌ | 43/50 [1:10:32<11:10, 95.78s/it]
Task 3, Epoch 44/50 => Loss 0.634, Train_accy 83.99, Test_accy 83.47:  88%|████████▊ | 44/50 [1:10:32<09:33, 95.65s/it]
Task 2, Epoch 10/50 => Loss 0.681, Train_accy 82.64, Test_accy 79.98:  18%|█▊        | 9/50 [28:29<1:56:29, 170.48s/it]
Task 2, Epoch 10/50 => Loss 0.681, Train_accy 82.64, Test_accy 79.98:  20%|██        | 10/50 [28:29<1:53:25, 170.13s/it]
Task 3, Epoch 45/50 => Loss 0.626, Train_accy 84.54, Test_accy 83.53:  88%|████████▊ | 44/50 [1:12:06<09:33, 95.65s/it]
Task 3, Epoch 45/50 => Loss 0.626, Train_accy 84.54, Test_accy 83.53:  90%|█████████ | 45/50 [1:12:06<07:56, 95.33s/it]
Task 3, Epoch 46/50 => Loss 0.654, Train_accy 83.56, Test_accy 83.66:  90%|█████████ | 45/50 [1:13:39<07:56, 95.33s/it]
Task 3, Epoch 46/50 => Loss 0.654, Train_accy 83.56, Test_accy 83.66:  92%|█████████▏| 46/50 [1:13:39<06:18, 94.54s/it]
Task 2, Epoch 11/50 => Loss 0.670, Train_accy 82.76, Test_accy 79.76:  20%|██        | 10/50 [31:22<1:53:25, 170.13s/it]
Task 2, Epoch 11/50 => Loss 0.670, Train_accy 82.76, Test_accy 79.76:  22%|██▏       | 11/50 [31:22<1:51:13, 171.11s/it]
Task 3, Epoch 47/50 => Loss 0.641, Train_accy 84.26, Test_accy 83.65:  92%|█████████▏| 46/50 [1:15:13<06:18, 94.54s/it]
Task 3, Epoch 47/50 => Loss 0.641, Train_accy 84.26, Test_accy 83.65:  94%|█████████▍| 47/50 [1:15:13<04:43, 94.43s/it]
Task 3, Epoch 48/50 => Loss 0.626, Train_accy 84.45, Test_accy 83.65:  94%|█████████▍| 47/50 [1:16:48<04:43, 94.43s/it]
Task 3, Epoch 48/50 => Loss 0.626, Train_accy 84.45, Test_accy 83.65:  96%|█████████▌| 48/50 [1:16:48<03:08, 94.44s/it]
Task 2, Epoch 12/50 => Loss 0.650, Train_accy 83.62, Test_accy 79.47:  22%|██▏       | 11/50 [34:12<1:51:13, 171.11s/it]
Task 2, Epoch 12/50 => Loss 0.650, Train_accy 83.62, Test_accy 79.47:  24%|██▍       | 12/50 [34:12<1:48:01, 170.57s/it]
Task 3, Epoch 49/50 => Loss 0.633, Train_accy 84.13, Test_accy 83.73:  96%|█████████▌| 48/50 [1:18:24<03:08, 94.44s/it]
Task 3, Epoch 49/50 => Loss 0.633, Train_accy 84.13, Test_accy 83.73:  98%|█████████▊| 49/50 [1:18:24<01:34, 94.99s/it]
Task 3, Epoch 50/50 => Loss 0.625, Train_accy 84.54, Test_accy 83.68:  98%|█████████▊| 49/50 [1:20:01<01:34, 94.99s/it]
Task 3, Epoch 50/50 => Loss 0.625, Train_accy 84.54, Test_accy 83.68: 100%|██████████| 50/50 [1:20:01<00:00, 95.58s/it]
Task 3, Epoch 50/50 => Loss 0.625, Train_accy 84.54, Test_accy 83.68: 100%|██████████| 50/50 [1:20:01<00:00, 96.03s/it]
2024-06-14 03:58:20,862 [lora_prompt.py] => Task 3, Epoch 50/50 => Loss 0.625, Train_accy 84.54, Test_accy 83.68

Task 2, Epoch 13/50 => Loss 0.630, Train_accy 83.84, Test_accy 80.02:  24%|██▍       | 12/50 [36:55<1:48:01, 170.57s/it]
Task 2, Epoch 13/50 => Loss 0.630, Train_accy 83.84, Test_accy 80.02:  26%|██▌       | 13/50 [36:55<1:43:50, 168.40s/it]
Task 2, Epoch 14/50 => Loss 0.622, Train_accy 83.94, Test_accy 81.09:  26%|██▌       | 13/50 [39:44<1:43:50, 168.40s/it]
Task 2, Epoch 14/50 => Loss 0.622, Train_accy 83.94, Test_accy 81.09:  28%|██▊       | 14/50 [39:44<1:41:12, 168.68s/it]
Task 2, Epoch 15/50 => Loss 0.627, Train_accy 83.93, Test_accy 81.51:  28%|██▊       | 14/50 [42:35<1:41:12, 168.68s/it]
Task 2, Epoch 15/50 => Loss 0.627, Train_accy 83.93, Test_accy 81.51:  30%|███       | 15/50 [42:35<1:38:39, 169.13s/it]/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 04:06:40,274 [lora_prompt.py] => Exemplar size: 0
2024-06-14 04:06:40,275 [trainer.py] => CNN: {'total': 83.93, '00-49': 83.93, 'old': 83.93, 'new': nan}
2024-06-14 04:06:40,275 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76, 83.93]
2024-06-14 04:06:40,281 [trainer.py] => All params: 840861697
2024-06-14 04:06:40,286 [trainer.py] => Trainable params: 204800
2024-06-14 04:06:40,286 [lora_prompt.py] => Learning on 200-250
Parameters to be updated: {'lora_image_model_pool.4.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'classifier_pool.4.ctx', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]
Task 2, Epoch 16/50 => Loss 0.631, Train_accy 83.56, Test_accy 81.10:  30%|███       | 15/50 [45:21<1:38:39, 169.13s/it]
Task 2, Epoch 16/50 => Loss 0.631, Train_accy 83.56, Test_accy 81.10:  32%|███▏      | 16/50 [45:21<1:35:27, 168.46s/it]
Task 4, Epoch 1/50 => Loss 2.045, Train_accy 23.24, Test_accy 28.60:   0%|          | 0/50 [01:32<?, ?it/s]
Task 4, Epoch 1/50 => Loss 2.045, Train_accy 23.24, Test_accy 28.60:   2%|▏         | 1/50 [01:32<1:15:21, 92.29s/it]
Task 4, Epoch 2/50 => Loss 1.710, Train_accy 42.60, Test_accy 53.79:   2%|▏         | 1/50 [03:04<1:15:21, 92.29s/it]
Task 4, Epoch 2/50 => Loss 1.710, Train_accy 42.60, Test_accy 53.79:   4%|▍         | 2/50 [03:04<1:13:58, 92.47s/it]
Task 2, Epoch 17/50 => Loss 0.608, Train_accy 84.15, Test_accy 81.38:  32%|███▏      | 16/50 [48:11<1:35:27, 168.46s/it]
Task 2, Epoch 17/50 => Loss 0.608, Train_accy 84.15, Test_accy 81.38:  34%|███▍      | 17/50 [48:11<1:32:49, 168.78s/it]
Task 4, Epoch 3/50 => Loss 1.150, Train_accy 67.34, Test_accy 69.22:   4%|▍         | 2/50 [04:39<1:13:58, 92.47s/it]
Task 4, Epoch 3/50 => Loss 1.150, Train_accy 67.34, Test_accy 69.22:   6%|▌         | 3/50 [04:39<1:13:22, 93.67s/it]
Task 4, Epoch 4/50 => Loss 0.867, Train_accy 76.79, Test_accy 73.19:   6%|▌         | 3/50 [06:12<1:13:22, 93.67s/it]
Task 4, Epoch 4/50 => Loss 0.867, Train_accy 76.79, Test_accy 73.19:   8%|▊         | 4/50 [06:12<1:11:33, 93.34s/it]
Task 2, Epoch 18/50 => Loss 0.605, Train_accy 84.47, Test_accy 81.49:  34%|███▍      | 17/50 [51:04<1:32:49, 168.78s/it]
Task 2, Epoch 18/50 => Loss 0.605, Train_accy 84.47, Test_accy 81.49:  36%|███▌      | 18/50 [51:04<1:30:36, 169.90s/it]
Task 4, Epoch 5/50 => Loss 0.733, Train_accy 80.22, Test_accy 78.17:   8%|▊         | 4/50 [07:46<1:11:33, 93.34s/it]
Task 4, Epoch 5/50 => Loss 0.733, Train_accy 80.22, Test_accy 78.17:  10%|█         | 5/50 [07:46<1:10:13, 93.64s/it]
Task 2, Epoch 19/50 => Loss 0.601, Train_accy 84.46, Test_accy 82.41:  36%|███▌      | 18/50 [53:51<1:30:36, 169.90s/it]
Task 2, Epoch 19/50 => Loss 0.601, Train_accy 84.46, Test_accy 82.41:  38%|███▊      | 19/50 [53:51<1:27:21, 169.07s/it]
Task 4, Epoch 6/50 => Loss 0.684, Train_accy 81.85, Test_accy 79.82:  10%|█         | 5/50 [09:21<1:10:13, 93.64s/it]
Task 4, Epoch 6/50 => Loss 0.684, Train_accy 81.85, Test_accy 79.82:  12%|█▏        | 6/50 [09:21<1:08:52, 93.91s/it]
Task 4, Epoch 7/50 => Loss 0.631, Train_accy 82.91, Test_accy 79.12:  12%|█▏        | 6/50 [10:58<1:08:52, 93.91s/it]
Task 4, Epoch 7/50 => Loss 0.631, Train_accy 82.91, Test_accy 79.12:  14%|█▍        | 7/50 [10:58<1:08:07, 95.06s/it]
Task 2, Epoch 20/50 => Loss 0.585, Train_accy 84.91, Test_accy 81.26:  38%|███▊      | 19/50 [56:39<1:27:21, 169.07s/it]
Task 2, Epoch 20/50 => Loss 0.585, Train_accy 84.91, Test_accy 81.26:  40%|████      | 20/50 [56:39<1:24:27, 168.91s/it]
Task 4, Epoch 8/50 => Loss 0.624, Train_accy 83.48, Test_accy 83.43:  14%|█▍        | 7/50 [12:32<1:08:07, 95.06s/it]
Task 4, Epoch 8/50 => Loss 0.624, Train_accy 83.48, Test_accy 83.43:  16%|█▌        | 8/50 [12:32<1:06:09, 94.50s/it]
Task 4, Epoch 9/50 => Loss 0.593, Train_accy 84.46, Test_accy 83.68:  16%|█▌        | 8/50 [14:05<1:06:09, 94.50s/it]
Task 4, Epoch 9/50 => Loss 0.593, Train_accy 84.46, Test_accy 83.68:  18%|█▊        | 9/50 [14:05<1:04:17, 94.08s/it]
Task 2, Epoch 21/50 => Loss 0.584, Train_accy 85.14, Test_accy 82.37:  40%|████      | 20/50 [59:31<1:24:27, 168.91s/it]
Task 2, Epoch 21/50 => Loss 0.584, Train_accy 85.14, Test_accy 82.37:  42%|████▏     | 21/50 [59:31<1:22:04, 169.82s/it]
Task 4, Epoch 10/50 => Loss 0.579, Train_accy 84.80, Test_accy 83.39:  18%|█▊        | 9/50 [15:40<1:04:17, 94.08s/it]
Task 4, Epoch 10/50 => Loss 0.579, Train_accy 84.80, Test_accy 83.39:  20%|██        | 10/50 [15:40<1:02:55, 94.39s/it]
Task 4, Epoch 11/50 => Loss 0.564, Train_accy 85.21, Test_accy 83.02:  20%|██        | 10/50 [17:14<1:02:55, 94.39s/it]
Task 4, Epoch 11/50 => Loss 0.564, Train_accy 85.21, Test_accy 83.02:  22%|██▏       | 11/50 [17:14<1:01:14, 94.22s/it]
Task 2, Epoch 22/50 => Loss 0.582, Train_accy 85.21, Test_accy 82.03:  42%|████▏     | 21/50 [1:02:20<1:22:04, 169.82s/it]
Task 2, Epoch 22/50 => Loss 0.582, Train_accy 85.21, Test_accy 82.03:  44%|████▍     | 22/50 [1:02:20<1:19:04, 169.45s/it]
Task 4, Epoch 12/50 => Loss 0.544, Train_accy 85.78, Test_accy 82.98:  22%|██▏       | 11/50 [18:48<1:01:14, 94.22s/it]
Task 4, Epoch 12/50 => Loss 0.544, Train_accy 85.78, Test_accy 82.98:  24%|██▍       | 12/50 [18:48<59:45, 94.35s/it]  
Task 2, Epoch 23/50 => Loss 0.585, Train_accy 85.09, Test_accy 81.70:  44%|████▍     | 22/50 [1:05:06<1:19:04, 169.45s/it]
Task 2, Epoch 23/50 => Loss 0.585, Train_accy 85.09, Test_accy 81.70:  46%|████▌     | 23/50 [1:05:06<1:15:49, 168.51s/it]
Task 4, Epoch 13/50 => Loss 0.525, Train_accy 86.06, Test_accy 83.75:  24%|██▍       | 12/50 [20:22<59:45, 94.35s/it]
Task 4, Epoch 13/50 => Loss 0.525, Train_accy 86.06, Test_accy 83.75:  26%|██▌       | 13/50 [20:22<58:06, 94.24s/it]
Task 4, Epoch 14/50 => Loss 0.534, Train_accy 85.49, Test_accy 83.55:  26%|██▌       | 13/50 [21:57<58:06, 94.24s/it]
Task 4, Epoch 14/50 => Loss 0.534, Train_accy 85.49, Test_accy 83.55:  28%|██▊       | 14/50 [21:57<56:40, 94.45s/it]
Task 2, Epoch 24/50 => Loss 0.564, Train_accy 85.44, Test_accy 82.12:  46%|████▌     | 23/50 [1:07:57<1:15:49, 168.51s/it]
Task 2, Epoch 24/50 => Loss 0.564, Train_accy 85.44, Test_accy 82.12:  48%|████▊     | 24/50 [1:07:57<1:13:20, 169.24s/it]
Task 4, Epoch 15/50 => Loss 0.519, Train_accy 86.49, Test_accy 84.76:  28%|██▊       | 14/50 [23:34<56:40, 94.45s/it]
Task 4, Epoch 15/50 => Loss 0.519, Train_accy 86.49, Test_accy 84.76:  30%|███       | 15/50 [23:34<55:34, 95.26s/it]
Task 4, Epoch 16/50 => Loss 0.521, Train_accy 86.18, Test_accy 83.36:  30%|███       | 15/50 [25:08<55:34, 95.26s/it]
Task 4, Epoch 16/50 => Loss 0.521, Train_accy 86.18, Test_accy 83.36:  32%|███▏      | 16/50 [25:08<53:46, 94.89s/it]
Task 2, Epoch 25/50 => Loss 0.570, Train_accy 85.34, Test_accy 82.51:  48%|████▊     | 24/50 [1:10:50<1:13:20, 169.24s/it]
Task 2, Epoch 25/50 => Loss 0.570, Train_accy 85.34, Test_accy 82.51:  50%|█████     | 25/50 [1:10:50<1:10:56, 170.26s/it]
Task 4, Epoch 17/50 => Loss 0.515, Train_accy 86.52, Test_accy 84.20:  32%|███▏      | 16/50 [26:42<53:46, 94.89s/it]
Task 4, Epoch 17/50 => Loss 0.515, Train_accy 86.52, Test_accy 84.20:  34%|███▍      | 17/50 [26:42<52:00, 94.57s/it]
Task 4, Epoch 18/50 => Loss 0.503, Train_accy 86.91, Test_accy 83.77:  34%|███▍      | 17/50 [28:19<52:00, 94.57s/it]
Task 4, Epoch 18/50 => Loss 0.503, Train_accy 86.91, Test_accy 83.77:  36%|███▌      | 18/50 [28:19<50:44, 95.14s/it]
Task 2, Epoch 26/50 => Loss 0.547, Train_accy 85.97, Test_accy 81.96:  50%|█████     | 25/50 [1:13:37<1:10:56, 170.26s/it]
Task 2, Epoch 26/50 => Loss 0.547, Train_accy 85.97, Test_accy 81.96:  52%|█████▏    | 26/50 [1:13:37<1:07:46, 169.43s/it]
Task 4, Epoch 19/50 => Loss 0.481, Train_accy 87.57, Test_accy 84.83:  36%|███▌      | 18/50 [29:54<50:44, 95.14s/it]
Task 4, Epoch 19/50 => Loss 0.481, Train_accy 87.57, Test_accy 84.83:  38%|███▊      | 19/50 [29:54<49:06, 95.04s/it]
Task 4, Epoch 20/50 => Loss 0.476, Train_accy 87.68, Test_accy 84.67:  38%|███▊      | 19/50 [31:28<49:06, 95.04s/it]
Task 4, Epoch 20/50 => Loss 0.476, Train_accy 87.68, Test_accy 84.67:  40%|████      | 20/50 [31:28<47:22, 94.75s/it]
Task 2, Epoch 27/50 => Loss 0.549, Train_accy 86.09, Test_accy 82.56:  52%|█████▏    | 26/50 [1:16:25<1:07:46, 169.43s/it]
Task 2, Epoch 27/50 => Loss 0.549, Train_accy 86.09, Test_accy 82.56:  54%|█████▍    | 27/50 [1:16:25<1:04:48, 169.07s/it]
Task 4, Epoch 21/50 => Loss 0.503, Train_accy 86.94, Test_accy 84.85:  40%|████      | 20/50 [33:02<47:22, 94.75s/it]
Task 4, Epoch 21/50 => Loss 0.503, Train_accy 86.94, Test_accy 84.85:  42%|████▏     | 21/50 [33:02<45:43, 94.59s/it]
Task 2, Epoch 28/50 => Loss 0.551, Train_accy 85.81, Test_accy 81.89:  54%|█████▍    | 27/50 [1:19:17<1:04:48, 169.07s/it]
Task 2, Epoch 28/50 => Loss 0.551, Train_accy 85.81, Test_accy 81.89:  56%|█████▌    | 28/50 [1:19:17<1:02:18, 169.92s/it]
Task 4, Epoch 22/50 => Loss 0.483, Train_accy 87.26, Test_accy 84.69:  42%|████▏     | 21/50 [34:35<45:43, 94.59s/it]
Task 4, Epoch 22/50 => Loss 0.483, Train_accy 87.26, Test_accy 84.69:  44%|████▍     | 22/50 [34:35<44:00, 94.29s/it]
Task 4, Epoch 23/50 => Loss 0.460, Train_accy 87.60, Test_accy 84.88:  44%|████▍     | 22/50 [36:09<44:00, 94.29s/it]
Task 4, Epoch 23/50 => Loss 0.460, Train_accy 87.60, Test_accy 84.88:  46%|████▌     | 23/50 [36:09<42:18, 94.02s/it]
Task 2, Epoch 29/50 => Loss 0.546, Train_accy 86.09, Test_accy 82.24:  56%|█████▌    | 28/50 [1:22:03<1:02:18, 169.92s/it]
Task 2, Epoch 29/50 => Loss 0.546, Train_accy 86.09, Test_accy 82.24:  58%|█████▊    | 29/50 [1:22:03<59:03, 168.74s/it]  
Task 4, Epoch 24/50 => Loss 0.468, Train_accy 87.50, Test_accy 85.09:  46%|████▌     | 23/50 [37:46<42:18, 94.02s/it]
Task 4, Epoch 24/50 => Loss 0.468, Train_accy 87.50, Test_accy 85.09:  48%|████▊     | 24/50 [37:46<41:12, 95.11s/it]
Task 4, Epoch 25/50 => Loss 0.464, Train_accy 87.71, Test_accy 84.29:  48%|████▊     | 24/50 [39:25<41:12, 95.11s/it]
Task 4, Epoch 25/50 => Loss 0.464, Train_accy 87.71, Test_accy 84.29:  50%|█████     | 25/50 [39:25<40:05, 96.20s/it]
Task 2, Epoch 30/50 => Loss 0.548, Train_accy 85.90, Test_accy 82.68:  58%|█████▊    | 29/50 [1:24:48<59:03, 168.74s/it]
Task 2, Epoch 30/50 => Loss 0.548, Train_accy 85.90, Test_accy 82.68:  60%|██████    | 30/50 [1:24:48<55:48, 167.45s/it]
Task 4, Epoch 26/50 => Loss 0.470, Train_accy 87.53, Test_accy 85.13:  50%|█████     | 25/50 [41:00<40:05, 96.20s/it]
Task 4, Epoch 26/50 => Loss 0.470, Train_accy 87.53, Test_accy 85.13:  52%|█████▏    | 26/50 [41:00<38:16, 95.68s/it]
Task 4, Epoch 27/50 => Loss 0.475, Train_accy 87.84, Test_accy 86.08:  52%|█████▏    | 26/50 [42:33<38:16, 95.68s/it]
Task 4, Epoch 27/50 => Loss 0.475, Train_accy 87.84, Test_accy 86.08:  54%|█████▍    | 27/50 [42:33<36:21, 94.87s/it]
Task 2, Epoch 31/50 => Loss 0.554, Train_accy 86.00, Test_accy 82.21:  60%|██████    | 30/50 [1:27:41<55:48, 167.45s/it]
Task 2, Epoch 31/50 => Loss 0.554, Train_accy 86.00, Test_accy 82.21:  62%|██████▏   | 31/50 [1:27:41<53:32, 169.09s/it]
Task 4, Epoch 28/50 => Loss 0.440, Train_accy 88.91, Test_accy 85.34:  54%|█████▍    | 27/50 [44:06<36:21, 94.87s/it]
Task 4, Epoch 28/50 => Loss 0.440, Train_accy 88.91, Test_accy 85.34:  56%|█████▌    | 28/50 [44:06<34:39, 94.50s/it]
Task 4, Epoch 29/50 => Loss 0.444, Train_accy 88.43, Test_accy 86.03:  56%|█████▌    | 28/50 [45:42<34:39, 94.50s/it]
Task 4, Epoch 29/50 => Loss 0.444, Train_accy 88.43, Test_accy 86.03:  58%|█████▊    | 29/50 [45:42<33:09, 94.75s/it]
Task 2, Epoch 32/50 => Loss 0.554, Train_accy 85.96, Test_accy 82.97:  62%|██████▏   | 31/50 [1:30:34<53:32, 169.09s/it]
Task 2, Epoch 32/50 => Loss 0.554, Train_accy 85.96, Test_accy 82.97:  64%|██████▍   | 32/50 [1:30:34<51:04, 170.25s/it]
Task 4, Epoch 30/50 => Loss 0.462, Train_accy 88.06, Test_accy 84.44:  58%|█████▊    | 29/50 [47:18<33:09, 94.75s/it]
Task 4, Epoch 30/50 => Loss 0.462, Train_accy 88.06, Test_accy 84.44:  60%|██████    | 30/50 [47:18<31:43, 95.17s/it]
Task 2, Epoch 33/50 => Loss 0.533, Train_accy 86.31, Test_accy 82.20:  64%|██████▍   | 32/50 [1:33:20<51:04, 170.25s/it]
Task 2, Epoch 33/50 => Loss 0.533, Train_accy 86.31, Test_accy 82.20:  66%|██████▌   | 33/50 [1:33:20<47:54, 169.06s/it]
Task 4, Epoch 31/50 => Loss 0.446, Train_accy 88.31, Test_accy 85.07:  60%|██████    | 30/50 [48:53<31:43, 95.17s/it]
Task 4, Epoch 31/50 => Loss 0.446, Train_accy 88.31, Test_accy 85.07:  62%|██████▏   | 31/50 [48:53<30:09, 95.26s/it]
Task 4, Epoch 32/50 => Loss 0.428, Train_accy 88.74, Test_accy 86.10:  62%|██████▏   | 31/50 [50:27<30:09, 95.26s/it]
Task 4, Epoch 32/50 => Loss 0.428, Train_accy 88.74, Test_accy 86.10:  64%|██████▍   | 32/50 [50:27<28:24, 94.69s/it]
Task 2, Epoch 34/50 => Loss 0.521, Train_accy 86.51, Test_accy 81.72:  66%|██████▌   | 33/50 [1:36:08<47:54, 169.06s/it]
Task 2, Epoch 34/50 => Loss 0.521, Train_accy 86.51, Test_accy 81.72:  68%|██████▊   | 34/50 [1:36:08<45:01, 168.82s/it]
Task 4, Epoch 33/50 => Loss 0.428, Train_accy 88.86, Test_accy 84.77:  64%|██████▍   | 32/50 [51:59<28:24, 94.69s/it]
Task 4, Epoch 33/50 => Loss 0.428, Train_accy 88.86, Test_accy 84.77:  66%|██████▌   | 33/50 [51:59<26:39, 94.10s/it]
Task 4, Epoch 34/50 => Loss 0.441, Train_accy 88.84, Test_accy 84.87:  66%|██████▌   | 33/50 [53:33<26:39, 94.10s/it]
Task 4, Epoch 34/50 => Loss 0.441, Train_accy 88.84, Test_accy 84.87:  68%|██████▊   | 34/50 [53:33<25:04, 94.03s/it]
Task 2, Epoch 35/50 => Loss 0.526, Train_accy 86.41, Test_accy 82.84:  68%|██████▊   | 34/50 [1:39:00<45:01, 168.82s/it]
Task 2, Epoch 35/50 => Loss 0.526, Train_accy 86.41, Test_accy 82.84:  70%|███████   | 35/50 [1:39:00<42:25, 169.72s/it]
Task 4, Epoch 35/50 => Loss 0.444, Train_accy 88.61, Test_accy 85.71:  68%|██████▊   | 34/50 [55:07<25:04, 94.03s/it]
Task 4, Epoch 35/50 => Loss 0.444, Train_accy 88.61, Test_accy 85.71:  70%|███████   | 35/50 [55:07<23:29, 93.99s/it]
Task 4, Epoch 36/50 => Loss 0.436, Train_accy 88.63, Test_accy 85.90:  70%|███████   | 35/50 [56:40<23:29, 93.99s/it]
Task 4, Epoch 36/50 => Loss 0.436, Train_accy 88.63, Test_accy 85.90:  72%|███████▏  | 36/50 [56:40<21:53, 93.80s/it]
Task 2, Epoch 36/50 => Loss 0.524, Train_accy 86.74, Test_accy 82.22:  70%|███████   | 35/50 [1:41:45<42:25, 169.72s/it]
Task 2, Epoch 36/50 => Loss 0.524, Train_accy 86.74, Test_accy 82.22:  72%|███████▏  | 36/50 [1:41:45<39:16, 168.34s/it]
Task 4, Epoch 37/50 => Loss 0.428, Train_accy 89.07, Test_accy 86.71:  72%|███████▏  | 36/50 [58:17<21:53, 93.80s/it]
Task 4, Epoch 37/50 => Loss 0.428, Train_accy 89.07, Test_accy 86.71:  74%|███████▍  | 37/50 [58:17<20:29, 94.55s/it]
Task 2, Epoch 37/50 => Loss 0.519, Train_accy 86.88, Test_accy 82.20:  72%|███████▏  | 36/50 [1:44:33<39:16, 168.34s/it]
Task 2, Epoch 37/50 => Loss 0.519, Train_accy 86.88, Test_accy 82.20:  74%|███████▍  | 37/50 [1:44:33<36:28, 168.37s/it]
Task 4, Epoch 38/50 => Loss 0.435, Train_accy 88.90, Test_accy 86.61:  74%|███████▍  | 37/50 [59:51<20:29, 94.55s/it]
Task 4, Epoch 38/50 => Loss 0.435, Train_accy 88.90, Test_accy 86.61:  76%|███████▌  | 38/50 [59:51<18:54, 94.56s/it]
Task 4, Epoch 39/50 => Loss 0.412, Train_accy 89.56, Test_accy 86.03:  76%|███████▌  | 38/50 [1:01:24<18:54, 94.56s/it]
Task 4, Epoch 39/50 => Loss 0.412, Train_accy 89.56, Test_accy 86.03:  78%|███████▊  | 39/50 [1:01:24<17:14, 94.06s/it]
Task 2, Epoch 38/50 => Loss 0.522, Train_accy 86.89, Test_accy 82.88:  74%|███████▍  | 37/50 [1:47:24<36:28, 168.37s/it]
Task 2, Epoch 38/50 => Loss 0.522, Train_accy 86.89, Test_accy 82.88:  76%|███████▌  | 38/50 [1:47:24<33:47, 168.98s/it]
Task 4, Epoch 40/50 => Loss 0.422, Train_accy 89.23, Test_accy 86.21:  78%|███████▊  | 39/50 [1:02:59<17:14, 94.06s/it]
Task 4, Epoch 40/50 => Loss 0.422, Train_accy 89.23, Test_accy 86.21:  80%|████████  | 40/50 [1:02:59<15:41, 94.12s/it]
Task 4, Epoch 41/50 => Loss 0.412, Train_accy 89.48, Test_accy 85.89:  80%|████████  | 40/50 [1:04:33<15:41, 94.12s/it]
Task 4, Epoch 41/50 => Loss 0.412, Train_accy 89.48, Test_accy 85.89:  82%|████████▏ | 41/50 [1:04:33<14:07, 94.22s/it]
Task 2, Epoch 39/50 => Loss 0.531, Train_accy 86.77, Test_accy 83.15:  76%|███████▌  | 38/50 [1:50:14<33:47, 168.98s/it]
Task 2, Epoch 39/50 => Loss 0.531, Train_accy 86.77, Test_accy 83.15:  78%|███████▊  | 39/50 [1:50:14<31:03, 169.42s/it]
Task 4, Epoch 42/50 => Loss 0.400, Train_accy 89.93, Test_accy 85.88:  82%|████████▏ | 41/50 [1:06:07<14:07, 94.22s/it]
Task 4, Epoch 42/50 => Loss 0.400, Train_accy 89.93, Test_accy 85.88:  84%|████████▍ | 42/50 [1:06:07<12:33, 94.16s/it]
Task 4, Epoch 43/50 => Loss 0.414, Train_accy 89.59, Test_accy 86.17:  84%|████████▍ | 42/50 [1:07:45<12:33, 94.16s/it]
Task 4, Epoch 43/50 => Loss 0.414, Train_accy 89.59, Test_accy 86.17:  86%|████████▌ | 43/50 [1:07:45<11:06, 95.28s/it]
Task 2, Epoch 40/50 => Loss 0.522, Train_accy 86.84, Test_accy 82.86:  78%|███████▊  | 39/50 [1:53:01<31:03, 169.42s/it]
Task 2, Epoch 40/50 => Loss 0.522, Train_accy 86.84, Test_accy 82.86:  80%|████████  | 40/50 [1:53:01<28:05, 168.59s/it]
Task 4, Epoch 44/50 => Loss 0.402, Train_accy 89.71, Test_accy 86.49:  86%|████████▌ | 43/50 [1:09:17<11:06, 95.28s/it]
Task 4, Epoch 44/50 => Loss 0.402, Train_accy 89.71, Test_accy 86.49:  88%|████████▊ | 44/50 [1:09:17<09:26, 94.45s/it]
Task 4, Epoch 45/50 => Loss 0.418, Train_accy 89.55, Test_accy 86.53:  88%|████████▊ | 44/50 [1:10:50<09:26, 94.45s/it]
Task 4, Epoch 45/50 => Loss 0.418, Train_accy 89.55, Test_accy 86.53:  90%|█████████ | 45/50 [1:10:50<07:50, 94.01s/it]
Task 2, Epoch 41/50 => Loss 0.520, Train_accy 86.75, Test_accy 83.10:  80%|████████  | 40/50 [1:55:54<28:05, 168.59s/it]
Task 2, Epoch 41/50 => Loss 0.520, Train_accy 86.75, Test_accy 83.10:  82%|████████▏ | 41/50 [1:55:54<25:29, 169.91s/it]
Task 4, Epoch 46/50 => Loss 0.403, Train_accy 89.68, Test_accy 86.34:  90%|█████████ | 45/50 [1:12:24<07:50, 94.01s/it]
Task 4, Epoch 46/50 => Loss 0.403, Train_accy 89.68, Test_accy 86.34:  92%|█████████▏| 46/50 [1:12:24<06:15, 93.83s/it]
Task 2, Epoch 42/50 => Loss 0.491, Train_accy 87.35, Test_accy 83.31:  82%|████████▏ | 41/50 [1:58:45<25:29, 169.91s/it]
Task 2, Epoch 42/50 => Loss 0.491, Train_accy 87.35, Test_accy 83.31:  84%|████████▍ | 42/50 [1:58:45<22:41, 170.22s/it]
Task 4, Epoch 47/50 => Loss 0.409, Train_accy 89.57, Test_accy 86.34:  92%|█████████▏| 46/50 [1:13:57<06:15, 93.83s/it]
Task 4, Epoch 47/50 => Loss 0.409, Train_accy 89.57, Test_accy 86.34:  94%|█████████▍| 47/50 [1:13:57<04:41, 93.71s/it]
Task 4, Epoch 48/50 => Loss 0.421, Train_accy 89.19, Test_accy 86.31:  94%|█████████▍| 47/50 [1:15:30<04:41, 93.71s/it]
Task 4, Epoch 48/50 => Loss 0.421, Train_accy 89.19, Test_accy 86.31:  96%|█████████▌| 48/50 [1:15:30<03:07, 93.55s/it]
Task 2, Epoch 43/50 => Loss 0.510, Train_accy 87.18, Test_accy 83.02:  84%|████████▍ | 42/50 [2:01:32<22:41, 170.22s/it]
Task 2, Epoch 43/50 => Loss 0.510, Train_accy 87.18, Test_accy 83.02:  86%|████████▌ | 43/50 [2:01:32<19:45, 169.35s/it]
Task 4, Epoch 49/50 => Loss 0.403, Train_accy 90.04, Test_accy 86.29:  96%|█████████▌| 48/50 [1:17:08<03:07, 93.55s/it]
Task 4, Epoch 49/50 => Loss 0.403, Train_accy 90.04, Test_accy 86.29:  98%|█████████▊| 49/50 [1:17:08<01:34, 94.80s/it]
Task 4, Epoch 50/50 => Loss 0.418, Train_accy 89.56, Test_accy 86.30:  98%|█████████▊| 49/50 [1:18:42<01:34, 94.80s/it]
Task 4, Epoch 50/50 => Loss 0.418, Train_accy 89.56, Test_accy 86.30: 100%|██████████| 50/50 [1:18:42<00:00, 94.62s/it]
Task 4, Epoch 50/50 => Loss 0.418, Train_accy 89.56, Test_accy 86.30: 100%|██████████| 50/50 [1:18:42<00:00, 94.46s/it]
2024-06-14 05:25:25,644 [lora_prompt.py] => Task 4, Epoch 50/50 => Loss 0.418, Train_accy 89.56, Test_accy 86.30

Task 2, Epoch 44/50 => Loss 0.508, Train_accy 87.01, Test_accy 83.04:  86%|████████▌ | 43/50 [2:04:21<19:45, 169.35s/it]
Task 2, Epoch 44/50 => Loss 0.508, Train_accy 87.01, Test_accy 83.04:  88%|████████▊ | 44/50 [2:04:21<16:55, 169.21s/it]
Task 2, Epoch 45/50 => Loss 0.514, Train_accy 87.32, Test_accy 83.21:  88%|████████▊ | 44/50 [2:07:10<16:55, 169.21s/it]
Task 2, Epoch 45/50 => Loss 0.514, Train_accy 87.32, Test_accy 83.21:  90%|█████████ | 45/50 [2:07:10<14:05, 169.02s/it]
Task 2, Epoch 46/50 => Loss 0.500, Train_accy 87.74, Test_accy 83.18:  90%|█████████ | 45/50 [2:09:57<14:05, 169.02s/it]
Task 2, Epoch 46/50 => Loss 0.500, Train_accy 87.74, Test_accy 83.18:  92%|█████████▏| 46/50 [2:09:57<11:13, 168.41s/it]/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 05:33:30,291 [lora_prompt.py] => Exemplar size: 0
2024-06-14 05:33:30,291 [trainer.py] => CNN: {'total': 85.74, '00-49': 85.74, 'old': 85.74, 'new': nan}
2024-06-14 05:33:30,291 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76, 83.93, 85.74]
2024-06-14 05:33:30,297 [trainer.py] => All params: 840861697
2024-06-14 05:33:30,302 [trainer.py] => Trainable params: 204800
2024-06-14 05:33:30,302 [lora_prompt.py] => Learning on 250-300
Parameters to be updated: {'lora_image_model_pool.5.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'classifier_pool.5.ctx', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]
Task 2, Epoch 47/50 => Loss 0.499, Train_accy 87.52, Test_accy 83.17:  92%|█████████▏| 46/50 [2:12:44<11:13, 168.41s/it]
Task 2, Epoch 47/50 => Loss 0.499, Train_accy 87.52, Test_accy 83.17:  94%|█████████▍| 47/50 [2:12:44<08:24, 168.15s/it]
Task 5, Epoch 1/50 => Loss 2.128, Train_accy 29.13, Test_accy 47.36:   0%|          | 0/50 [01:31<?, ?it/s]
Task 5, Epoch 1/50 => Loss 2.128, Train_accy 29.13, Test_accy 47.36:   2%|▏         | 1/50 [01:31<1:14:44, 91.53s/it]
Task 5, Epoch 2/50 => Loss 1.465, Train_accy 57.62, Test_accy 62.93:   2%|▏         | 1/50 [03:03<1:14:44, 91.53s/it]
Task 5, Epoch 2/50 => Loss 1.465, Train_accy 57.62, Test_accy 62.93:   4%|▍         | 2/50 [03:03<1:13:25, 91.79s/it]
Task 2, Epoch 48/50 => Loss 0.503, Train_accy 87.44, Test_accy 83.11:  94%|█████████▍| 47/50 [2:15:36<08:24, 168.15s/it]
Task 2, Epoch 48/50 => Loss 0.503, Train_accy 87.44, Test_accy 83.11:  96%|█████████▌| 48/50 [2:15:36<05:38, 169.17s/it]
Task 5, Epoch 3/50 => Loss 1.149, Train_accy 68.64, Test_accy 70.74:   4%|▍         | 2/50 [04:36<1:13:25, 91.79s/it]
Task 5, Epoch 3/50 => Loss 1.149, Train_accy 68.64, Test_accy 70.74:   6%|▌         | 3/50 [04:36<1:12:09, 92.12s/it]
Task 5, Epoch 4/50 => Loss 1.040, Train_accy 72.37, Test_accy 75.53:   6%|▌         | 3/50 [06:08<1:12:09, 92.12s/it]
Task 5, Epoch 4/50 => Loss 1.040, Train_accy 72.37, Test_accy 75.53:   8%|▊         | 4/50 [06:08<1:10:48, 92.37s/it]
Task 2, Epoch 49/50 => Loss 0.502, Train_accy 87.36, Test_accy 83.14:  96%|█████████▌| 48/50 [2:18:25<05:38, 169.17s/it]
Task 2, Epoch 49/50 => Loss 0.502, Train_accy 87.36, Test_accy 83.14:  98%|█████████▊| 49/50 [2:18:25<02:49, 169.25s/it]
Task 5, Epoch 5/50 => Loss 0.980, Train_accy 74.00, Test_accy 76.10:   8%|▊         | 4/50 [07:43<1:10:48, 92.37s/it]
Task 5, Epoch 5/50 => Loss 0.980, Train_accy 74.00, Test_accy 76.10:  10%|█         | 5/50 [07:43<1:09:47, 93.05s/it]
Task 5, Epoch 6/50 => Loss 0.913, Train_accy 75.44, Test_accy 76.19:  10%|█         | 5/50 [09:17<1:09:47, 93.05s/it]
Task 5, Epoch 6/50 => Loss 0.913, Train_accy 75.44, Test_accy 76.19:  12%|█▏        | 6/50 [09:17<1:08:41, 93.68s/it]
Task 2, Epoch 50/50 => Loss 0.510, Train_accy 87.42, Test_accy 83.15:  98%|█████████▊| 49/50 [2:21:12<02:49, 169.25s/it]
Task 2, Epoch 50/50 => Loss 0.510, Train_accy 87.42, Test_accy 83.15: 100%|██████████| 50/50 [2:21:12<00:00, 168.38s/it]
Task 2, Epoch 50/50 => Loss 0.510, Train_accy 87.42, Test_accy 83.15: 100%|██████████| 50/50 [2:21:12<00:00, 169.44s/it]
2024-06-14 05:43:06,076 [lora_prompt.py] => Task 2, Epoch 50/50 => Loss 0.510, Train_accy 87.42, Test_accy 83.15

Task 5, Epoch 7/50 => Loss 0.878, Train_accy 76.73, Test_accy 74.36:  12%|█▏        | 6/50 [10:52<1:08:41, 93.68s/it]
Task 5, Epoch 7/50 => Loss 0.878, Train_accy 76.73, Test_accy 74.36:  14%|█▍        | 7/50 [10:52<1:07:19, 93.93s/it]
Task 5, Epoch 8/50 => Loss 0.856, Train_accy 77.75, Test_accy 75.60:  14%|█▍        | 7/50 [12:26<1:07:19, 93.93s/it]
Task 5, Epoch 8/50 => Loss 0.856, Train_accy 77.75, Test_accy 75.60:  16%|█▌        | 8/50 [12:26<1:05:42, 93.86s/it]
Task 5, Epoch 9/50 => Loss 0.838, Train_accy 77.98, Test_accy 75.62:  16%|█▌        | 8/50 [13:58<1:05:42, 93.86s/it]
Task 5, Epoch 9/50 => Loss 0.838, Train_accy 77.98, Test_accy 75.62:  18%|█▊        | 9/50 [13:58<1:03:49, 93.39s/it]
Task 5, Epoch 10/50 => Loss 0.801, Train_accy 78.57, Test_accy 74.71:  18%|█▊        | 9/50 [15:30<1:03:49, 93.39s/it]
Task 5, Epoch 10/50 => Loss 0.801, Train_accy 78.57, Test_accy 74.71:  20%|██        | 10/50 [15:30<1:01:54, 92.87s/it]
Task 5, Epoch 11/50 => Loss 0.798, Train_accy 79.10, Test_accy 76.93:  20%|██        | 10/50 [17:04<1:01:54, 92.87s/it]
Task 5, Epoch 11/50 => Loss 0.798, Train_accy 79.10, Test_accy 76.93:  22%|██▏       | 11/50 [17:04<1:00:35, 93.21s/it]
Task 5, Epoch 12/50 => Loss 0.765, Train_accy 79.85, Test_accy 78.74:  22%|██▏       | 11/50 [18:37<1:00:35, 93.21s/it]
Task 5, Epoch 12/50 => Loss 0.765, Train_accy 79.85, Test_accy 78.74:  24%|██▍       | 12/50 [18:37<59:09, 93.41s/it]  
Task 5, Epoch 13/50 => Loss 0.773, Train_accy 79.44, Test_accy 75.03:  24%|██▍       | 12/50 [20:10<59:09, 93.41s/it]
Task 5, Epoch 13/50 => Loss 0.773, Train_accy 79.44, Test_accy 75.03:  26%|██▌       | 13/50 [20:10<57:26, 93.16s/it]/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 05:54:59,937 [lora_prompt.py] => Exemplar size: 0
2024-06-14 05:54:59,938 [trainer.py] => CNN: {'total': 83.76, '00-49': 83.76, 'old': 83.76, 'new': nan}
2024-06-14 05:54:59,938 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76]
2024-06-14 05:54:59,944 [trainer.py] => All params: 840861697
2024-06-14 05:54:59,949 [trainer.py] => Trainable params: 204800
2024-06-14 05:54:59,950 [lora_prompt.py] => Learning on 150-200
Parameters to be updated: {'lora_image_model_pool.3.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'classifier_pool.3.ctx', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.3.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]
Task 5, Epoch 14/50 => Loss 0.760, Train_accy 80.06, Test_accy 76.88:  26%|██▌       | 13/50 [21:44<57:26, 93.16s/it]
Task 5, Epoch 14/50 => Loss 0.760, Train_accy 80.06, Test_accy 76.88:  28%|██▊       | 14/50 [21:44<56:01, 93.37s/it]
Task 5, Epoch 15/50 => Loss 0.739, Train_accy 80.67, Test_accy 77.60:  28%|██▊       | 14/50 [23:17<56:01, 93.37s/it]
Task 5, Epoch 15/50 => Loss 0.739, Train_accy 80.67, Test_accy 77.60:  30%|███       | 15/50 [23:17<54:28, 93.38s/it]
Task 3, Epoch 1/50 => Loss 2.020, Train_accy 31.71, Test_accy 56.30:   0%|          | 0/50 [02:46<?, ?it/s]
Task 3, Epoch 1/50 => Loss 2.020, Train_accy 31.71, Test_accy 56.30:   2%|▏         | 1/50 [02:46<2:15:51, 166.37s/it]
Task 5, Epoch 16/50 => Loss 0.738, Train_accy 80.55, Test_accy 79.54:  30%|███       | 15/50 [24:52<54:28, 93.38s/it]
Task 5, Epoch 16/50 => Loss 0.738, Train_accy 80.55, Test_accy 79.54:  32%|███▏      | 16/50 [24:52<53:07, 93.75s/it]
Task 5, Epoch 17/50 => Loss 0.743, Train_accy 80.29, Test_accy 78.63:  32%|███▏      | 16/50 [26:28<53:07, 93.75s/it]
Task 5, Epoch 17/50 => Loss 0.743, Train_accy 80.29, Test_accy 78.63:  34%|███▍      | 17/50 [26:28<52:01, 94.59s/it]
Task 3, Epoch 2/50 => Loss 1.372, Train_accy 61.28, Test_accy 69.09:   2%|▏         | 1/50 [05:30<2:15:51, 166.37s/it]
Task 3, Epoch 2/50 => Loss 1.372, Train_accy 61.28, Test_accy 69.09:   4%|▍         | 2/50 [05:30<2:11:53, 164.87s/it]
Task 5, Epoch 18/50 => Loss 0.713, Train_accy 81.51, Test_accy 79.61:  34%|███▍      | 17/50 [28:02<52:01, 94.59s/it]
Task 5, Epoch 18/50 => Loss 0.713, Train_accy 81.51, Test_accy 79.61:  36%|███▌      | 18/50 [28:02<50:19, 94.35s/it]
Task 5, Epoch 19/50 => Loss 0.701, Train_accy 81.73, Test_accy 79.32:  36%|███▌      | 18/50 [29:37<50:19, 94.35s/it]
Task 5, Epoch 19/50 => Loss 0.701, Train_accy 81.73, Test_accy 79.32:  38%|███▊      | 19/50 [29:37<48:44, 94.33s/it]
Task 3, Epoch 3/50 => Loss 1.113, Train_accy 69.80, Test_accy 76.16:   4%|▍         | 2/50 [08:18<2:11:53, 164.87s/it]
Task 3, Epoch 3/50 => Loss 1.113, Train_accy 69.80, Test_accy 76.16:   6%|▌         | 3/50 [08:18<2:10:24, 166.47s/it]
Task 5, Epoch 20/50 => Loss 0.705, Train_accy 81.57, Test_accy 77.58:  38%|███▊      | 19/50 [31:11<48:44, 94.33s/it]
Task 5, Epoch 20/50 => Loss 0.705, Train_accy 81.57, Test_accy 77.58:  40%|████      | 20/50 [31:11<47:06, 94.23s/it]
Task 3, Epoch 4/50 => Loss 0.975, Train_accy 74.48, Test_accy 75.30:   6%|▌         | 3/50 [11:05<2:10:24, 166.47s/it]
Task 3, Epoch 4/50 => Loss 0.975, Train_accy 74.48, Test_accy 75.30:   8%|▊         | 4/50 [11:05<2:07:47, 166.70s/it]
Task 5, Epoch 21/50 => Loss 0.705, Train_accy 81.40, Test_accy 80.14:  40%|████      | 20/50 [32:45<47:06, 94.23s/it]
Task 5, Epoch 21/50 => Loss 0.705, Train_accy 81.40, Test_accy 80.14:  42%|████▏     | 21/50 [32:45<45:33, 94.25s/it]
Task 5, Epoch 22/50 => Loss 0.705, Train_accy 82.03, Test_accy 79.53:  42%|████▏     | 21/50 [34:19<45:33, 94.25s/it]
Task 5, Epoch 22/50 => Loss 0.705, Train_accy 82.03, Test_accy 79.53:  44%|████▍     | 22/50 [34:19<44:00, 94.32s/it]
Task 3, Epoch 5/50 => Loss 0.930, Train_accy 75.78, Test_accy 77.35:   8%|▊         | 4/50 [13:51<2:07:47, 166.70s/it]
Task 3, Epoch 5/50 => Loss 0.930, Train_accy 75.78, Test_accy 77.35:  10%|█         | 5/50 [13:51<2:04:51, 166.47s/it]
Task 5, Epoch 23/50 => Loss 0.689, Train_accy 81.89, Test_accy 79.34:  44%|████▍     | 22/50 [35:56<44:00, 94.32s/it]
Task 5, Epoch 23/50 => Loss 0.689, Train_accy 81.89, Test_accy 79.34:  46%|████▌     | 23/50 [35:56<42:49, 95.17s/it]
Task 5, Epoch 24/50 => Loss 0.674, Train_accy 82.10, Test_accy 79.75:  46%|████▌     | 23/50 [37:30<42:49, 95.17s/it]
Task 5, Epoch 24/50 => Loss 0.674, Train_accy 82.10, Test_accy 79.75:  48%|████▊     | 24/50 [37:30<41:03, 94.77s/it]
Task 3, Epoch 6/50 => Loss 0.910, Train_accy 76.23, Test_accy 78.33:  10%|█         | 5/50 [16:38<2:04:51, 166.47s/it]
Task 3, Epoch 6/50 => Loss 0.910, Train_accy 76.23, Test_accy 78.33:  12%|█▏        | 6/50 [16:38<2:02:14, 166.70s/it]
Task 5, Epoch 25/50 => Loss 0.680, Train_accy 82.07, Test_accy 79.41:  48%|████▊     | 24/50 [39:04<41:03, 94.77s/it]
Task 5, Epoch 25/50 => Loss 0.680, Train_accy 82.07, Test_accy 79.41:  50%|█████     | 25/50 [39:04<39:24, 94.58s/it]
Task 5, Epoch 26/50 => Loss 0.668, Train_accy 82.63, Test_accy 78.49:  50%|█████     | 25/50 [40:38<39:24, 94.58s/it]
Task 5, Epoch 26/50 => Loss 0.668, Train_accy 82.63, Test_accy 78.49:  52%|█████▏    | 26/50 [40:38<37:45, 94.39s/it]
Task 3, Epoch 7/50 => Loss 0.871, Train_accy 77.82, Test_accy 78.15:  12%|█▏        | 6/50 [19:28<2:02:14, 166.70s/it]
Task 3, Epoch 7/50 => Loss 0.871, Train_accy 77.82, Test_accy 78.15:  14%|█▍        | 7/50 [19:28<2:00:09, 167.65s/it]
Task 5, Epoch 27/50 => Loss 0.660, Train_accy 82.85, Test_accy 78.84:  52%|█████▏    | 26/50 [42:13<37:45, 94.39s/it]
Task 5, Epoch 27/50 => Loss 0.660, Train_accy 82.85, Test_accy 78.84:  54%|█████▍    | 27/50 [42:13<36:09, 94.32s/it]
Task 3, Epoch 8/50 => Loss 0.826, Train_accy 78.38, Test_accy 80.04:  14%|█▍        | 7/50 [22:12<2:00:09, 167.65s/it]
Task 3, Epoch 8/50 => Loss 0.826, Train_accy 78.38, Test_accy 80.04:  16%|█▌        | 8/50 [22:12<1:56:31, 166.46s/it]
Task 5, Epoch 28/50 => Loss 0.674, Train_accy 82.21, Test_accy 80.49:  54%|█████▍    | 27/50 [43:48<36:09, 94.32s/it]
Task 5, Epoch 28/50 => Loss 0.674, Train_accy 82.21, Test_accy 80.49:  56%|█████▌    | 28/50 [43:48<34:41, 94.63s/it]
Task 5, Epoch 29/50 => Loss 0.658, Train_accy 82.83, Test_accy 80.88:  56%|█████▌    | 28/50 [45:25<34:41, 94.63s/it]
Task 5, Epoch 29/50 => Loss 0.658, Train_accy 82.83, Test_accy 80.88:  58%|█████▊    | 29/50 [45:25<33:21, 95.30s/it]
Task 3, Epoch 9/50 => Loss 0.842, Train_accy 78.22, Test_accy 79.21:  16%|█▌        | 8/50 [24:57<1:56:31, 166.46s/it]
Task 3, Epoch 9/50 => Loss 0.842, Train_accy 78.22, Test_accy 79.21:  18%|█▊        | 9/50 [24:57<1:53:25, 166.00s/it]
Task 5, Epoch 30/50 => Loss 0.643, Train_accy 82.90, Test_accy 80.37:  58%|█████▊    | 29/50 [46:59<33:21, 95.30s/it]
Task 5, Epoch 30/50 => Loss 0.643, Train_accy 82.90, Test_accy 80.37:  60%|██████    | 30/50 [46:59<31:40, 95.01s/it]
Task 5, Epoch 31/50 => Loss 0.648, Train_accy 83.17, Test_accy 81.21:  60%|██████    | 30/50 [48:32<31:40, 95.01s/it]
Task 5, Epoch 31/50 => Loss 0.648, Train_accy 83.17, Test_accy 81.21:  62%|██████▏   | 31/50 [48:32<29:54, 94.44s/it]
Task 3, Epoch 10/50 => Loss 0.832, Train_accy 78.44, Test_accy 81.42:  18%|█▊        | 9/50 [27:48<1:53:25, 166.00s/it]
Task 3, Epoch 10/50 => Loss 0.832, Train_accy 78.44, Test_accy 81.42:  20%|██        | 10/50 [27:48<1:51:48, 167.72s/it]
Task 5, Epoch 32/50 => Loss 0.634, Train_accy 83.67, Test_accy 80.31:  62%|██████▏   | 31/50 [50:07<29:54, 94.44s/it]
Task 5, Epoch 32/50 => Loss 0.634, Train_accy 83.67, Test_accy 80.31:  64%|██████▍   | 32/50 [50:07<28:21, 94.51s/it]
Task 5, Epoch 33/50 => Loss 0.641, Train_accy 83.24, Test_accy 80.75:  64%|██████▍   | 32/50 [51:40<28:21, 94.51s/it]
Task 5, Epoch 33/50 => Loss 0.641, Train_accy 83.24, Test_accy 80.75:  66%|██████▌   | 33/50 [51:40<26:40, 94.13s/it]
Task 3, Epoch 11/50 => Loss 0.813, Train_accy 79.17, Test_accy 79.83:  20%|██        | 10/50 [30:37<1:51:48, 167.72s/it]
Task 3, Epoch 11/50 => Loss 0.813, Train_accy 79.17, Test_accy 79.83:  22%|██▏       | 11/50 [30:37<1:49:07, 167.89s/it]
Task 5, Epoch 34/50 => Loss 0.620, Train_accy 83.90, Test_accy 80.56:  66%|██████▌   | 33/50 [53:15<26:40, 94.13s/it]
Task 5, Epoch 34/50 => Loss 0.620, Train_accy 83.90, Test_accy 80.56:  68%|██████▊   | 34/50 [53:15<25:09, 94.35s/it]
Task 5, Epoch 35/50 => Loss 0.625, Train_accy 83.76, Test_accy 81.29:  68%|██████▊   | 34/50 [54:50<25:09, 94.35s/it]
Task 5, Epoch 35/50 => Loss 0.625, Train_accy 83.76, Test_accy 81.29:  70%|███████   | 35/50 [54:50<23:37, 94.53s/it]
Task 3, Epoch 12/50 => Loss 0.811, Train_accy 78.92, Test_accy 80.40:  22%|██▏       | 11/50 [33:21<1:49:07, 167.89s/it]
Task 3, Epoch 12/50 => Loss 0.811, Train_accy 78.92, Test_accy 80.40:  24%|██▍       | 12/50 [33:21<1:45:37, 166.78s/it]
Task 5, Epoch 36/50 => Loss 0.629, Train_accy 83.66, Test_accy 81.63:  70%|███████   | 35/50 [56:23<23:37, 94.53s/it]
Task 5, Epoch 36/50 => Loss 0.629, Train_accy 83.66, Test_accy 81.63:  72%|███████▏  | 36/50 [56:23<21:58, 94.19s/it]
Task 3, Epoch 13/50 => Loss 0.772, Train_accy 79.99, Test_accy 80.51:  24%|██▍       | 12/50 [36:13<1:45:37, 166.78s/it]
Task 3, Epoch 13/50 => Loss 0.772, Train_accy 79.99, Test_accy 80.51:  26%|██▌       | 13/50 [36:13<1:43:48, 168.33s/it]
Task 5, Epoch 37/50 => Loss 0.612, Train_accy 84.14, Test_accy 81.12:  72%|███████▏  | 36/50 [57:56<21:58, 94.19s/it]
Task 5, Epoch 37/50 => Loss 0.612, Train_accy 84.14, Test_accy 81.12:  74%|███████▍  | 37/50 [57:56<20:20, 93.86s/it]
Task 5, Epoch 38/50 => Loss 0.612, Train_accy 84.53, Test_accy 81.06:  74%|███████▍  | 37/50 [59:31<20:20, 93.86s/it]
Task 5, Epoch 38/50 => Loss 0.612, Train_accy 84.53, Test_accy 81.06:  76%|███████▌  | 38/50 [59:31<18:47, 93.98s/it]
Task 3, Epoch 14/50 => Loss 0.775, Train_accy 80.41, Test_accy 77.70:  26%|██▌       | 13/50 [39:02<1:43:48, 168.33s/it]
Task 3, Epoch 14/50 => Loss 0.775, Train_accy 80.41, Test_accy 77.70:  28%|██▊       | 14/50 [39:02<1:41:10, 168.64s/it]
Task 5, Epoch 39/50 => Loss 0.606, Train_accy 84.51, Test_accy 80.97:  76%|███████▌  | 38/50 [1:01:05<18:47, 93.98s/it]
Task 5, Epoch 39/50 => Loss 0.606, Train_accy 84.51, Test_accy 80.97:  78%|███████▊  | 39/50 [1:01:05<17:14, 94.06s/it]
Task 5, Epoch 40/50 => Loss 0.622, Train_accy 83.97, Test_accy 81.25:  78%|███████▊  | 39/50 [1:02:42<17:14, 94.06s/it]
Task 5, Epoch 40/50 => Loss 0.622, Train_accy 83.97, Test_accy 81.25:  80%|████████  | 40/50 [1:02:42<15:48, 94.90s/it]
Task 3, Epoch 15/50 => Loss 0.794, Train_accy 79.70, Test_accy 80.91:  28%|██▊       | 14/50 [41:45<1:41:10, 168.64s/it]
Task 3, Epoch 15/50 => Loss 0.794, Train_accy 79.70, Test_accy 80.91:  30%|███       | 15/50 [41:45<1:37:25, 167.01s/it]
Task 5, Epoch 41/50 => Loss 0.602, Train_accy 84.44, Test_accy 81.59:  80%|████████  | 40/50 [1:04:20<15:48, 94.90s/it]
Task 5, Epoch 41/50 => Loss 0.602, Train_accy 84.44, Test_accy 81.59:  82%|████████▏ | 41/50 [1:04:20<14:22, 95.81s/it]
Task 5, Epoch 42/50 => Loss 0.596, Train_accy 84.44, Test_accy 80.73:  82%|████████▏ | 41/50 [1:05:54<14:22, 95.81s/it]
Task 5, Epoch 42/50 => Loss 0.596, Train_accy 84.44, Test_accy 80.73:  84%|████████▍ | 42/50 [1:05:54<12:43, 95.40s/it]
Task 3, Epoch 16/50 => Loss 0.769, Train_accy 80.01, Test_accy 80.39:  30%|███       | 15/50 [44:30<1:37:25, 167.01s/it]
Task 3, Epoch 16/50 => Loss 0.769, Train_accy 80.01, Test_accy 80.39:  32%|███▏      | 16/50 [44:30<1:34:17, 166.40s/it]
Task 5, Epoch 43/50 => Loss 0.609, Train_accy 84.16, Test_accy 81.26:  84%|████████▍ | 42/50 [1:07:28<12:43, 95.40s/it]
Task 5, Epoch 43/50 => Loss 0.609, Train_accy 84.16, Test_accy 81.26:  86%|████████▌ | 43/50 [1:07:28<11:05, 95.03s/it]
Task 3, Epoch 17/50 => Loss 0.749, Train_accy 81.12, Test_accy 80.08:  32%|███▏      | 16/50 [47:19<1:34:17, 166.40s/it]
Task 3, Epoch 17/50 => Loss 0.749, Train_accy 81.12, Test_accy 80.08:  34%|███▍      | 17/50 [47:19<1:31:50, 166.99s/it]
Task 5, Epoch 44/50 => Loss 0.594, Train_accy 84.57, Test_accy 81.15:  86%|████████▌ | 43/50 [1:09:03<11:05, 95.03s/it]
Task 5, Epoch 44/50 => Loss 0.594, Train_accy 84.57, Test_accy 81.15:  88%|████████▊ | 44/50 [1:09:03<09:28, 94.82s/it]
Task 5, Epoch 45/50 => Loss 0.592, Train_accy 85.04, Test_accy 81.41:  88%|████████▊ | 44/50 [1:10:37<09:28, 94.82s/it]
Task 5, Epoch 45/50 => Loss 0.592, Train_accy 85.04, Test_accy 81.41:  90%|█████████ | 45/50 [1:10:37<07:52, 94.58s/it]
Task 3, Epoch 18/50 => Loss 0.740, Train_accy 81.35, Test_accy 81.39:  34%|███▍      | 17/50 [50:06<1:31:50, 166.99s/it]
Task 3, Epoch 18/50 => Loss 0.740, Train_accy 81.35, Test_accy 81.39:  36%|███▌      | 18/50 [50:06<1:29:06, 167.07s/it]
Task 5, Epoch 46/50 => Loss 0.601, Train_accy 84.66, Test_accy 81.60:  90%|█████████ | 45/50 [1:12:13<07:52, 94.58s/it]
Task 5, Epoch 46/50 => Loss 0.601, Train_accy 84.66, Test_accy 81.60:  92%|█████████▏| 46/50 [1:12:13<06:19, 94.98s/it]
Task 5, Epoch 47/50 => Loss 0.570, Train_accy 85.60, Test_accy 81.50:  92%|█████████▏| 46/50 [1:13:48<06:19, 94.98s/it]
Task 5, Epoch 47/50 => Loss 0.570, Train_accy 85.60, Test_accy 81.50:  94%|█████████▍| 47/50 [1:13:48<04:45, 95.14s/it]
Task 3, Epoch 19/50 => Loss 0.744, Train_accy 80.90, Test_accy 81.20:  36%|███▌      | 18/50 [52:50<1:29:06, 167.07s/it]
Task 3, Epoch 19/50 => Loss 0.744, Train_accy 80.90, Test_accy 81.20:  38%|███▊      | 19/50 [52:50<1:25:53, 166.24s/it]
Task 5, Epoch 48/50 => Loss 0.605, Train_accy 84.43, Test_accy 81.49:  94%|█████████▍| 47/50 [1:15:23<04:45, 95.14s/it]
Task 5, Epoch 48/50 => Loss 0.605, Train_accy 84.43, Test_accy 81.49:  96%|█████████▌| 48/50 [1:15:23<03:10, 95.08s/it]
Task 5, Epoch 49/50 => Loss 0.581, Train_accy 85.00, Test_accy 81.53:  96%|█████████▌| 48/50 [1:16:56<03:10, 95.08s/it]
Task 5, Epoch 49/50 => Loss 0.581, Train_accy 85.00, Test_accy 81.53:  98%|█████████▊| 49/50 [1:16:56<01:34, 94.42s/it]
Task 3, Epoch 20/50 => Loss 0.725, Train_accy 81.64, Test_accy 81.27:  38%|███▊      | 19/50 [55:40<1:25:53, 166.24s/it]
Task 3, Epoch 20/50 => Loss 0.725, Train_accy 81.64, Test_accy 81.27:  40%|████      | 20/50 [55:40<1:23:37, 167.25s/it]
Task 5, Epoch 50/50 => Loss 0.603, Train_accy 84.44, Test_accy 81.50:  98%|█████████▊| 49/50 [1:18:30<01:34, 94.42s/it]
Task 5, Epoch 50/50 => Loss 0.603, Train_accy 84.44, Test_accy 81.50: 100%|██████████| 50/50 [1:18:30<00:00, 94.31s/it]
Task 5, Epoch 50/50 => Loss 0.603, Train_accy 84.44, Test_accy 81.50: 100%|██████████| 50/50 [1:18:30<00:00, 94.21s/it]
2024-06-14 06:52:03,318 [lora_prompt.py] => Task 5, Epoch 50/50 => Loss 0.603, Train_accy 84.44, Test_accy 81.50

Task 3, Epoch 21/50 => Loss 0.724, Train_accy 81.60, Test_accy 82.99:  40%|████      | 20/50 [58:29<1:23:37, 167.25s/it]
Task 3, Epoch 21/50 => Loss 0.724, Train_accy 81.60, Test_accy 82.99:  42%|████▏     | 21/50 [58:29<1:21:04, 167.75s/it]
Task 3, Epoch 22/50 => Loss 0.739, Train_accy 81.21, Test_accy 80.92:  42%|████▏     | 21/50 [1:01:11<1:21:04, 167.75s/it]
Task 3, Epoch 22/50 => Loss 0.739, Train_accy 81.21, Test_accy 80.92:  44%|████▍     | 22/50 [1:01:11<1:17:34, 166.22s/it]
Task 3, Epoch 23/50 => Loss 0.728, Train_accy 81.35, Test_accy 81.39:  44%|████▍     | 22/50 [1:03:59<1:17:34, 166.22s/it]
Task 3, Epoch 23/50 => Loss 0.728, Train_accy 81.35, Test_accy 81.39:  46%|████▌     | 23/50 [1:03:59<1:14:57, 166.58s/it]/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 07:00:08,910 [lora_prompt.py] => Exemplar size: 0
2024-06-14 07:00:08,911 [trainer.py] => CNN: {'total': 85.71, '00-49': 85.71, 'old': 85.71, 'new': nan}
2024-06-14 07:00:08,911 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76, 83.93, 85.74, 85.71]
2024-06-14 07:00:08,918 [trainer.py] => All params: 840861697
2024-06-14 07:00:08,923 [trainer.py] => Trainable params: 204800
2024-06-14 07:00:08,923 [lora_prompt.py] => Learning on 300-350
Parameters to be updated: {'classifier_pool.6.ctx', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]
Task 6, Epoch 1/50 => Loss 2.099, Train_accy 24.05, Test_accy 38.17:   0%|          | 0/50 [01:30<?, ?it/s]
Task 6, Epoch 1/50 => Loss 2.099, Train_accy 24.05, Test_accy 38.17:   2%|▏         | 1/50 [01:30<1:13:46, 90.33s/it]
Task 3, Epoch 24/50 => Loss 0.713, Train_accy 81.93, Test_accy 81.88:  46%|████▌     | 23/50 [1:06:51<1:14:57, 166.58s/it]
Task 3, Epoch 24/50 => Loss 0.713, Train_accy 81.93, Test_accy 81.88:  48%|████▊     | 24/50 [1:06:51<1:12:50, 168.09s/it]
Task 6, Epoch 2/50 => Loss 1.452, Train_accy 55.11, Test_accy 62.42:   2%|▏         | 1/50 [03:02<1:13:46, 90.33s/it]
Task 6, Epoch 2/50 => Loss 1.452, Train_accy 55.11, Test_accy 62.42:   4%|▍         | 2/50 [03:02<1:13:20, 91.68s/it]
Task 3, Epoch 25/50 => Loss 0.698, Train_accy 82.04, Test_accy 82.70:  48%|████▊     | 24/50 [1:09:39<1:12:50, 168.09s/it]
Task 3, Epoch 25/50 => Loss 0.698, Train_accy 82.04, Test_accy 82.70:  50%|█████     | 25/50 [1:09:39<1:10:02, 168.10s/it]
Task 6, Epoch 3/50 => Loss 0.998, Train_accy 73.16, Test_accy 70.71:   4%|▍         | 2/50 [04:40<1:13:20, 91.68s/it]
Task 6, Epoch 3/50 => Loss 0.998, Train_accy 73.16, Test_accy 70.71:   6%|▌         | 3/50 [04:40<1:13:57, 94.41s/it]
Task 6, Epoch 4/50 => Loss 0.880, Train_accy 77.46, Test_accy 69.42:   6%|▌         | 3/50 [06:17<1:13:57, 94.41s/it]
Task 6, Epoch 4/50 => Loss 0.880, Train_accy 77.46, Test_accy 69.42:   8%|▊         | 4/50 [06:17<1:13:05, 95.33s/it]
Task 3, Epoch 26/50 => Loss 0.679, Train_accy 82.63, Test_accy 83.11:  50%|█████     | 25/50 [1:12:27<1:10:02, 168.10s/it]
Task 3, Epoch 26/50 => Loss 0.679, Train_accy 82.63, Test_accy 83.11:  52%|█████▏    | 26/50 [1:12:27<1:07:18, 168.26s/it]
Task 6, Epoch 5/50 => Loss 0.810, Train_accy 79.26, Test_accy 73.22:   8%|▊         | 4/50 [07:50<1:13:05, 95.33s/it]
Task 6, Epoch 5/50 => Loss 0.810, Train_accy 79.26, Test_accy 73.22:  10%|█         | 5/50 [07:50<1:10:59, 94.66s/it]
Task 6, Epoch 6/50 => Loss 0.758, Train_accy 80.65, Test_accy 74.05:  10%|█         | 5/50 [09:23<1:10:59, 94.66s/it]
Task 6, Epoch 6/50 => Loss 0.758, Train_accy 80.65, Test_accy 74.05:  12%|█▏        | 6/50 [09:23<1:08:57, 94.03s/it]
Task 3, Epoch 27/50 => Loss 0.681, Train_accy 82.61, Test_accy 82.23:  52%|█████▏    | 26/50 [1:15:20<1:07:18, 168.26s/it]
Task 3, Epoch 27/50 => Loss 0.681, Train_accy 82.61, Test_accy 82.23:  54%|█████▍    | 27/50 [1:15:20<1:04:59, 169.55s/it]
Task 6, Epoch 7/50 => Loss 0.712, Train_accy 82.24, Test_accy 77.10:  12%|█▏        | 6/50 [10:56<1:08:57, 94.03s/it]
Task 6, Epoch 7/50 => Loss 0.712, Train_accy 82.24, Test_accy 77.10:  14%|█▍        | 7/50 [10:56<1:07:04, 93.60s/it]
Task 6, Epoch 8/50 => Loss 0.688, Train_accy 82.91, Test_accy 75.39:  14%|█▍        | 7/50 [12:28<1:07:04, 93.60s/it]
Task 6, Epoch 8/50 => Loss 0.688, Train_accy 82.91, Test_accy 75.39:  16%|█▌        | 8/50 [12:28<1:05:16, 93.24s/it]
Task 3, Epoch 28/50 => Loss 0.665, Train_accy 83.14, Test_accy 82.40:  54%|█████▍    | 27/50 [1:18:10<1:04:59, 169.55s/it]
Task 3, Epoch 28/50 => Loss 0.665, Train_accy 83.14, Test_accy 82.40:  56%|█████▌    | 28/50 [1:18:10<1:02:14, 169.77s/it]
Task 6, Epoch 9/50 => Loss 0.683, Train_accy 82.79, Test_accy 75.09:  16%|█▌        | 8/50 [14:02<1:05:16, 93.24s/it]
Task 6, Epoch 9/50 => Loss 0.683, Train_accy 82.79, Test_accy 75.09:  18%|█▊        | 9/50 [14:02<1:03:52, 93.48s/it]
Task 6, Epoch 10/50 => Loss 0.660, Train_accy 83.72, Test_accy 74.78:  18%|█▊        | 9/50 [15:37<1:03:52, 93.48s/it]
Task 6, Epoch 10/50 => Loss 0.660, Train_accy 83.72, Test_accy 74.78:  20%|██        | 10/50 [15:37<1:02:37, 93.94s/it]
Task 3, Epoch 29/50 => Loss 0.685, Train_accy 82.70, Test_accy 81.87:  56%|█████▌    | 28/50 [1:20:56<1:02:14, 169.77s/it]
Task 3, Epoch 29/50 => Loss 0.685, Train_accy 82.70, Test_accy 81.87:  58%|█████▊    | 29/50 [1:20:56<58:59, 168.55s/it]  
Task 6, Epoch 11/50 => Loss 0.640, Train_accy 84.10, Test_accy 75.83:  20%|██        | 10/50 [17:10<1:02:37, 93.94s/it]
Task 6, Epoch 11/50 => Loss 0.640, Train_accy 84.10, Test_accy 75.83:  22%|██▏       | 11/50 [17:10<1:00:54, 93.70s/it]
Task 3, Epoch 30/50 => Loss 0.675, Train_accy 82.89, Test_accy 82.33:  58%|█████▊    | 29/50 [1:23:48<58:59, 168.55s/it]
Task 3, Epoch 30/50 => Loss 0.675, Train_accy 82.89, Test_accy 82.33:  60%|██████    | 30/50 [1:23:48<56:30, 169.50s/it]
Task 6, Epoch 12/50 => Loss 0.637, Train_accy 84.30, Test_accy 78.20:  22%|██▏       | 11/50 [18:43<1:00:54, 93.70s/it]
Task 6, Epoch 12/50 => Loss 0.637, Train_accy 84.30, Test_accy 78.20:  24%|██▍       | 12/50 [18:43<59:07, 93.35s/it]  
Task 6, Epoch 13/50 => Loss 0.630, Train_accy 84.47, Test_accy 79.01:  24%|██▍       | 12/50 [20:15<59:07, 93.35s/it]
Task 6, Epoch 13/50 => Loss 0.630, Train_accy 84.47, Test_accy 79.01:  26%|██▌       | 13/50 [20:15<57:23, 93.06s/it]
Task 3, Epoch 31/50 => Loss 0.674, Train_accy 82.85, Test_accy 82.85:  60%|██████    | 30/50 [1:26:39<56:30, 169.50s/it]
Task 3, Epoch 31/50 => Loss 0.674, Train_accy 82.85, Test_accy 82.85:  62%|██████▏   | 31/50 [1:26:39<53:54, 170.22s/it]
Task 6, Epoch 14/50 => Loss 0.605, Train_accy 85.07, Test_accy 77.65:  26%|██▌       | 13/50 [21:47<57:23, 93.06s/it]
Task 6, Epoch 14/50 => Loss 0.605, Train_accy 85.07, Test_accy 77.65:  28%|██▊       | 14/50 [21:47<55:35, 92.64s/it]
Task 6, Epoch 15/50 => Loss 0.598, Train_accy 85.42, Test_accy 79.32:  28%|██▊       | 14/50 [23:21<55:35, 92.64s/it]
Task 6, Epoch 15/50 => Loss 0.598, Train_accy 85.42, Test_accy 79.32:  30%|███       | 15/50 [23:21<54:14, 92.99s/it]
Task 3, Epoch 32/50 => Loss 0.673, Train_accy 83.23, Test_accy 82.94:  62%|██████▏   | 31/50 [1:29:27<53:54, 170.22s/it]
Task 3, Epoch 32/50 => Loss 0.673, Train_accy 83.23, Test_accy 82.94:  64%|██████▍   | 32/50 [1:29:27<50:47, 169.30s/it]
Task 6, Epoch 16/50 => Loss 0.598, Train_accy 85.39, Test_accy 77.76:  30%|███       | 15/50 [24:55<54:14, 92.99s/it]
Task 6, Epoch 16/50 => Loss 0.598, Train_accy 85.39, Test_accy 77.76:  32%|███▏      | 16/50 [24:55<52:50, 93.24s/it]
Task 6, Epoch 17/50 => Loss 0.584, Train_accy 85.63, Test_accy 80.12:  32%|███▏      | 16/50 [26:27<52:50, 93.24s/it]
Task 6, Epoch 17/50 => Loss 0.584, Train_accy 85.63, Test_accy 80.12:  34%|███▍      | 17/50 [26:27<51:04, 92.88s/it]
Task 3, Epoch 33/50 => Loss 0.674, Train_accy 83.05, Test_accy 82.89:  64%|██████▍   | 32/50 [1:32:15<50:47, 169.30s/it]
Task 3, Epoch 33/50 => Loss 0.674, Train_accy 83.05, Test_accy 82.89:  66%|██████▌   | 33/50 [1:32:15<47:55, 169.13s/it]
Task 6, Epoch 18/50 => Loss 0.595, Train_accy 85.56, Test_accy 79.15:  34%|███▍      | 17/50 [28:00<51:04, 92.88s/it]
Task 6, Epoch 18/50 => Loss 0.595, Train_accy 85.56, Test_accy 79.15:  36%|███▌      | 18/50 [28:00<49:36, 93.01s/it]
Task 6, Epoch 19/50 => Loss 0.561, Train_accy 86.24, Test_accy 77.28:  36%|███▌      | 18/50 [29:32<49:36, 93.01s/it]
Task 6, Epoch 19/50 => Loss 0.561, Train_accy 86.24, Test_accy 77.28:  38%|███▊      | 19/50 [29:32<47:50, 92.59s/it]
Task 3, Epoch 34/50 => Loss 0.666, Train_accy 83.09, Test_accy 83.28:  66%|██████▌   | 33/50 [1:35:07<47:55, 169.13s/it]
Task 3, Epoch 34/50 => Loss 0.666, Train_accy 83.09, Test_accy 83.28:  68%|██████▊   | 34/50 [1:35:07<45:19, 169.96s/it]
Task 6, Epoch 20/50 => Loss 0.576, Train_accy 85.84, Test_accy 78.40:  38%|███▊      | 19/50 [31:04<47:50, 92.59s/it]
Task 6, Epoch 20/50 => Loss 0.576, Train_accy 85.84, Test_accy 78.40:  40%|████      | 20/50 [31:04<46:11, 92.38s/it]
Task 6, Epoch 21/50 => Loss 0.579, Train_accy 86.02, Test_accy 79.44:  40%|████      | 20/50 [32:36<46:11, 92.38s/it]
Task 6, Epoch 21/50 => Loss 0.579, Train_accy 86.02, Test_accy 79.44:  42%|████▏     | 21/50 [32:36<44:42, 92.50s/it]
Task 3, Epoch 35/50 => Loss 0.666, Train_accy 83.21, Test_accy 82.89:  68%|██████▊   | 34/50 [1:37:55<45:19, 169.96s/it]
Task 3, Epoch 35/50 => Loss 0.666, Train_accy 83.21, Test_accy 82.89:  70%|███████   | 35/50 [1:37:55<42:19, 169.28s/it]
Task 6, Epoch 22/50 => Loss 0.547, Train_accy 86.68, Test_accy 79.38:  42%|████▏     | 21/50 [34:13<44:42, 92.50s/it]
Task 6, Epoch 22/50 => Loss 0.547, Train_accy 86.68, Test_accy 79.38:  44%|████▍     | 22/50 [34:13<43:46, 93.82s/it]
Task 3, Epoch 36/50 => Loss 0.650, Train_accy 83.39, Test_accy 83.66:  70%|███████   | 35/50 [1:40:42<42:19, 169.28s/it]
Task 3, Epoch 36/50 => Loss 0.650, Train_accy 83.39, Test_accy 83.66:  72%|███████▏  | 36/50 [1:40:42<39:18, 168.50s/it]
Task 6, Epoch 23/50 => Loss 0.524, Train_accy 87.10, Test_accy 79.91:  44%|████▍     | 22/50 [35:46<43:46, 93.82s/it]
Task 6, Epoch 23/50 => Loss 0.524, Train_accy 87.10, Test_accy 79.91:  46%|████▌     | 23/50 [35:46<42:06, 93.58s/it]
Task 6, Epoch 24/50 => Loss 0.544, Train_accy 86.54, Test_accy 79.21:  46%|████▌     | 23/50 [37:20<42:06, 93.58s/it]
Task 6, Epoch 24/50 => Loss 0.544, Train_accy 86.54, Test_accy 79.21:  48%|████▊     | 24/50 [37:20<40:31, 93.51s/it]
Task 3, Epoch 37/50 => Loss 0.669, Train_accy 83.10, Test_accy 83.95:  72%|███████▏  | 36/50 [1:43:30<39:18, 168.50s/it]
Task 3, Epoch 37/50 => Loss 0.669, Train_accy 83.10, Test_accy 83.95:  74%|███████▍  | 37/50 [1:43:30<36:31, 168.58s/it]
Task 6, Epoch 25/50 => Loss 0.559, Train_accy 86.38, Test_accy 79.55:  48%|████▊     | 24/50 [38:54<40:31, 93.51s/it]
Task 6, Epoch 25/50 => Loss 0.559, Train_accy 86.38, Test_accy 79.55:  50%|█████     | 25/50 [38:54<39:01, 93.65s/it]
Task 6, Epoch 26/50 => Loss 0.554, Train_accy 86.12, Test_accy 79.91:  50%|█████     | 25/50 [40:25<39:01, 93.65s/it]
Task 6, Epoch 26/50 => Loss 0.554, Train_accy 86.12, Test_accy 79.91:  52%|█████▏    | 26/50 [40:25<37:15, 93.13s/it]
Task 3, Epoch 38/50 => Loss 0.660, Train_accy 83.61, Test_accy 83.70:  74%|███████▍  | 37/50 [1:46:17<36:31, 168.58s/it]
Task 3, Epoch 38/50 => Loss 0.660, Train_accy 83.61, Test_accy 83.70:  76%|███████▌  | 38/50 [1:46:17<33:36, 168.05s/it]
Task 6, Epoch 27/50 => Loss 0.529, Train_accy 86.91, Test_accy 78.76:  52%|█████▏    | 26/50 [41:59<37:15, 93.13s/it]
Task 6, Epoch 27/50 => Loss 0.529, Train_accy 86.91, Test_accy 78.76:  54%|█████▍    | 27/50 [41:59<35:41, 93.10s/it]
Task 6, Epoch 28/50 => Loss 0.537, Train_accy 86.66, Test_accy 79.82:  54%|█████▍    | 27/50 [43:34<35:41, 93.10s/it]
Task 6, Epoch 28/50 => Loss 0.537, Train_accy 86.66, Test_accy 79.82:  56%|█████▌    | 28/50 [43:34<34:21, 93.71s/it]
Task 3, Epoch 39/50 => Loss 0.650, Train_accy 83.70, Test_accy 83.84:  76%|███████▌  | 38/50 [1:49:00<33:36, 168.05s/it]
Task 3, Epoch 39/50 => Loss 0.650, Train_accy 83.70, Test_accy 83.84:  78%|███████▊  | 39/50 [1:49:00<30:32, 166.56s/it]
Task 6, Epoch 29/50 => Loss 0.532, Train_accy 86.98, Test_accy 80.01:  56%|█████▌    | 28/50 [45:06<34:21, 93.71s/it]
Task 6, Epoch 29/50 => Loss 0.532, Train_accy 86.98, Test_accy 80.01:  58%|█████▊    | 29/50 [45:06<32:41, 93.40s/it]
Task 6, Epoch 30/50 => Loss 0.522, Train_accy 87.22, Test_accy 79.97:  58%|█████▊    | 29/50 [46:38<32:41, 93.40s/it]
Task 6, Epoch 30/50 => Loss 0.522, Train_accy 87.22, Test_accy 79.97:  60%|██████    | 30/50 [46:38<30:59, 92.99s/it]
Task 3, Epoch 40/50 => Loss 0.640, Train_accy 83.82, Test_accy 83.23:  78%|███████▊  | 39/50 [1:51:49<30:32, 166.56s/it]
Task 3, Epoch 40/50 => Loss 0.640, Train_accy 83.82, Test_accy 83.23:  80%|████████  | 40/50 [1:51:49<27:51, 167.17s/it]
Task 6, Epoch 31/50 => Loss 0.528, Train_accy 87.12, Test_accy 80.21:  60%|██████    | 30/50 [48:11<30:59, 92.99s/it]
Task 6, Epoch 31/50 => Loss 0.528, Train_accy 87.12, Test_accy 80.21:  62%|██████▏   | 31/50 [48:11<29:23, 92.80s/it]
Task 3, Epoch 41/50 => Loss 0.656, Train_accy 83.49, Test_accy 83.57:  80%|████████  | 40/50 [1:54:39<27:51, 167.17s/it]
Task 3, Epoch 41/50 => Loss 0.656, Train_accy 83.49, Test_accy 83.57:  82%|████████▏ | 41/50 [1:54:39<25:11, 167.98s/it]
Task 6, Epoch 32/50 => Loss 0.525, Train_accy 87.33, Test_accy 80.29:  62%|██████▏   | 31/50 [49:43<29:23, 92.80s/it]
Task 6, Epoch 32/50 => Loss 0.525, Train_accy 87.33, Test_accy 80.29:  64%|██████▍   | 32/50 [49:43<27:47, 92.64s/it]
Task 6, Epoch 33/50 => Loss 0.517, Train_accy 87.32, Test_accy 80.42:  64%|██████▍   | 32/50 [51:15<27:47, 92.64s/it]
Task 6, Epoch 33/50 => Loss 0.517, Train_accy 87.32, Test_accy 80.42:  66%|██████▌   | 33/50 [51:15<26:10, 92.39s/it]
Task 3, Epoch 42/50 => Loss 0.638, Train_accy 84.03, Test_accy 83.52:  82%|████████▏ | 41/50 [1:57:25<25:11, 167.98s/it]
Task 3, Epoch 42/50 => Loss 0.638, Train_accy 84.03, Test_accy 83.52:  84%|████████▍ | 42/50 [1:57:25<22:19, 167.43s/it]
Task 6, Epoch 34/50 => Loss 0.503, Train_accy 87.40, Test_accy 79.86:  66%|██████▌   | 33/50 [52:49<26:10, 92.39s/it]
Task 6, Epoch 34/50 => Loss 0.503, Train_accy 87.40, Test_accy 79.86:  68%|██████▊   | 34/50 [52:49<24:47, 92.96s/it]
Task 6, Epoch 35/50 => Loss 0.511, Train_accy 87.53, Test_accy 80.56:  68%|██████▊   | 34/50 [54:22<24:47, 92.96s/it]
Task 6, Epoch 35/50 => Loss 0.511, Train_accy 87.53, Test_accy 80.56:  70%|███████   | 35/50 [54:22<23:15, 93.05s/it]
Task 3, Epoch 43/50 => Loss 0.632, Train_accy 84.26, Test_accy 83.20:  84%|████████▍ | 42/50 [2:00:12<22:19, 167.43s/it]
Task 3, Epoch 43/50 => Loss 0.632, Train_accy 84.26, Test_accy 83.20:  86%|████████▌ | 43/50 [2:00:12<19:31, 167.35s/it]
Task 6, Epoch 36/50 => Loss 0.500, Train_accy 88.06, Test_accy 80.26:  70%|███████   | 35/50 [55:56<23:15, 93.05s/it]
Task 6, Epoch 36/50 => Loss 0.500, Train_accy 88.06, Test_accy 80.26:  72%|███████▏  | 36/50 [55:56<21:45, 93.22s/it]
Task 6, Epoch 37/50 => Loss 0.499, Train_accy 87.71, Test_accy 80.11:  72%|███████▏  | 36/50 [57:28<21:45, 93.22s/it]
Task 6, Epoch 37/50 => Loss 0.499, Train_accy 87.71, Test_accy 80.11:  74%|███████▍  | 37/50 [57:28<20:08, 92.95s/it]
Task 3, Epoch 44/50 => Loss 0.634, Train_accy 83.99, Test_accy 83.47:  86%|████████▌ | 43/50 [2:03:01<19:31, 167.35s/it]
Task 3, Epoch 44/50 => Loss 0.634, Train_accy 83.99, Test_accy 83.47:  88%|████████▊ | 44/50 [2:03:01<16:46, 167.80s/it]
Task 6, Epoch 38/50 => Loss 0.504, Train_accy 87.79, Test_accy 79.74:  74%|███████▍  | 37/50 [59:02<20:08, 92.95s/it]
Task 6, Epoch 38/50 => Loss 0.504, Train_accy 87.79, Test_accy 79.74:  76%|███████▌  | 38/50 [59:02<18:38, 93.20s/it]
Task 6, Epoch 39/50 => Loss 0.507, Train_accy 87.59, Test_accy 80.22:  76%|███████▌  | 38/50 [1:00:35<18:38, 93.20s/it]
Task 6, Epoch 39/50 => Loss 0.507, Train_accy 87.59, Test_accy 80.22:  78%|███████▊  | 39/50 [1:00:35<17:03, 93.05s/it]
Task 3, Epoch 45/50 => Loss 0.626, Train_accy 84.54, Test_accy 83.53:  88%|████████▊ | 44/50 [2:05:46<16:46, 167.80s/it]
Task 3, Epoch 45/50 => Loss 0.626, Train_accy 84.54, Test_accy 83.53:  90%|█████████ | 45/50 [2:05:46<13:55, 167.09s/it]
Task 6, Epoch 40/50 => Loss 0.487, Train_accy 88.25, Test_accy 80.17:  78%|███████▊  | 39/50 [1:02:09<17:03, 93.05s/it]
Task 6, Epoch 40/50 => Loss 0.487, Train_accy 88.25, Test_accy 80.17:  80%|████████  | 40/50 [1:02:09<15:34, 93.44s/it]
Task 3, Epoch 46/50 => Loss 0.654, Train_accy 83.56, Test_accy 83.66:  90%|█████████ | 45/50 [2:08:28<13:55, 167.09s/it]
Task 3, Epoch 46/50 => Loss 0.654, Train_accy 83.56, Test_accy 83.66:  92%|█████████▏| 46/50 [2:08:28<11:01, 165.39s/it]
Task 6, Epoch 41/50 => Loss 0.479, Train_accy 88.31, Test_accy 80.52:  80%|████████  | 40/50 [1:03:43<15:34, 93.44s/it]
Task 6, Epoch 41/50 => Loss 0.479, Train_accy 88.31, Test_accy 80.52:  82%|████████▏ | 41/50 [1:03:43<14:01, 93.54s/it]
Task 6, Epoch 42/50 => Loss 0.476, Train_accy 88.46, Test_accy 80.08:  82%|████████▏ | 41/50 [1:05:17<14:01, 93.54s/it]
Task 6, Epoch 42/50 => Loss 0.476, Train_accy 88.46, Test_accy 80.08:  84%|████████▍ | 42/50 [1:05:17<12:28, 93.59s/it]
Task 3, Epoch 47/50 => Loss 0.641, Train_accy 84.26, Test_accy 83.65:  92%|█████████▏| 46/50 [2:11:15<11:01, 165.39s/it]
Task 3, Epoch 47/50 => Loss 0.641, Train_accy 84.26, Test_accy 83.65:  94%|█████████▍| 47/50 [2:11:15<08:17, 165.92s/it]
Task 6, Epoch 43/50 => Loss 0.490, Train_accy 88.32, Test_accy 80.45:  84%|████████▍ | 42/50 [1:06:50<12:28, 93.59s/it]
Task 6, Epoch 43/50 => Loss 0.490, Train_accy 88.32, Test_accy 80.45:  86%|████████▌ | 43/50 [1:06:50<10:53, 93.42s/it]
Task 6, Epoch 44/50 => Loss 0.465, Train_accy 88.74, Test_accy 80.19:  86%|████████▌ | 43/50 [1:08:22<10:53, 93.42s/it]
Task 6, Epoch 44/50 => Loss 0.465, Train_accy 88.74, Test_accy 80.19:  88%|████████▊ | 44/50 [1:08:22<09:18, 93.16s/it]
Task 3, Epoch 48/50 => Loss 0.626, Train_accy 84.45, Test_accy 83.65:  94%|█████████▍| 47/50 [2:14:03<08:17, 165.92s/it]
Task 3, Epoch 48/50 => Loss 0.626, Train_accy 84.45, Test_accy 83.65:  96%|█████████▌| 48/50 [2:14:03<05:33, 166.73s/it]
Task 6, Epoch 45/50 => Loss 0.490, Train_accy 88.36, Test_accy 80.25:  88%|████████▊ | 44/50 [1:09:55<09:18, 93.16s/it]
Task 6, Epoch 45/50 => Loss 0.490, Train_accy 88.36, Test_accy 80.25:  90%|█████████ | 45/50 [1:09:55<07:45, 93.01s/it]
Task 6, Epoch 46/50 => Loss 0.471, Train_accy 88.47, Test_accy 80.46:  90%|█████████ | 45/50 [1:11:29<07:45, 93.01s/it]
Task 6, Epoch 46/50 => Loss 0.471, Train_accy 88.47, Test_accy 80.46:  92%|█████████▏| 46/50 [1:11:29<06:12, 93.24s/it]
Task 3, Epoch 49/50 => Loss 0.633, Train_accy 84.13, Test_accy 83.73:  96%|█████████▌| 48/50 [2:16:48<05:33, 166.73s/it]
Task 3, Epoch 49/50 => Loss 0.633, Train_accy 84.13, Test_accy 83.73:  98%|█████████▊| 49/50 [2:16:48<02:46, 166.16s/it]
Task 6, Epoch 47/50 => Loss 0.488, Train_accy 88.65, Test_accy 80.44:  92%|█████████▏| 46/50 [1:13:04<06:12, 93.24s/it]
Task 6, Epoch 47/50 => Loss 0.488, Train_accy 88.65, Test_accy 80.44:  94%|█████████▍| 47/50 [1:13:04<04:41, 93.91s/it]
Task 3, Epoch 50/50 => Loss 0.625, Train_accy 84.54, Test_accy 83.68:  98%|█████████▊| 49/50 [2:19:33<02:46, 166.16s/it]
Task 3, Epoch 50/50 => Loss 0.625, Train_accy 84.54, Test_accy 83.68: 100%|██████████| 50/50 [2:19:33<00:00, 165.71s/it]
Task 3, Epoch 50/50 => Loss 0.625, Train_accy 84.54, Test_accy 83.68: 100%|██████████| 50/50 [2:19:33<00:00, 167.47s/it]
2024-06-14 08:14:36,405 [lora_prompt.py] => Task 3, Epoch 50/50 => Loss 0.625, Train_accy 84.54, Test_accy 83.68

Task 6, Epoch 48/50 => Loss 0.477, Train_accy 88.31, Test_accy 80.36:  94%|█████████▍| 47/50 [1:14:36<04:41, 93.91s/it]
Task 6, Epoch 48/50 => Loss 0.477, Train_accy 88.31, Test_accy 80.36:  96%|█████████▌| 48/50 [1:14:36<03:06, 93.33s/it]
Task 6, Epoch 49/50 => Loss 0.480, Train_accy 88.46, Test_accy 80.38:  96%|█████████▌| 48/50 [1:16:09<03:06, 93.33s/it]
Task 6, Epoch 49/50 => Loss 0.480, Train_accy 88.46, Test_accy 80.38:  98%|█████████▊| 49/50 [1:16:09<01:33, 93.31s/it]
Task 6, Epoch 50/50 => Loss 0.486, Train_accy 88.29, Test_accy 80.39:  98%|█████████▊| 49/50 [1:17:42<01:33, 93.31s/it]
Task 6, Epoch 50/50 => Loss 0.486, Train_accy 88.29, Test_accy 80.39: 100%|██████████| 50/50 [1:17:42<00:00, 93.06s/it]
Task 6, Epoch 50/50 => Loss 0.486, Train_accy 88.29, Test_accy 80.39: 100%|██████████| 50/50 [1:17:42<00:00, 93.25s/it]
2024-06-14 08:17:53,720 [lora_prompt.py] => Task 6, Epoch 50/50 => Loss 0.486, Train_accy 88.29, Test_accy 80.39
/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 08:25:49,269 [lora_prompt.py] => Exemplar size: 0
2024-06-14 08:25:49,269 [trainer.py] => CNN: {'total': 85.62, '00-49': 85.62, 'old': 85.62, 'new': nan}
2024-06-14 08:25:49,270 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76, 83.93, 85.74, 85.71, 85.62]
2024-06-14 08:25:49,279 [trainer.py] => All params: 840861697
2024-06-14 08:25:49,284 [trainer.py] => Trainable params: 204800
2024-06-14 08:25:49,284 [lora_prompt.py] => Learning on 350-400
Parameters to be updated: {'lora_image_model_pool.7.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'classifier_pool.7.ctx', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 08:26:05,797 [lora_prompt.py] => Exemplar size: 0
2024-06-14 08:26:05,797 [trainer.py] => CNN: {'total': 83.93, '00-49': 83.93, 'old': 83.93, 'new': nan}
2024-06-14 08:26:05,798 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76, 83.93]
2024-06-14 08:26:05,804 [trainer.py] => All params: 840861697
2024-06-14 08:26:05,810 [trainer.py] => Trainable params: 204800
2024-06-14 08:26:05,810 [lora_prompt.py] => Learning on 200-250
Parameters to be updated: {'lora_image_model_pool.4.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'classifier_pool.4.ctx', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.4.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight'},count:204800

  0%|          | 0/50 [00:00<?, ?it/s]
Task 7, Epoch 1/50 => Loss 2.102, Train_accy 22.72, Test_accy 33.92:   0%|          | 0/50 [01:30<?, ?it/s]
Task 7, Epoch 1/50 => Loss 2.102, Train_accy 22.72, Test_accy 33.92:   2%|▏         | 1/50 [01:30<1:14:05, 90.73s/it]
Task 7, Epoch 2/50 => Loss 1.584, Train_accy 50.33, Test_accy 60.67:   2%|▏         | 1/50 [03:02<1:14:05, 90.73s/it]
Task 7, Epoch 2/50 => Loss 1.584, Train_accy 50.33, Test_accy 60.67:   4%|▍         | 2/50 [03:02<1:13:14, 91.56s/it]
Task 4, Epoch 1/50 => Loss 2.045, Train_accy 23.24, Test_accy 28.60:   0%|          | 0/50 [02:45<?, ?it/s]
Task 4, Epoch 1/50 => Loss 2.045, Train_accy 23.24, Test_accy 28.60:   2%|▏         | 1/50 [02:45<2:15:29, 165.90s/it]
Task 7, Epoch 3/50 => Loss 1.175, Train_accy 67.53, Test_accy 69.71:   4%|▍         | 2/50 [04:36<1:13:14, 91.56s/it]
Task 7, Epoch 3/50 => Loss 1.175, Train_accy 67.53, Test_accy 69.71:   6%|▌         | 3/50 [04:36<1:12:20, 92.34s/it]
Task 4, Epoch 2/50 => Loss 1.710, Train_accy 42.60, Test_accy 53.79:   2%|▏         | 1/50 [05:27<2:15:29, 165.90s/it]
Task 4, Epoch 2/50 => Loss 1.710, Train_accy 42.60, Test_accy 53.79:   4%|▍         | 2/50 [05:27<2:10:33, 163.20s/it]
Task 7, Epoch 4/50 => Loss 0.977, Train_accy 74.01, Test_accy 77.33:   6%|▌         | 3/50 [06:07<1:12:20, 92.34s/it]
Task 7, Epoch 4/50 => Loss 0.977, Train_accy 74.01, Test_accy 77.33:   8%|▊         | 4/50 [06:07<1:10:24, 91.83s/it]
Task 7, Epoch 5/50 => Loss 0.863, Train_accy 76.70, Test_accy 78.88:   8%|▊         | 4/50 [07:38<1:10:24, 91.83s/it]
Task 7, Epoch 5/50 => Loss 0.863, Train_accy 76.70, Test_accy 78.88:  10%|█         | 5/50 [07:38<1:08:46, 91.70s/it]
Task 4, Epoch 3/50 => Loss 1.150, Train_accy 67.34, Test_accy 69.22:   4%|▍         | 2/50 [08:14<2:10:33, 163.20s/it]
Task 4, Epoch 3/50 => Loss 1.150, Train_accy 67.34, Test_accy 69.22:   6%|▌         | 3/50 [08:14<2:09:20, 165.12s/it]
Task 7, Epoch 6/50 => Loss 0.782, Train_accy 79.33, Test_accy 79.61:  10%|█         | 5/50 [09:10<1:08:46, 91.70s/it]
Task 7, Epoch 6/50 => Loss 0.782, Train_accy 79.33, Test_accy 79.61:  12%|█▏        | 6/50 [09:10<1:07:20, 91.84s/it]
Task 7, Epoch 7/50 => Loss 0.750, Train_accy 80.23, Test_accy 81.01:  12%|█▏        | 6/50 [10:41<1:07:20, 91.84s/it]
Task 7, Epoch 7/50 => Loss 0.750, Train_accy 80.23, Test_accy 81.01:  14%|█▍        | 7/50 [10:41<1:05:30, 91.42s/it]
Task 4, Epoch 4/50 => Loss 0.867, Train_accy 76.79, Test_accy 73.19:   6%|▌         | 3/50 [11:04<2:09:20, 165.12s/it]
Task 4, Epoch 4/50 => Loss 0.867, Train_accy 76.79, Test_accy 73.19:   8%|▊         | 4/50 [11:04<2:08:09, 167.17s/it]
Task 7, Epoch 8/50 => Loss 0.697, Train_accy 81.79, Test_accy 81.80:  14%|█▍        | 7/50 [12:13<1:05:30, 91.42s/it]
Task 7, Epoch 8/50 => Loss 0.697, Train_accy 81.79, Test_accy 81.80:  16%|█▌        | 8/50 [12:13<1:04:09, 91.64s/it]
Task 7, Epoch 9/50 => Loss 0.671, Train_accy 81.87, Test_accy 81.76:  16%|█▌        | 8/50 [13:44<1:04:09, 91.64s/it]
Task 7, Epoch 9/50 => Loss 0.671, Train_accy 81.87, Test_accy 81.76:  18%|█▊        | 9/50 [13:44<1:02:34, 91.58s/it]
Task 4, Epoch 5/50 => Loss 0.733, Train_accy 80.22, Test_accy 78.17:   8%|▊         | 4/50 [13:52<2:08:09, 167.17s/it]
Task 4, Epoch 5/50 => Loss 0.733, Train_accy 80.22, Test_accy 78.17:  10%|█         | 5/50 [13:52<2:05:32, 167.40s/it]
Task 7, Epoch 10/50 => Loss 0.663, Train_accy 82.21, Test_accy 80.02:  18%|█▊        | 9/50 [15:17<1:02:34, 91.58s/it]
Task 7, Epoch 10/50 => Loss 0.663, Train_accy 82.21, Test_accy 80.02:  20%|██        | 10/50 [15:17<1:01:14, 91.87s/it]
Task 7, Epoch 11/50 => Loss 0.651, Train_accy 82.65, Test_accy 82.64:  20%|██        | 10/50 [16:49<1:01:14, 91.87s/it]
Task 7, Epoch 11/50 => Loss 0.651, Train_accy 82.65, Test_accy 82.64:  22%|██▏       | 11/50 [16:49<59:43, 91.88s/it]  
Task 4, Epoch 6/50 => Loss 0.684, Train_accy 81.85, Test_accy 79.82:  10%|█         | 5/50 [16:40<2:05:32, 167.40s/it]
Task 4, Epoch 6/50 => Loss 0.684, Train_accy 81.85, Test_accy 79.82:  12%|█▏        | 6/50 [16:40<2:02:47, 167.44s/it]
Task 7, Epoch 12/50 => Loss 0.617, Train_accy 83.64, Test_accy 82.18:  22%|██▏       | 11/50 [18:20<59:43, 91.88s/it]
Task 7, Epoch 12/50 => Loss 0.617, Train_accy 83.64, Test_accy 82.18:  24%|██▍       | 12/50 [18:20<58:03, 91.68s/it]
Task 4, Epoch 7/50 => Loss 0.631, Train_accy 82.91, Test_accy 79.12:  12%|█▏        | 6/50 [19:27<2:02:47, 167.44s/it]
Task 4, Epoch 7/50 => Loss 0.631, Train_accy 82.91, Test_accy 79.12:  14%|█▍        | 7/50 [19:27<1:59:58, 167.41s/it]
Task 7, Epoch 13/50 => Loss 0.621, Train_accy 83.64, Test_accy 82.82:  24%|██▍       | 12/50 [19:52<58:03, 91.68s/it]
Task 7, Epoch 13/50 => Loss 0.621, Train_accy 83.64, Test_accy 82.82:  26%|██▌       | 13/50 [19:52<56:36, 91.81s/it]
Task 7, Epoch 14/50 => Loss 0.606, Train_accy 84.10, Test_accy 83.05:  26%|██▌       | 13/50 [21:26<56:36, 91.81s/it]
Task 7, Epoch 14/50 => Loss 0.606, Train_accy 84.10, Test_accy 83.05:  28%|██▊       | 14/50 [21:26<55:32, 92.57s/it]
Task 4, Epoch 8/50 => Loss 0.624, Train_accy 83.48, Test_accy 83.43:  14%|█▍        | 7/50 [22:10<1:59:58, 167.41s/it]
Task 4, Epoch 8/50 => Loss 0.624, Train_accy 83.48, Test_accy 83.43:  16%|█▌        | 8/50 [22:10<1:56:04, 165.82s/it]
Task 7, Epoch 15/50 => Loss 0.603, Train_accy 84.36, Test_accy 83.83:  28%|██▊       | 14/50 [23:03<55:32, 92.57s/it]
Task 7, Epoch 15/50 => Loss 0.603, Train_accy 84.36, Test_accy 83.83:  30%|███       | 15/50 [23:03<54:39, 93.70s/it]
Task 7, Epoch 16/50 => Loss 0.585, Train_accy 84.61, Test_accy 82.17:  30%|███       | 15/50 [24:37<54:39, 93.70s/it]
Task 7, Epoch 16/50 => Loss 0.585, Train_accy 84.61, Test_accy 82.17:  32%|███▏      | 16/50 [24:37<53:13, 93.92s/it]
Task 4, Epoch 9/50 => Loss 0.593, Train_accy 84.46, Test_accy 83.68:  16%|█▌        | 8/50 [24:53<1:56:04, 165.82s/it]
Task 4, Epoch 9/50 => Loss 0.593, Train_accy 84.46, Test_accy 83.68:  18%|█▊        | 9/50 [24:53<1:52:46, 165.03s/it]
Task 7, Epoch 17/50 => Loss 0.572, Train_accy 85.27, Test_accy 83.73:  32%|███▏      | 16/50 [26:11<53:13, 93.92s/it]
Task 7, Epoch 17/50 => Loss 0.572, Train_accy 85.27, Test_accy 83.73:  34%|███▍      | 17/50 [26:11<51:40, 93.95s/it]
Task 7, Epoch 18/50 => Loss 0.567, Train_accy 85.20, Test_accy 82.07:  34%|███▍      | 17/50 [27:45<51:40, 93.95s/it]
Task 7, Epoch 18/50 => Loss 0.567, Train_accy 85.20, Test_accy 82.07:  36%|███▌      | 18/50 [27:45<50:04, 93.89s/it]
Task 4, Epoch 10/50 => Loss 0.579, Train_accy 84.80, Test_accy 83.39:  18%|█▊        | 9/50 [27:37<1:52:46, 165.03s/it]
Task 4, Epoch 10/50 => Loss 0.579, Train_accy 84.80, Test_accy 83.39:  20%|██        | 10/50 [27:37<1:49:56, 164.91s/it]
Task 7, Epoch 19/50 => Loss 0.588, Train_accy 84.36, Test_accy 83.19:  36%|███▌      | 18/50 [29:18<50:04, 93.89s/it]
Task 7, Epoch 19/50 => Loss 0.588, Train_accy 84.36, Test_accy 83.19:  38%|███▊      | 19/50 [29:18<48:25, 93.73s/it]
Task 4, Epoch 11/50 => Loss 0.564, Train_accy 85.21, Test_accy 83.02:  20%|██        | 10/50 [30:26<1:49:56, 164.91s/it]
Task 4, Epoch 11/50 => Loss 0.564, Train_accy 85.21, Test_accy 83.02:  22%|██▏       | 11/50 [30:26<1:47:54, 166.02s/it]
Task 7, Epoch 20/50 => Loss 0.564, Train_accy 85.18, Test_accy 83.96:  38%|███▊      | 19/50 [30:52<48:25, 93.73s/it]
Task 7, Epoch 20/50 => Loss 0.564, Train_accy 85.18, Test_accy 83.96:  40%|████      | 20/50 [30:52<46:50, 93.68s/it]
Task 7, Epoch 21/50 => Loss 0.561, Train_accy 85.36, Test_accy 83.73:  40%|████      | 20/50 [32:24<46:50, 93.68s/it]
Task 7, Epoch 21/50 => Loss 0.561, Train_accy 85.36, Test_accy 83.73:  42%|████▏     | 21/50 [32:24<45:06, 93.32s/it]
Task 4, Epoch 12/50 => Loss 0.544, Train_accy 85.78, Test_accy 82.98:  22%|██▏       | 11/50 [33:15<1:47:54, 166.02s/it]
Task 4, Epoch 12/50 => Loss 0.544, Train_accy 85.78, Test_accy 82.98:  24%|██▍       | 12/50 [33:15<1:45:45, 167.00s/it]
Task 7, Epoch 22/50 => Loss 0.554, Train_accy 85.43, Test_accy 83.45:  42%|████▏     | 21/50 [33:57<45:06, 93.32s/it]
Task 7, Epoch 22/50 => Loss 0.554, Train_accy 85.43, Test_accy 83.45:  44%|████▍     | 22/50 [33:57<43:29, 93.20s/it]
Task 7, Epoch 23/50 => Loss 0.538, Train_accy 86.23, Test_accy 84.64:  44%|████▍     | 22/50 [35:30<43:29, 93.20s/it]
Task 7, Epoch 23/50 => Loss 0.538, Train_accy 86.23, Test_accy 84.64:  46%|████▌     | 23/50 [35:30<41:52, 93.05s/it]
Task 4, Epoch 13/50 => Loss 0.525, Train_accy 86.06, Test_accy 83.75:  24%|██▍       | 12/50 [36:04<1:45:45, 167.00s/it]
Task 4, Epoch 13/50 => Loss 0.525, Train_accy 86.06, Test_accy 83.75:  26%|██▌       | 13/50 [36:04<1:43:19, 167.56s/it]
Task 7, Epoch 24/50 => Loss 0.548, Train_accy 85.56, Test_accy 84.19:  46%|████▌     | 23/50 [37:03<41:52, 93.05s/it]
Task 7, Epoch 24/50 => Loss 0.548, Train_accy 85.56, Test_accy 84.19:  48%|████▊     | 24/50 [37:03<40:19, 93.07s/it]
Task 7, Epoch 25/50 => Loss 0.533, Train_accy 86.36, Test_accy 84.74:  48%|████▊     | 24/50 [38:36<40:19, 93.07s/it]
Task 7, Epoch 25/50 => Loss 0.533, Train_accy 86.36, Test_accy 84.74:  50%|█████     | 25/50 [38:36<38:48, 93.14s/it]
Task 4, Epoch 14/50 => Loss 0.534, Train_accy 85.49, Test_accy 83.55:  26%|██▌       | 13/50 [38:52<1:43:19, 167.56s/it]
Task 4, Epoch 14/50 => Loss 0.534, Train_accy 85.49, Test_accy 83.55:  28%|██▊       | 14/50 [38:52<1:40:39, 167.77s/it]Task 7, Epoch 26/50 => Loss 0.521, Train_accy 86.28, Test_accy 84.94:  50%|█████     | 25/50 [40:12<38:48, 93.14s/it]Task 7, Epoch 26/50 => Loss 0.521, Train_accy 86.28, Test_accy 84.94:  52%|█████▏    | 26/50 [40:12<37:29, 93.75s/it]Task 7, Epoch 27/50 => Loss 0.542, Train_accy 86.12, Test_accy 84.41:  52%|█████▏    | 26/50 [41:46<37:29, 93.75s/it]Task 7, Epoch 27/50 => Loss 0.542, Train_accy 86.12, Test_accy 84.41:  54%|█████▍    | 27/50 [41:46<35:59, 93.91s/it]Task 4, Epoch 15/50 => Loss 0.519, Train_accy 86.49, Test_accy 84.76:  28%|██▊       | 14/50 [41:41<1:40:39, 167.77s/it]Task 4, Epoch 15/50 => Loss 0.519, Train_accy 86.49, Test_accy 84.76:  30%|███       | 15/50 [41:41<1:37:58, 167.95s/it]Task 7, Epoch 28/50 => Loss 0.521, Train_accy 86.44, Test_accy 85.55:  54%|█████▍    | 27/50 [43:20<35:59, 93.91s/it]Task 7, Epoch 28/50 => Loss 0.521, Train_accy 86.44, Test_accy 85.55:  56%|█████▌    | 28/50 [43:20<34:24, 93.84s/it]Task 4, Epoch 16/50 => Loss 0.521, Train_accy 86.18, Test_accy 83.36:  30%|███       | 15/50 [44:23<1:37:58, 167.95s/it]Task 4, Epoch 16/50 => Loss 0.521, Train_accy 86.18, Test_accy 83.36:  32%|███▏      | 16/50 [44:23<1:34:07, 166.11s/it]Task 7, Epoch 29/50 => Loss 0.507, Train_accy 87.21, Test_accy 85.18:  56%|█████▌    | 28/50 [44:56<34:24, 93.84s/it]Task 7, Epoch 29/50 => Loss 0.507, Train_accy 87.21, Test_accy 85.18:  58%|█████▊    | 29/50 [44:56<33:05, 94.54s/it]Task 7, Epoch 30/50 => Loss 0.518, Train_accy 86.73, Test_accy 86.42:  58%|█████▊    | 29/50 [46:29<33:05, 94.54s/it]Task 7, Epoch 30/50 => Loss 0.518, Train_accy 86.73, Test_accy 86.42:  60%|██████    | 30/50 [46:29<31:20, 94.04s/it]Task 4, Epoch 17/50 => Loss 0.515, Train_accy 86.52, Test_accy 84.20:  32%|███▏      | 16/50 [47:07<1:34:07, 166.11s/it]Task 4, Epoch 17/50 => Loss 0.515, Train_accy 86.52, Test_accy 84.20:  34%|███▍      | 17/50 [47:07<1:31:06, 165.65s/it]Task 7, Epoch 31/50 => Loss 0.503, Train_accy 87.15, Test_accy 85.15:  60%|██████    | 30/50 [48:02<31:20, 94.04s/it]Task 7, Epoch 31/50 => Loss 0.503, Train_accy 87.15, Test_accy 85.15:  62%|██████▏   | 31/50 [48:02<29:43, 93.88s/it]Task 7, Epoch 32/50 => Loss 0.502, Train_accy 87.07, Test_accy 86.25:  62%|██████▏   | 31/50 [49:36<29:43, 93.88s/it]Task 7, Epoch 32/50 => Loss 0.502, Train_accy 87.07, Test_accy 86.25:  64%|██████▍   | 32/50 [49:36<28:08, 93.83s/it]Task 4, Epoch 18/50 => Loss 0.503, Train_accy 86.91, Test_accy 83.77:  34%|███▍      | 17/50 [49:56<1:31:06, 165.65s/it]Task 4, Epoch 18/50 => Loss 0.503, Train_accy 86.91, Test_accy 83.77:  36%|███▌      | 18/50 [49:56<1:28:48, 166.50s/it]Task 7, Epoch 33/50 => Loss 0.510, Train_accy 86.67, Test_accy 86.00:  64%|██████▍   | 32/50 [51:10<28:08, 93.83s/it]Task 7, Epoch 33/50 => Loss 0.510, Train_accy 86.67, Test_accy 86.00:  66%|██████▌   | 33/50 [51:10<26:35, 93.86s/it]Task 7, Epoch 34/50 => Loss 0.519, Train_accy 86.61, Test_accy 85.59:  66%|██████▌   | 33/50 [52:43<26:35, 93.86s/it]Task 7, Epoch 34/50 => Loss 0.519, Train_accy 86.61, Test_accy 85.59:  68%|██████▊   | 34/50 [52:43<24:59, 93.73s/it]Task 4, Epoch 19/50 => Loss 0.481, Train_accy 87.57, Test_accy 84.83:  36%|███▌      | 18/50 [52:47<1:28:48, 166.50s/it]Task 4, Epoch 19/50 => Loss 0.481, Train_accy 87.57, Test_accy 84.83:  38%|███▊      | 19/50 [52:47<1:26:47, 167.99s/it]Task 7, Epoch 35/50 => Loss 0.499, Train_accy 87.07, Test_accy 86.58:  68%|██████▊   | 34/50 [54:18<24:59, 93.73s/it]Task 7, Epoch 35/50 => Loss 0.499, Train_accy 87.07, Test_accy 86.58:  70%|███████   | 35/50 [54:18<23:33, 94.20s/it]Task 7, Epoch 36/50 => Loss 0.483, Train_accy 87.53, Test_accy 85.35:  70%|███████   | 35/50 [55:51<23:33, 94.20s/it]Task 7, Epoch 36/50 => Loss 0.483, Train_accy 87.53, Test_accy 85.35:  72%|███████▏  | 36/50 [55:51<21:52, 93.75s/it]Task 4, Epoch 20/50 => Loss 0.476, Train_accy 87.68, Test_accy 84.67:  38%|███▊      | 19/50 [55:39<1:26:47, 167.99s/it]Task 4, Epoch 20/50 => Loss 0.476, Train_accy 87.68, Test_accy 84.67:  40%|████      | 20/50 [55:39<1:24:36, 169.23s/it]Task 7, Epoch 37/50 => Loss 0.496, Train_accy 87.21, Test_accy 86.45:  72%|███████▏  | 36/50 [57:26<21:52, 93.75s/it]Task 7, Epoch 37/50 => Loss 0.496, Train_accy 87.21, Test_accy 86.45:  74%|███████▍  | 37/50 [57:26<20:22, 94.05s/it]Task 4, Epoch 21/50 => Loss 0.503, Train_accy 86.94, Test_accy 84.85:  40%|████      | 20/50 [58:31<1:24:36, 169.23s/it]Task 4, Epoch 21/50 => Loss 0.503, Train_accy 86.94, Test_accy 84.85:  42%|████▏     | 21/50 [58:31<1:22:13, 170.13s/it]Task 7, Epoch 38/50 => Loss 0.491, Train_accy 87.57, Test_accy 85.87:  74%|███████▍  | 37/50 [58:58<20:22, 94.05s/it]Task 7, Epoch 38/50 => Loss 0.491, Train_accy 87.57, Test_accy 85.87:  76%|███████▌  | 38/50 [58:58<18:41, 93.44s/it]Task 7, Epoch 39/50 => Loss 0.479, Train_accy 87.69, Test_accy 86.08:  76%|███████▌  | 38/50 [1:00:31<18:41, 93.44s/it]Task 7, Epoch 39/50 => Loss 0.479, Train_accy 87.69, Test_accy 86.08:  78%|███████▊  | 39/50 [1:00:31<17:07, 93.42s/it]Task 4, Epoch 22/50 => Loss 0.483, Train_accy 87.26, Test_accy 84.69:  42%|████▏     | 21/50 [1:01:24<1:22:13, 170.13s/it]Task 4, Epoch 22/50 => Loss 0.483, Train_accy 87.26, Test_accy 84.69:  44%|████▍     | 22/50 [1:01:24<1:19:40, 170.72s/it]Task 7, Epoch 40/50 => Loss 0.464, Train_accy 88.18, Test_accy 86.45:  78%|███████▊  | 39/50 [1:02:06<17:07, 93.42s/it]Task 7, Epoch 40/50 => Loss 0.464, Train_accy 88.18, Test_accy 86.45:  80%|████████  | 40/50 [1:02:06<15:36, 93.70s/it]Task 7, Epoch 41/50 => Loss 0.480, Train_accy 87.60, Test_accy 86.64:  80%|████████  | 40/50 [1:03:40<15:36, 93.70s/it]Task 7, Epoch 41/50 => Loss 0.480, Train_accy 87.60, Test_accy 86.64:  82%|████████▏ | 41/50 [1:03:40<14:04, 93.78s/it]Task 4, Epoch 23/50 => Loss 0.460, Train_accy 87.60, Test_accy 84.88:  44%|████▍     | 22/50 [1:04:12<1:19:40, 170.72s/it]Task 4, Epoch 23/50 => Loss 0.460, Train_accy 87.60, Test_accy 84.88:  46%|████▌     | 23/50 [1:04:12<1:16:33, 170.13s/it]Task 7, Epoch 42/50 => Loss 0.455, Train_accy 88.64, Test_accy 86.26:  82%|████████▏ | 41/50 [1:05:14<14:04, 93.78s/it]Task 7, Epoch 42/50 => Loss 0.455, Train_accy 88.64, Test_accy 86.26:  84%|████████▍ | 42/50 [1:05:14<12:31, 93.93s/it]Task 7, Epoch 43/50 => Loss 0.465, Train_accy 88.27, Test_accy 86.32:  84%|████████▍ | 42/50 [1:06:50<12:31, 93.93s/it]Task 7, Epoch 43/50 => Loss 0.465, Train_accy 88.27, Test_accy 86.32:  86%|████████▌ | 43/50 [1:06:50<11:01, 94.48s/it]Task 4, Epoch 24/50 => Loss 0.468, Train_accy 87.50, Test_accy 85.09:  46%|████▌     | 23/50 [1:07:00<1:16:33, 170.13s/it]Task 4, Epoch 24/50 => Loss 0.468, Train_accy 87.50, Test_accy 85.09:  48%|████▊     | 24/50 [1:07:00<1:13:22, 169.32s/it]Task 7, Epoch 44/50 => Loss 0.475, Train_accy 87.87, Test_accy 86.52:  86%|████████▌ | 43/50 [1:08:22<11:01, 94.48s/it]Task 7, Epoch 44/50 => Loss 0.475, Train_accy 87.87, Test_accy 86.52:  88%|████████▊ | 44/50 [1:08:22<09:23, 93.95s/it]Task 7, Epoch 45/50 => Loss 0.478, Train_accy 88.19, Test_accy 86.72:  88%|████████▊ | 44/50 [1:09:56<09:23, 93.95s/it]Task 7, Epoch 45/50 => Loss 0.478, Train_accy 88.19, Test_accy 86.72:  90%|█████████ | 45/50 [1:09:56<07:49, 93.90s/it]Task 4, Epoch 25/50 => Loss 0.464, Train_accy 87.71, Test_accy 84.29:  48%|████▊     | 24/50 [1:09:46<1:13:22, 169.32s/it]Task 4, Epoch 25/50 => Loss 0.464, Train_accy 87.71, Test_accy 84.29:  50%|█████     | 25/50 [1:09:46<1:10:12, 168.51s/it]Task 7, Epoch 46/50 => Loss 0.479, Train_accy 87.73, Test_accy 86.52:  90%|█████████ | 45/50 [1:11:30<07:49, 93.90s/it]Task 7, Epoch 46/50 => Loss 0.479, Train_accy 87.73, Test_accy 86.52:  92%|█████████▏| 46/50 [1:11:30<06:15, 93.89s/it]Task 4, Epoch 26/50 => Loss 0.470, Train_accy 87.53, Test_accy 85.13:  50%|█████     | 25/50 [1:12:37<1:10:12, 168.51s/it]Task 4, Epoch 26/50 => Loss 0.470, Train_accy 87.53, Test_accy 85.13:  52%|█████▏    | 26/50 [1:12:37<1:07:38, 169.09s/it]Task 7, Epoch 47/50 => Loss 0.458, Train_accy 88.43, Test_accy 86.58:  92%|█████████▏| 46/50 [1:13:05<06:15, 93.89s/it]Task 7, Epoch 47/50 => Loss 0.458, Train_accy 88.43, Test_accy 86.58:  94%|█████████▍| 47/50 [1:13:05<04:42, 94.27s/it]Task 7, Epoch 48/50 => Loss 0.467, Train_accy 88.41, Test_accy 86.58:  94%|█████████▍| 47/50 [1:14:39<04:42, 94.27s/it]Task 7, Epoch 48/50 => Loss 0.467, Train_accy 88.41, Test_accy 86.58:  96%|█████████▌| 48/50 [1:14:39<03:08, 94.27s/it]Task 4, Epoch 27/50 => Loss 0.475, Train_accy 87.84, Test_accy 86.08:  52%|█████▏    | 26/50 [1:15:29<1:07:38, 169.09s/it]Task 4, Epoch 27/50 => Loss 0.475, Train_accy 87.84, Test_accy 86.08:  54%|█████▍    | 27/50 [1:15:29<1:05:08, 169.92s/it]Task 7, Epoch 49/50 => Loss 0.482, Train_accy 87.90, Test_accy 86.53:  96%|█████████▌| 48/50 [1:16:14<03:08, 94.27s/it]Task 7, Epoch 49/50 => Loss 0.482, Train_accy 87.90, Test_accy 86.53:  98%|█████████▊| 49/50 [1:16:14<01:34, 94.28s/it]Task 7, Epoch 50/50 => Loss 0.483, Train_accy 87.70, Test_accy 86.56:  98%|█████████▊| 49/50 [1:17:47<01:34, 94.28s/it]Task 7, Epoch 50/50 => Loss 0.483, Train_accy 87.70, Test_accy 86.56: 100%|██████████| 50/50 [1:17:47<00:00, 94.02s/it]Task 7, Epoch 50/50 => Loss 0.483, Train_accy 87.70, Test_accy 86.56: 100%|██████████| 50/50 [1:17:47<00:00, 93.35s/it]
2024-06-14 09:43:39,581 [lora_prompt.py] => Task 7, Epoch 50/50 => Loss 0.483, Train_accy 87.70, Test_accy 86.56
Task 4, Epoch 28/50 => Loss 0.440, Train_accy 88.91, Test_accy 85.34:  54%|█████▍    | 27/50 [1:18:21<1:05:08, 169.92s/it]Task 4, Epoch 28/50 => Loss 0.440, Train_accy 88.91, Test_accy 85.34:  56%|█████▌    | 28/50 [1:18:21<1:02:35, 170.71s/it]Task 4, Epoch 29/50 => Loss 0.444, Train_accy 88.43, Test_accy 86.03:  56%|█████▌    | 28/50 [1:21:13<1:02:35, 170.71s/it]Task 4, Epoch 29/50 => Loss 0.444, Train_accy 88.43, Test_accy 86.03:  58%|█████▊    | 29/50 [1:21:13<59:52, 171.05s/it]  Task 4, Epoch 30/50 => Loss 0.462, Train_accy 88.06, Test_accy 84.44:  58%|█████▊    | 29/50 [1:24:04<59:52, 171.05s/it]Task 4, Epoch 30/50 => Loss 0.462, Train_accy 88.06, Test_accy 84.44:  60%|██████    | 30/50 [1:24:04<57:01, 171.10s/it]/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 09:51:36,461 [lora_prompt.py] => Exemplar size: 0
2024-06-14 09:51:36,462 [trainer.py] => CNN: {'total': 86.21, '00-49': 86.21, 'old': 86.21, 'new': nan}
2024-06-14 09:51:36,463 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76, 83.93, 85.74, 85.71, 85.62, 86.21]
Task 4, Epoch 31/50 => Loss 0.446, Train_accy 88.30, Test_accy 85.07:  60%|██████    | 30/50 [1:26:49<57:01, 171.10s/it]Task 4, Epoch 31/50 => Loss 0.446, Train_accy 88.30, Test_accy 85.07:  62%|██████▏   | 31/50 [1:26:49<53:32, 169.10s/it]Task 4, Epoch 32/50 => Loss 0.428, Train_accy 88.72, Test_accy 86.09:  62%|██████▏   | 31/50 [1:29:34<53:32, 169.10s/it]Task 4, Epoch 32/50 => Loss 0.428, Train_accy 88.72, Test_accy 86.09:  64%|██████▍   | 32/50 [1:29:34<50:26, 168.12s/it]Task 4, Epoch 33/50 => Loss 0.428, Train_accy 88.85, Test_accy 84.80:  64%|██████▍   | 32/50 [1:32:24<50:26, 168.12s/it]Task 4, Epoch 33/50 => Loss 0.428, Train_accy 88.85, Test_accy 84.80:  66%|██████▌   | 33/50 [1:32:24<47:46, 168.63s/it]Task 4, Epoch 34/50 => Loss 0.440, Train_accy 88.82, Test_accy 84.97:  66%|██████▌   | 33/50 [1:35:16<47:46, 168.63s/it]Task 4, Epoch 34/50 => Loss 0.440, Train_accy 88.82, Test_accy 84.97:  68%|██████▊   | 34/50 [1:35:16<45:12, 169.52s/it]Task 4, Epoch 35/50 => Loss 0.444, Train_accy 88.60, Test_accy 85.73:  68%|██████▊   | 34/50 [1:38:08<45:12, 169.52s/it]Task 4, Epoch 35/50 => Loss 0.444, Train_accy 88.60, Test_accy 85.73:  70%|███████   | 35/50 [1:38:08<42:33, 170.25s/it]Task 4, Epoch 36/50 => Loss 0.435, Train_accy 88.69, Test_accy 85.88:  70%|███████   | 35/50 [1:41:00<42:33, 170.25s/it]Task 4, Epoch 36/50 => Loss 0.435, Train_accy 88.69, Test_accy 85.88:  72%|███████▏  | 36/50 [1:41:00<39:52, 170.88s/it]Task 4, Epoch 37/50 => Loss 0.428, Train_accy 89.11, Test_accy 86.70:  72%|███████▏  | 36/50 [1:43:52<39:52, 170.88s/it]Task 4, Epoch 37/50 => Loss 0.428, Train_accy 89.11, Test_accy 86.70:  74%|███████▍  | 37/50 [1:43:52<37:03, 171.03s/it]Task 4, Epoch 38/50 => Loss 0.435, Train_accy 88.92, Test_accy 86.63:  74%|███████▍  | 37/50 [1:46:38<37:03, 171.03s/it]Task 4, Epoch 38/50 => Loss 0.435, Train_accy 88.92, Test_accy 86.63:  76%|███████▌  | 38/50 [1:46:38<33:56, 169.72s/it]Task 4, Epoch 39/50 => Loss 0.412, Train_accy 89.61, Test_accy 86.04:  76%|███████▌  | 38/50 [1:49:28<33:56, 169.72s/it]Task 4, Epoch 39/50 => Loss 0.412, Train_accy 89.61, Test_accy 86.04:  78%|███████▊  | 39/50 [1:49:28<31:06, 169.70s/it]Task 4, Epoch 40/50 => Loss 0.422, Train_accy 89.25, Test_accy 86.21:  78%|███████▊  | 39/50 [1:52:14<31:06, 169.70s/it]Task 4, Epoch 40/50 => Loss 0.422, Train_accy 89.25, Test_accy 86.21:  80%|████████  | 40/50 [1:52:14<28:07, 168.71s/it]Task 4, Epoch 41/50 => Loss 0.412, Train_accy 89.56, Test_accy 85.91:  80%|████████  | 40/50 [1:55:04<28:07, 168.71s/it]Task 4, Epoch 41/50 => Loss 0.412, Train_accy 89.56, Test_accy 85.91:  82%|████████▏ | 41/50 [1:55:04<25:22, 169.15s/it]Task 4, Epoch 42/50 => Loss 0.400, Train_accy 89.99, Test_accy 85.97:  82%|████████▏ | 41/50 [1:57:56<25:22, 169.15s/it]Task 4, Epoch 42/50 => Loss 0.400, Train_accy 89.99, Test_accy 85.97:  84%|████████▍ | 42/50 [1:57:56<22:38, 169.85s/it]Task 4, Epoch 43/50 => Loss 0.414, Train_accy 89.57, Test_accy 86.13:  84%|████████▍ | 42/50 [2:00:48<22:38, 169.85s/it]Task 4, Epoch 43/50 => Loss 0.414, Train_accy 89.57, Test_accy 86.13:  86%|████████▌ | 43/50 [2:00:48<19:54, 170.59s/it]Task 4, Epoch 44/50 => Loss 0.402, Train_accy 89.75, Test_accy 86.50:  86%|████████▌ | 43/50 [2:03:40<19:54, 170.59s/it]Task 4, Epoch 44/50 => Loss 0.402, Train_accy 89.75, Test_accy 86.50:  88%|████████▊ | 44/50 [2:03:40<17:05, 170.94s/it]Task 4, Epoch 45/50 => Loss 0.418, Train_accy 89.54, Test_accy 86.48:  88%|████████▊ | 44/50 [2:06:32<17:05, 170.94s/it]Task 4, Epoch 45/50 => Loss 0.418, Train_accy 89.54, Test_accy 86.48:  90%|█████████ | 45/50 [2:06:32<14:15, 171.12s/it]Task 4, Epoch 46/50 => Loss 0.403, Train_accy 89.73, Test_accy 86.35:  90%|█████████ | 45/50 [2:09:22<14:15, 171.12s/it]Task 4, Epoch 46/50 => Loss 0.403, Train_accy 89.73, Test_accy 86.35:  92%|█████████▏| 46/50 [2:09:22<11:23, 170.77s/it]Task 4, Epoch 47/50 => Loss 0.409, Train_accy 89.53, Test_accy 86.31:  92%|█████████▏| 46/50 [2:12:12<11:23, 170.77s/it]Task 4, Epoch 47/50 => Loss 0.409, Train_accy 89.53, Test_accy 86.31:  94%|█████████▍| 47/50 [2:12:12<08:32, 170.79s/it]Task 4, Epoch 48/50 => Loss 0.421, Train_accy 89.17, Test_accy 86.33:  94%|█████████▍| 47/50 [2:15:03<08:32, 170.79s/it]Task 4, Epoch 48/50 => Loss 0.421, Train_accy 89.17, Test_accy 86.33:  96%|█████████▌| 48/50 [2:15:03<05:41, 170.70s/it]Task 4, Epoch 49/50 => Loss 0.403, Train_accy 89.99, Test_accy 86.30:  96%|█████████▌| 48/50 [2:17:57<05:41, 170.70s/it]Task 4, Epoch 49/50 => Loss 0.403, Train_accy 89.99, Test_accy 86.30:  98%|█████████▊| 49/50 [2:17:57<02:51, 171.65s/it]Task 4, Epoch 50/50 => Loss 0.418, Train_accy 89.55, Test_accy 86.33:  98%|█████████▊| 49/50 [2:20:52<02:51, 171.65s/it]Task 4, Epoch 50/50 => Loss 0.418, Train_accy 89.55, Test_accy 86.33: 100%|██████████| 50/50 [2:20:52<00:00, 172.71s/it]Task 4, Epoch 50/50 => Loss 0.418, Train_accy 89.55, Test_accy 86.33: 100%|██████████| 50/50 [2:20:52<00:00, 169.05s/it]
2024-06-14 10:47:01,545 [lora_prompt.py] => Task 4, Epoch 50/50 => Loss 0.418, Train_accy 89.55, Test_accy 86.33
/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 10:59:15,328 [lora_prompt.py] => Exemplar size: 0
2024-06-14 10:59:15,329 [trainer.py] => CNN: {'total': 85.77, '00-49': 85.77, 'old': 85.77, 'new': nan}
2024-06-14 10:59:15,329 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76, 83.93, 85.77]
2024-06-14 10:59:15,336 [trainer.py] => All params: 840861697
2024-06-14 10:59:15,341 [trainer.py] => Trainable params: 204800
2024-06-14 10:59:15,341 [lora_prompt.py] => Learning on 250-300
Parameters to be updated: {'lora_image_model_pool.5.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'classifier_pool.5.ctx', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.5.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight'},count:204800
  0%|          | 0/50 [00:00<?, ?it/s]Task 5, Epoch 1/50 => Loss 2.128, Train_accy 29.13, Test_accy 47.36:   0%|          | 0/50 [02:58<?, ?it/s]Task 5, Epoch 1/50 => Loss 2.128, Train_accy 29.13, Test_accy 47.36:   2%|▏         | 1/50 [02:58<2:25:26, 178.08s/it]Task 5, Epoch 2/50 => Loss 1.465, Train_accy 57.62, Test_accy 62.93:   2%|▏         | 1/50 [05:54<2:25:26, 178.08s/it]Task 5, Epoch 2/50 => Loss 1.465, Train_accy 57.62, Test_accy 62.93:   4%|▍         | 2/50 [05:54<2:21:44, 177.17s/it]Task 5, Epoch 3/50 => Loss 1.149, Train_accy 68.64, Test_accy 70.74:   4%|▍         | 2/50 [08:55<2:21:44, 177.17s/it]Task 5, Epoch 3/50 => Loss 1.149, Train_accy 68.64, Test_accy 70.74:   6%|▌         | 3/50 [08:55<2:20:10, 178.95s/it]Task 5, Epoch 4/50 => Loss 1.040, Train_accy 72.37, Test_accy 75.53:   6%|▌         | 3/50 [11:55<2:20:10, 178.95s/it]Task 5, Epoch 4/50 => Loss 1.040, Train_accy 72.37, Test_accy 75.53:   8%|▊         | 4/50 [11:55<2:17:35, 179.47s/it]Task 5, Epoch 5/50 => Loss 0.980, Train_accy 73.95, Test_accy 76.11:   8%|▊         | 4/50 [14:59<2:17:35, 179.47s/it]Task 5, Epoch 5/50 => Loss 0.980, Train_accy 73.95, Test_accy 76.11:  10%|█         | 5/50 [14:59<2:15:43, 180.97s/it]Task 5, Epoch 6/50 => Loss 0.913, Train_accy 75.44, Test_accy 76.27:  10%|█         | 5/50 [17:59<2:15:43, 180.97s/it]Task 5, Epoch 6/50 => Loss 0.913, Train_accy 75.44, Test_accy 76.27:  12%|█▏        | 6/50 [17:59<2:12:34, 180.78s/it]Task 5, Epoch 7/50 => Loss 0.884, Train_accy 76.38, Test_accy 75.32:  12%|█▏        | 6/50 [21:01<2:12:34, 180.78s/it]Task 5, Epoch 7/50 => Loss 0.884, Train_accy 76.38, Test_accy 75.32:  14%|█▍        | 7/50 [21:01<2:09:45, 181.05s/it]Task 5, Epoch 8/50 => Loss 0.860, Train_accy 77.59, Test_accy 75.82:  14%|█▍        | 7/50 [24:03<2:09:45, 181.05s/it]Task 5, Epoch 8/50 => Loss 0.860, Train_accy 77.59, Test_accy 75.82:  16%|█▌        | 8/50 [24:03<2:06:56, 181.34s/it]Task 5, Epoch 9/50 => Loss 0.837, Train_accy 77.94, Test_accy 75.99:  16%|█▌        | 8/50 [27:05<2:06:56, 181.34s/it]Task 5, Epoch 9/50 => Loss 0.837, Train_accy 77.94, Test_accy 75.99:  18%|█▊        | 9/50 [27:05<2:04:07, 181.65s/it]Task 5, Epoch 10/50 => Loss 0.802, Train_accy 78.68, Test_accy 73.30:  18%|█▊        | 9/50 [30:06<2:04:07, 181.65s/it]Task 5, Epoch 10/50 => Loss 0.802, Train_accy 78.68, Test_accy 73.30:  20%|██        | 10/50 [30:06<2:00:48, 181.21s/it]Task 5, Epoch 11/50 => Loss 0.802, Train_accy 78.83, Test_accy 76.38:  20%|██        | 10/50 [33:06<2:00:48, 181.21s/it]Task 5, Epoch 11/50 => Loss 0.802, Train_accy 78.83, Test_accy 76.38:  22%|██▏       | 11/50 [33:06<1:57:35, 180.91s/it]Task 5, Epoch 12/50 => Loss 0.765, Train_accy 80.01, Test_accy 79.04:  22%|██▏       | 11/50 [36:06<1:57:35, 180.91s/it]Task 5, Epoch 12/50 => Loss 0.765, Train_accy 80.01, Test_accy 79.04:  24%|██▍       | 12/50 [36:06<1:54:25, 180.68s/it]Task 5, Epoch 13/50 => Loss 0.771, Train_accy 79.34, Test_accy 75.40:  24%|██▍       | 12/50 [39:04<1:54:25, 180.68s/it]Task 5, Epoch 13/50 => Loss 0.771, Train_accy 79.34, Test_accy 75.40:  26%|██▌       | 13/50 [39:04<1:51:00, 180.01s/it]Task 5, Epoch 14/50 => Loss 0.761, Train_accy 80.23, Test_accy 76.91:  26%|██▌       | 13/50 [42:00<1:51:00, 180.01s/it]Task 5, Epoch 14/50 => Loss 0.761, Train_accy 80.23, Test_accy 76.91:  28%|██▊       | 14/50 [42:00<1:47:13, 178.71s/it]Task 5, Epoch 15/50 => Loss 0.739, Train_accy 80.78, Test_accy 78.15:  28%|██▊       | 14/50 [44:57<1:47:13, 178.71s/it]Task 5, Epoch 15/50 => Loss 0.739, Train_accy 80.78, Test_accy 78.15:  30%|███       | 15/50 [44:57<1:43:57, 178.22s/it]Task 5, Epoch 16/50 => Loss 0.739, Train_accy 80.49, Test_accy 79.80:  30%|███       | 15/50 [47:55<1:43:57, 178.22s/it]Task 5, Epoch 16/50 => Loss 0.739, Train_accy 80.49, Test_accy 79.80:  32%|███▏      | 16/50 [47:55<1:40:52, 178.01s/it]Task 5, Epoch 17/50 => Loss 0.739, Train_accy 80.27, Test_accy 78.08:  32%|███▏      | 16/50 [50:54<1:40:52, 178.01s/it]Task 5, Epoch 17/50 => Loss 0.739, Train_accy 80.27, Test_accy 78.08:  34%|███▍      | 17/50 [50:54<1:38:07, 178.40s/it]Task 5, Epoch 18/50 => Loss 0.713, Train_accy 81.51, Test_accy 79.40:  34%|███▍      | 17/50 [53:53<1:38:07, 178.40s/it]Task 5, Epoch 18/50 => Loss 0.713, Train_accy 81.51, Test_accy 79.40:  36%|███▌      | 18/50 [53:53<1:35:12, 178.51s/it]Task 5, Epoch 19/50 => Loss 0.702, Train_accy 81.97, Test_accy 80.20:  36%|███▌      | 18/50 [56:51<1:35:12, 178.51s/it]Task 5, Epoch 19/50 => Loss 0.702, Train_accy 81.97, Test_accy 80.20:  38%|███▊      | 19/50 [56:51<1:32:10, 178.39s/it]Task 5, Epoch 20/50 => Loss 0.705, Train_accy 81.68, Test_accy 76.87:  38%|███▊      | 19/50 [59:50<1:32:10, 178.39s/it]Task 5, Epoch 20/50 => Loss 0.705, Train_accy 81.68, Test_accy 76.87:  40%|████      | 20/50 [59:50<1:29:14, 178.50s/it]Task 5, Epoch 21/50 => Loss 0.706, Train_accy 81.24, Test_accy 79.88:  40%|████      | 20/50 [1:02:47<1:29:14, 178.50s/it]Task 5, Epoch 21/50 => Loss 0.706, Train_accy 81.24, Test_accy 79.88:  42%|████▏     | 21/50 [1:02:47<1:26:04, 178.10s/it]Task 5, Epoch 22/50 => Loss 0.706, Train_accy 82.10, Test_accy 79.84:  42%|████▏     | 21/50 [1:05:44<1:26:04, 178.10s/it]Task 5, Epoch 22/50 => Loss 0.706, Train_accy 82.10, Test_accy 79.84:  44%|████▍     | 22/50 [1:05:44<1:23:02, 177.95s/it]Task 5, Epoch 23/50 => Loss 0.690, Train_accy 82.00, Test_accy 79.63:  44%|████▍     | 22/50 [1:08:42<1:23:02, 177.95s/it]Task 5, Epoch 23/50 => Loss 0.690, Train_accy 82.00, Test_accy 79.63:  46%|████▌     | 23/50 [1:08:42<1:20:01, 177.83s/it]Task 5, Epoch 24/50 => Loss 0.677, Train_accy 82.21, Test_accy 80.49:  46%|████▌     | 23/50 [1:11:41<1:20:01, 177.83s/it]Task 5, Epoch 24/50 => Loss 0.677, Train_accy 82.21, Test_accy 80.49:  48%|████▊     | 24/50 [1:11:41<1:17:12, 178.18s/it]Task 5, Epoch 25/50 => Loss 0.682, Train_accy 82.13, Test_accy 79.16:  48%|████▊     | 24/50 [1:14:39<1:17:12, 178.18s/it]Task 5, Epoch 25/50 => Loss 0.682, Train_accy 82.13, Test_accy 79.16:  50%|█████     | 25/50 [1:14:39<1:14:13, 178.14s/it]Task 5, Epoch 26/50 => Loss 0.668, Train_accy 82.57, Test_accy 78.94:  50%|█████     | 25/50 [1:17:38<1:14:13, 178.14s/it]Task 5, Epoch 26/50 => Loss 0.668, Train_accy 82.57, Test_accy 78.94:  52%|█████▏    | 26/50 [1:17:38<1:11:20, 178.36s/it]Task 5, Epoch 27/50 => Loss 0.659, Train_accy 82.77, Test_accy 80.25:  52%|█████▏    | 26/50 [1:20:37<1:11:20, 178.36s/it]Task 5, Epoch 27/50 => Loss 0.659, Train_accy 82.77, Test_accy 80.25:  54%|█████▍    | 27/50 [1:20:37<1:08:27, 178.59s/it]Task 5, Epoch 28/50 => Loss 0.673, Train_accy 82.46, Test_accy 80.24:  54%|█████▍    | 27/50 [1:23:37<1:08:27, 178.59s/it]Task 5, Epoch 28/50 => Loss 0.673, Train_accy 82.46, Test_accy 80.24:  56%|█████▌    | 28/50 [1:23:37<1:05:35, 178.86s/it]Task 5, Epoch 29/50 => Loss 0.658, Train_accy 82.68, Test_accy 80.63:  56%|█████▌    | 28/50 [1:26:35<1:05:35, 178.86s/it]Task 5, Epoch 29/50 => Loss 0.658, Train_accy 82.68, Test_accy 80.63:  58%|█████▊    | 29/50 [1:26:35<1:02:31, 178.63s/it]Task 5, Epoch 30/50 => Loss 0.643, Train_accy 82.91, Test_accy 80.02:  58%|█████▊    | 29/50 [1:29:33<1:02:31, 178.63s/it]Task 5, Epoch 30/50 => Loss 0.643, Train_accy 82.91, Test_accy 80.02:  60%|██████    | 30/50 [1:29:33<59:31, 178.59s/it]  Task 5, Epoch 31/50 => Loss 0.649, Train_accy 83.09, Test_accy 81.16:  60%|██████    | 30/50 [1:32:32<59:31, 178.59s/it]Task 5, Epoch 31/50 => Loss 0.649, Train_accy 83.09, Test_accy 81.16:  62%|██████▏   | 31/50 [1:32:32<56:35, 178.69s/it]Task 5, Epoch 32/50 => Loss 0.635, Train_accy 83.67, Test_accy 80.06:  62%|██████▏   | 31/50 [1:35:29<56:35, 178.69s/it]Task 5, Epoch 32/50 => Loss 0.635, Train_accy 83.67, Test_accy 80.06:  64%|██████▍   | 32/50 [1:35:29<53:28, 178.25s/it]Task 5, Epoch 33/50 => Loss 0.640, Train_accy 83.45, Test_accy 80.59:  64%|██████▍   | 32/50 [1:38:27<53:28, 178.25s/it]Task 5, Epoch 33/50 => Loss 0.640, Train_accy 83.45, Test_accy 80.59:  66%|██████▌   | 33/50 [1:38:27<50:29, 178.19s/it]Task 5, Epoch 34/50 => Loss 0.620, Train_accy 83.88, Test_accy 81.21:  66%|██████▌   | 33/50 [1:41:25<50:29, 178.19s/it]Task 5, Epoch 34/50 => Loss 0.620, Train_accy 83.88, Test_accy 81.21:  68%|██████▊   | 34/50 [1:41:25<47:26, 177.92s/it]Task 5, Epoch 35/50 => Loss 0.625, Train_accy 83.73, Test_accy 80.88:  68%|██████▊   | 34/50 [1:44:23<47:26, 177.92s/it]Task 5, Epoch 35/50 => Loss 0.625, Train_accy 83.73, Test_accy 80.88:  70%|███████   | 35/50 [1:44:23<44:31, 178.07s/it]Task 5, Epoch 36/50 => Loss 0.629, Train_accy 83.72, Test_accy 81.28:  70%|███████   | 35/50 [1:47:19<44:31, 178.07s/it]Task 5, Epoch 36/50 => Loss 0.629, Train_accy 83.72, Test_accy 81.28:  72%|███████▏  | 36/50 [1:47:19<41:26, 177.58s/it]Task 5, Epoch 37/50 => Loss 0.613, Train_accy 84.16, Test_accy 80.83:  72%|███████▏  | 36/50 [1:50:14<41:26, 177.58s/it]Task 5, Epoch 37/50 => Loss 0.613, Train_accy 84.16, Test_accy 80.83:  74%|███████▍  | 37/50 [1:50:14<38:18, 176.77s/it]Task 5, Epoch 38/50 => Loss 0.612, Train_accy 84.45, Test_accy 81.15:  74%|███████▍  | 37/50 [1:53:07<38:18, 176.77s/it]Task 5, Epoch 38/50 => Loss 0.612, Train_accy 84.45, Test_accy 81.15:  76%|███████▌  | 38/50 [1:53:07<35:05, 175.50s/it]Task 5, Epoch 39/50 => Loss 0.607, Train_accy 84.47, Test_accy 81.13:  76%|███████▌  | 38/50 [1:56:03<35:05, 175.50s/it]Task 5, Epoch 39/50 => Loss 0.607, Train_accy 84.47, Test_accy 81.13:  78%|███████▊  | 39/50 [1:56:03<32:12, 175.69s/it]Task 5, Epoch 40/50 => Loss 0.621, Train_accy 84.02, Test_accy 81.63:  78%|███████▊  | 39/50 [1:58:59<32:12, 175.69s/it]Task 5, Epoch 40/50 => Loss 0.621, Train_accy 84.02, Test_accy 81.63:  80%|████████  | 40/50 [1:58:59<29:17, 175.76s/it]Task 5, Epoch 41/50 => Loss 0.602, Train_accy 84.44, Test_accy 81.61:  80%|████████  | 40/50 [2:01:56<29:17, 175.76s/it]Task 5, Epoch 41/50 => Loss 0.602, Train_accy 84.44, Test_accy 81.61:  82%|████████▏ | 41/50 [2:01:56<26:24, 176.11s/it]Task 5, Epoch 42/50 => Loss 0.594, Train_accy 84.40, Test_accy 80.70:  82%|████████▏ | 41/50 [2:04:54<26:24, 176.11s/it]Task 5, Epoch 42/50 => Loss 0.594, Train_accy 84.40, Test_accy 80.70:  84%|████████▍ | 42/50 [2:04:54<23:32, 176.56s/it]Task 5, Epoch 43/50 => Loss 0.608, Train_accy 84.37, Test_accy 81.35:  84%|████████▍ | 42/50 [2:07:49<23:32, 176.56s/it]Task 5, Epoch 43/50 => Loss 0.608, Train_accy 84.37, Test_accy 81.35:  86%|████████▌ | 43/50 [2:07:49<20:34, 176.33s/it]Task 5, Epoch 44/50 => Loss 0.594, Train_accy 84.52, Test_accy 81.31:  86%|████████▌ | 43/50 [2:10:40<20:34, 176.33s/it]Task 5, Epoch 44/50 => Loss 0.594, Train_accy 84.52, Test_accy 81.31:  88%|████████▊ | 44/50 [2:10:40<17:28, 174.78s/it]Task 5, Epoch 45/50 => Loss 0.592, Train_accy 85.02, Test_accy 81.80:  88%|████████▊ | 44/50 [2:13:34<17:28, 174.78s/it]Task 5, Epoch 45/50 => Loss 0.592, Train_accy 85.02, Test_accy 81.80:  90%|█████████ | 45/50 [2:13:34<14:31, 174.30s/it]Task 5, Epoch 46/50 => Loss 0.602, Train_accy 84.62, Test_accy 81.82:  90%|█████████ | 45/50 [2:16:27<14:31, 174.30s/it]Task 5, Epoch 46/50 => Loss 0.602, Train_accy 84.62, Test_accy 81.82:  92%|█████████▏| 46/50 [2:16:27<11:35, 173.90s/it]Task 5, Epoch 47/50 => Loss 0.570, Train_accy 85.52, Test_accy 81.77:  92%|█████████▏| 46/50 [2:19:23<11:35, 173.90s/it]Task 5, Epoch 47/50 => Loss 0.570, Train_accy 85.52, Test_accy 81.77:  94%|█████████▍| 47/50 [2:19:23<08:43, 174.56s/it]Task 5, Epoch 48/50 => Loss 0.605, Train_accy 84.46, Test_accy 81.81:  94%|█████████▍| 47/50 [2:22:18<08:43, 174.56s/it]Task 5, Epoch 48/50 => Loss 0.605, Train_accy 84.46, Test_accy 81.81:  96%|█████████▌| 48/50 [2:22:18<05:49, 174.81s/it]Task 5, Epoch 49/50 => Loss 0.582, Train_accy 85.02, Test_accy 81.82:  96%|█████████▌| 48/50 [2:25:13<05:49, 174.81s/it]Task 5, Epoch 49/50 => Loss 0.582, Train_accy 85.02, Test_accy 81.82:  98%|█████████▊| 49/50 [2:25:13<02:54, 174.97s/it]Task 5, Epoch 50/50 => Loss 0.603, Train_accy 84.54, Test_accy 81.89:  98%|█████████▊| 49/50 [2:28:08<02:54, 174.97s/it]Task 5, Epoch 50/50 => Loss 0.603, Train_accy 84.54, Test_accy 81.89: 100%|██████████| 50/50 [2:28:08<00:00, 174.84s/it]Task 5, Epoch 50/50 => Loss 0.603, Train_accy 84.54, Test_accy 81.89: 100%|██████████| 50/50 [2:28:08<00:00, 177.77s/it]
2024-06-14 13:27:26,572 [lora_prompt.py] => Task 5, Epoch 50/50 => Loss 0.603, Train_accy 84.54, Test_accy 81.89
/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 13:39:17,658 [lora_prompt.py] => Exemplar size: 0
2024-06-14 13:39:17,659 [trainer.py] => CNN: {'total': 85.78, '00-49': 85.78, 'old': 85.78, 'new': nan}
2024-06-14 13:39:17,659 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76, 83.93, 85.77, 85.78]
2024-06-14 13:39:17,666 [trainer.py] => All params: 840861697
2024-06-14 13:39:17,671 [trainer.py] => Trainable params: 204800
2024-06-14 13:39:17,672 [lora_prompt.py] => Learning on 300-350
Parameters to be updated: {'lora_image_model_pool.6.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'classifier_pool.6.ctx', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.6.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight'},count:204800
  0%|          | 0/50 [00:00<?, ?it/s]Task 6, Epoch 1/50 => Loss 2.099, Train_accy 24.05, Test_accy 38.17:   0%|          | 0/50 [02:54<?, ?it/s]Task 6, Epoch 1/50 => Loss 2.099, Train_accy 24.05, Test_accy 38.17:   2%|▏         | 1/50 [02:54<2:22:38, 174.67s/it]Task 6, Epoch 2/50 => Loss 1.452, Train_accy 55.11, Test_accy 62.42:   2%|▏         | 1/50 [05:49<2:22:38, 174.67s/it]Task 6, Epoch 2/50 => Loss 1.452, Train_accy 55.11, Test_accy 62.42:   4%|▍         | 2/50 [05:49<2:19:39, 174.56s/it]Task 6, Epoch 3/50 => Loss 0.998, Train_accy 73.16, Test_accy 70.71:   4%|▍         | 2/50 [08:43<2:19:39, 174.56s/it]Task 6, Epoch 3/50 => Loss 0.998, Train_accy 73.16, Test_accy 70.71:   6%|▌         | 3/50 [08:43<2:16:29, 174.24s/it]Task 6, Epoch 4/50 => Loss 0.880, Train_accy 77.46, Test_accy 69.42:   6%|▌         | 3/50 [11:36<2:16:29, 174.24s/it]Task 6, Epoch 4/50 => Loss 0.880, Train_accy 77.46, Test_accy 69.42:   8%|▊         | 4/50 [11:36<2:13:12, 173.76s/it]Task 6, Epoch 5/50 => Loss 0.810, Train_accy 79.26, Test_accy 73.22:   8%|▊         | 4/50 [14:29<2:13:12, 173.76s/it]Task 6, Epoch 5/50 => Loss 0.810, Train_accy 79.26, Test_accy 73.22:  10%|█         | 5/50 [14:29<2:10:22, 173.83s/it]Task 6, Epoch 6/50 => Loss 0.758, Train_accy 80.65, Test_accy 74.05:  10%|█         | 5/50 [17:21<2:10:22, 173.83s/it]Task 6, Epoch 6/50 => Loss 0.758, Train_accy 80.65, Test_accy 74.05:  12%|█▏        | 6/50 [17:21<2:06:48, 172.93s/it]Task 6, Epoch 7/50 => Loss 0.712, Train_accy 82.24, Test_accy 77.10:  12%|█▏        | 6/50 [20:16<2:06:48, 172.93s/it]Task 6, Epoch 7/50 => Loss 0.712, Train_accy 82.24, Test_accy 77.10:  14%|█▍        | 7/50 [20:16<2:04:31, 173.75s/it]Task 6, Epoch 8/50 => Loss 0.688, Train_accy 82.91, Test_accy 75.39:  14%|█▍        | 7/50 [23:11<2:04:31, 173.75s/it]Task 6, Epoch 8/50 => Loss 0.688, Train_accy 82.91, Test_accy 75.39:  16%|█▌        | 8/50 [23:11<2:01:47, 174.00s/it]Task 6, Epoch 9/50 => Loss 0.683, Train_accy 82.79, Test_accy 75.09:  16%|█▌        | 8/50 [26:05<2:01:47, 174.00s/it]Task 6, Epoch 9/50 => Loss 0.683, Train_accy 82.79, Test_accy 75.09:  18%|█▊        | 9/50 [26:05<1:58:53, 173.99s/it]Task 6, Epoch 10/50 => Loss 0.660, Train_accy 83.72, Test_accy 74.78:  18%|█▊        | 9/50 [28:59<1:58:53, 173.99s/it]Task 6, Epoch 10/50 => Loss 0.660, Train_accy 83.72, Test_accy 74.78:  20%|██        | 10/50 [28:59<1:55:59, 173.99s/it]Task 6, Epoch 11/50 => Loss 0.640, Train_accy 84.10, Test_accy 75.83:  20%|██        | 10/50 [31:52<1:55:59, 173.99s/it]Task 6, Epoch 11/50 => Loss 0.640, Train_accy 84.10, Test_accy 75.83:  22%|██▏       | 11/50 [31:52<1:53:00, 173.85s/it]Task 6, Epoch 12/50 => Loss 0.637, Train_accy 84.30, Test_accy 78.20:  22%|██▏       | 11/50 [34:42<1:53:00, 173.85s/it]Task 6, Epoch 12/50 => Loss 0.637, Train_accy 84.30, Test_accy 78.20:  24%|██▍       | 12/50 [34:42<1:49:22, 172.70s/it]Task 6, Epoch 13/50 => Loss 0.630, Train_accy 84.47, Test_accy 79.01:  24%|██▍       | 12/50 [37:35<1:49:22, 172.70s/it]Task 6, Epoch 13/50 => Loss 0.630, Train_accy 84.47, Test_accy 79.01:  26%|██▌       | 13/50 [37:35<1:46:31, 172.74s/it]Task 6, Epoch 14/50 => Loss 0.605, Train_accy 85.07, Test_accy 77.65:  26%|██▌       | 13/50 [40:28<1:46:31, 172.74s/it]Task 6, Epoch 14/50 => Loss 0.605, Train_accy 85.07, Test_accy 77.65:  28%|██▊       | 14/50 [40:28<1:43:40, 172.79s/it]Task 6, Epoch 15/50 => Loss 0.598, Train_accy 85.42, Test_accy 79.32:  28%|██▊       | 14/50 [43:22<1:43:40, 172.79s/it]Task 6, Epoch 15/50 => Loss 0.598, Train_accy 85.42, Test_accy 79.32:  30%|███       | 15/50 [43:22<1:41:03, 173.24s/it]Task 6, Epoch 16/50 => Loss 0.598, Train_accy 85.39, Test_accy 77.76:  30%|███       | 15/50 [46:19<1:41:03, 173.24s/it]Task 6, Epoch 16/50 => Loss 0.598, Train_accy 85.39, Test_accy 77.76:  32%|███▏      | 16/50 [46:19<1:38:44, 174.26s/it]Task 6, Epoch 17/50 => Loss 0.584, Train_accy 85.63, Test_accy 80.12:  32%|███▏      | 16/50 [49:13<1:38:44, 174.26s/it]Task 6, Epoch 17/50 => Loss 0.584, Train_accy 85.63, Test_accy 80.12:  34%|███▍      | 17/50 [49:13<1:35:51, 174.28s/it]Task 6, Epoch 18/50 => Loss 0.595, Train_accy 85.56, Test_accy 79.15:  34%|███▍      | 17/50 [52:07<1:35:51, 174.28s/it]Task 6, Epoch 18/50 => Loss 0.595, Train_accy 85.56, Test_accy 79.15:  36%|███▌      | 18/50 [52:07<1:32:48, 174.03s/it]Task 6, Epoch 19/50 => Loss 0.561, Train_accy 86.24, Test_accy 77.28:  36%|███▌      | 18/50 [55:01<1:32:48, 174.03s/it]Task 6, Epoch 19/50 => Loss 0.561, Train_accy 86.24, Test_accy 77.28:  38%|███▊      | 19/50 [55:01<1:29:53, 173.99s/it]Task 6, Epoch 20/50 => Loss 0.576, Train_accy 85.84, Test_accy 78.40:  38%|███▊      | 19/50 [57:52<1:29:53, 173.99s/it]Task 6, Epoch 20/50 => Loss 0.576, Train_accy 85.84, Test_accy 78.40:  40%|████      | 20/50 [57:52<1:26:37, 173.25s/it]Task 6, Epoch 21/50 => Loss 0.579, Train_accy 86.02, Test_accy 79.44:  40%|████      | 20/50 [1:00:42<1:26:37, 173.25s/it]Task 6, Epoch 21/50 => Loss 0.579, Train_accy 86.02, Test_accy 79.44:  42%|████▏     | 21/50 [1:00:42<1:23:16, 172.29s/it]Task 6, Epoch 22/50 => Loss 0.547, Train_accy 86.68, Test_accy 79.38:  42%|████▏     | 21/50 [1:03:35<1:23:16, 172.29s/it]Task 6, Epoch 22/50 => Loss 0.547, Train_accy 86.68, Test_accy 79.38:  44%|████▍     | 22/50 [1:03:35<1:20:33, 172.61s/it]Task 6, Epoch 23/50 => Loss 0.524, Train_accy 87.10, Test_accy 79.91:  44%|████▍     | 22/50 [1:06:33<1:20:33, 172.61s/it]Task 6, Epoch 23/50 => Loss 0.524, Train_accy 87.10, Test_accy 79.91:  46%|████▌     | 23/50 [1:06:33<1:18:19, 174.06s/it]Task 6, Epoch 24/50 => Loss 0.544, Train_accy 86.54, Test_accy 79.21:  46%|████▌     | 23/50 [1:09:28<1:18:19, 174.06s/it]Task 6, Epoch 24/50 => Loss 0.544, Train_accy 86.54, Test_accy 79.21:  48%|████▊     | 24/50 [1:09:28<1:15:33, 174.35s/it]Task 6, Epoch 25/50 => Loss 0.559, Train_accy 86.38, Test_accy 79.55:  48%|████▊     | 24/50 [1:12:22<1:15:33, 174.35s/it]Task 6, Epoch 25/50 => Loss 0.559, Train_accy 86.38, Test_accy 79.55:  50%|█████     | 25/50 [1:12:22<1:12:33, 174.13s/it]Task 6, Epoch 26/50 => Loss 0.554, Train_accy 86.12, Test_accy 79.91:  50%|█████     | 25/50 [1:15:15<1:12:33, 174.13s/it]Task 6, Epoch 26/50 => Loss 0.554, Train_accy 86.12, Test_accy 79.91:  52%|█████▏    | 26/50 [1:15:15<1:09:36, 174.04s/it]Task 6, Epoch 27/50 => Loss 0.529, Train_accy 86.91, Test_accy 78.76:  52%|█████▏    | 26/50 [1:18:04<1:09:36, 174.04s/it]Task 6, Epoch 27/50 => Loss 0.529, Train_accy 86.91, Test_accy 78.76:  54%|█████▍    | 27/50 [1:18:04<1:06:05, 172.42s/it]Task 6, Epoch 28/50 => Loss 0.537, Train_accy 86.66, Test_accy 79.82:  54%|█████▍    | 27/50 [1:20:54<1:06:05, 172.42s/it]Task 6, Epoch 28/50 => Loss 0.537, Train_accy 86.66, Test_accy 79.82:  56%|█████▌    | 28/50 [1:20:54<1:02:57, 171.70s/it]Task 6, Epoch 29/50 => Loss 0.532, Train_accy 86.98, Test_accy 80.01:  56%|█████▌    | 28/50 [1:23:45<1:02:57, 171.70s/it]Task 6, Epoch 29/50 => Loss 0.532, Train_accy 86.98, Test_accy 80.01:  58%|█████▊    | 29/50 [1:23:45<59:58, 171.35s/it]  Task 6, Epoch 30/50 => Loss 0.522, Train_accy 87.22, Test_accy 79.97:  58%|█████▊    | 29/50 [1:26:39<59:58, 171.35s/it]Task 6, Epoch 30/50 => Loss 0.522, Train_accy 87.22, Test_accy 79.97:  60%|██████    | 30/50 [1:26:39<57:22, 172.13s/it]Task 6, Epoch 31/50 => Loss 0.528, Train_accy 87.12, Test_accy 80.21:  60%|██████    | 30/50 [1:29:34<57:22, 172.13s/it]Task 6, Epoch 31/50 => Loss 0.528, Train_accy 87.12, Test_accy 80.21:  62%|██████▏   | 31/50 [1:29:34<54:49, 173.15s/it]Task 6, Epoch 32/50 => Loss 0.525, Train_accy 87.33, Test_accy 80.29:  62%|██████▏   | 31/50 [1:32:29<54:49, 173.15s/it]Task 6, Epoch 32/50 => Loss 0.525, Train_accy 87.33, Test_accy 80.29:  64%|██████▍   | 32/50 [1:32:29<52:04, 173.57s/it]Task 6, Epoch 33/50 => Loss 0.517, Train_accy 87.32, Test_accy 80.42:  64%|██████▍   | 32/50 [1:35:24<52:04, 173.57s/it]Task 6, Epoch 33/50 => Loss 0.517, Train_accy 87.32, Test_accy 80.42:  66%|██████▌   | 33/50 [1:35:24<49:17, 174.00s/it]Task 6, Epoch 34/50 => Loss 0.503, Train_accy 87.40, Test_accy 79.86:  66%|██████▌   | 33/50 [1:38:18<49:17, 174.00s/it]Task 6, Epoch 34/50 => Loss 0.503, Train_accy 87.40, Test_accy 79.86:  68%|██████▊   | 34/50 [1:38:18<46:27, 174.19s/it]Task 6, Epoch 35/50 => Loss 0.511, Train_accy 87.53, Test_accy 80.56:  68%|██████▊   | 34/50 [1:41:11<46:27, 174.19s/it]Task 6, Epoch 35/50 => Loss 0.511, Train_accy 87.53, Test_accy 80.56:  70%|███████   | 35/50 [1:41:11<43:24, 173.63s/it]Task 6, Epoch 36/50 => Loss 0.500, Train_accy 88.06, Test_accy 80.26:  70%|███████   | 35/50 [1:44:05<43:24, 173.63s/it]Task 6, Epoch 36/50 => Loss 0.500, Train_accy 88.06, Test_accy 80.26:  72%|███████▏  | 36/50 [1:44:05<40:32, 173.74s/it]Task 6, Epoch 37/50 => Loss 0.499, Train_accy 87.71, Test_accy 80.11:  72%|███████▏  | 36/50 [1:47:00<40:32, 173.74s/it]Task 6, Epoch 37/50 => Loss 0.499, Train_accy 87.71, Test_accy 80.11:  74%|███████▍  | 37/50 [1:47:00<37:46, 174.37s/it]Task 6, Epoch 38/50 => Loss 0.504, Train_accy 87.79, Test_accy 79.74:  74%|███████▍  | 37/50 [1:49:57<37:46, 174.37s/it]Task 6, Epoch 38/50 => Loss 0.504, Train_accy 87.79, Test_accy 79.74:  76%|███████▌  | 38/50 [1:49:57<34:59, 174.92s/it]Task 6, Epoch 39/50 => Loss 0.507, Train_accy 87.59, Test_accy 80.22:  76%|███████▌  | 38/50 [1:52:51<34:59, 174.92s/it]Task 6, Epoch 39/50 => Loss 0.507, Train_accy 87.59, Test_accy 80.22:  78%|███████▊  | 39/50 [1:52:51<32:01, 174.70s/it]Task 6, Epoch 40/50 => Loss 0.487, Train_accy 88.25, Test_accy 80.17:  78%|███████▊  | 39/50 [1:55:46<32:01, 174.70s/it]Task 6, Epoch 40/50 => Loss 0.487, Train_accy 88.25, Test_accy 80.17:  80%|████████  | 40/50 [1:55:46<29:08, 174.85s/it]Task 6, Epoch 41/50 => Loss 0.479, Train_accy 88.31, Test_accy 80.52:  80%|████████  | 40/50 [1:58:40<29:08, 174.85s/it]Task 6, Epoch 41/50 => Loss 0.479, Train_accy 88.31, Test_accy 80.52:  82%|████████▏ | 41/50 [1:58:40<26:11, 174.60s/it]Task 6, Epoch 42/50 => Loss 0.476, Train_accy 88.46, Test_accy 80.08:  82%|████████▏ | 41/50 [2:01:33<26:11, 174.60s/it]Task 6, Epoch 42/50 => Loss 0.476, Train_accy 88.46, Test_accy 80.08:  84%|████████▍ | 42/50 [2:01:33<23:11, 173.97s/it]Task 6, Epoch 43/50 => Loss 0.490, Train_accy 88.32, Test_accy 80.45:  84%|████████▍ | 42/50 [2:04:28<23:11, 173.97s/it]Task 6, Epoch 43/50 => Loss 0.490, Train_accy 88.32, Test_accy 80.45:  86%|████████▌ | 43/50 [2:04:28<20:21, 174.50s/it]Task 6, Epoch 44/50 => Loss 0.465, Train_accy 88.74, Test_accy 80.19:  86%|████████▌ | 43/50 [2:07:21<20:21, 174.50s/it]Task 6, Epoch 44/50 => Loss 0.465, Train_accy 88.74, Test_accy 80.19:  88%|████████▊ | 44/50 [2:07:21<17:24, 174.04s/it]Task 6, Epoch 45/50 => Loss 0.490, Train_accy 88.36, Test_accy 80.25:  88%|████████▊ | 44/50 [2:10:16<17:24, 174.04s/it]Task 6, Epoch 45/50 => Loss 0.490, Train_accy 88.36, Test_accy 80.25:  90%|█████████ | 45/50 [2:10:16<14:31, 174.24s/it]Task 6, Epoch 46/50 => Loss 0.471, Train_accy 88.47, Test_accy 80.46:  90%|█████████ | 45/50 [2:13:14<14:31, 174.24s/it]Task 6, Epoch 46/50 => Loss 0.471, Train_accy 88.47, Test_accy 80.46:  92%|█████████▏| 46/50 [2:13:14<11:41, 175.30s/it]Task 6, Epoch 47/50 => Loss 0.488, Train_accy 88.65, Test_accy 80.44:  92%|█████████▏| 46/50 [2:16:08<11:41, 175.30s/it]Task 6, Epoch 47/50 => Loss 0.488, Train_accy 88.65, Test_accy 80.44:  94%|█████████▍| 47/50 [2:16:08<08:45, 175.02s/it]Task 6, Epoch 48/50 => Loss 0.477, Train_accy 88.31, Test_accy 80.36:  94%|█████████▍| 47/50 [2:19:02<08:45, 175.02s/it]Task 6, Epoch 48/50 => Loss 0.477, Train_accy 88.31, Test_accy 80.36:  96%|█████████▌| 48/50 [2:19:02<05:49, 174.80s/it]Task 6, Epoch 49/50 => Loss 0.480, Train_accy 88.46, Test_accy 80.38:  96%|█████████▌| 48/50 [2:21:59<05:49, 174.80s/it]Task 6, Epoch 49/50 => Loss 0.480, Train_accy 88.46, Test_accy 80.38:  98%|█████████▊| 49/50 [2:21:59<02:55, 175.22s/it]Task 6, Epoch 50/50 => Loss 0.486, Train_accy 88.29, Test_accy 80.39:  98%|█████████▊| 49/50 [2:24:51<02:55, 175.22s/it]Task 6, Epoch 50/50 => Loss 0.486, Train_accy 88.29, Test_accy 80.39: 100%|██████████| 50/50 [2:24:51<00:00, 174.34s/it]Task 6, Epoch 50/50 => Loss 0.486, Train_accy 88.29, Test_accy 80.39: 100%|██████████| 50/50 [2:24:51<00:00, 173.83s/it]
2024-06-14 16:04:11,791 [lora_prompt.py] => Task 6, Epoch 50/50 => Loss 0.486, Train_accy 88.29, Test_accy 80.39
/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 16:16:26,712 [lora_prompt.py] => Exemplar size: 0
2024-06-14 16:16:26,712 [trainer.py] => CNN: {'total': 85.69, '00-49': 85.69, 'old': 85.69, 'new': nan}
2024-06-14 16:16:26,712 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76, 83.93, 85.77, 85.78, 85.69]
2024-06-14 16:16:26,719 [trainer.py] => All params: 840861697
2024-06-14 16:16:26,724 [trainer.py] => Trainable params: 204800
2024-06-14 16:16:26,725 [lora_prompt.py] => Learning on 350-400
Parameters to be updated: {'lora_image_model_pool.7.base_model.model.transformer.resblocks.4.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.1.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.0.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.2.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.3.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.5.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.7.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.1.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.4.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.10.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.3.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.10.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.8.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.5.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.7.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.8.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.2.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.9.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.6.attn.out_proj.lora_B.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.9.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.0.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.6.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.11.attn.out_proj.lora_A.weight', 'lora_image_model_pool.7.base_model.model.transformer.resblocks.11.attn.out_proj.lora_B.weight', 'classifier_pool.7.ctx'},count:204800
  0%|          | 0/50 [00:00<?, ?it/s]Task 7, Epoch 1/50 => Loss 2.102, Train_accy 22.72, Test_accy 33.92:   0%|          | 0/50 [02:53<?, ?it/s]Task 7, Epoch 1/50 => Loss 2.102, Train_accy 22.72, Test_accy 33.92:   2%|▏         | 1/50 [02:53<2:21:41, 173.50s/it]Task 7, Epoch 2/50 => Loss 1.584, Train_accy 50.33, Test_accy 60.67:   2%|▏         | 1/50 [05:46<2:21:41, 173.50s/it]Task 7, Epoch 2/50 => Loss 1.584, Train_accy 50.33, Test_accy 60.67:   4%|▍         | 2/50 [05:46<2:18:21, 172.94s/it]Task 7, Epoch 3/50 => Loss 1.175, Train_accy 67.53, Test_accy 69.71:   4%|▍         | 2/50 [08:38<2:18:21, 172.94s/it]Task 7, Epoch 3/50 => Loss 1.175, Train_accy 67.53, Test_accy 69.71:   6%|▌         | 3/50 [08:38<2:15:20, 172.79s/it]Task 7, Epoch 4/50 => Loss 0.977, Train_accy 74.01, Test_accy 77.33:   6%|▌         | 3/50 [11:33<2:15:20, 172.79s/it]Task 7, Epoch 4/50 => Loss 0.977, Train_accy 74.01, Test_accy 77.33:   8%|▊         | 4/50 [11:33<2:13:13, 173.76s/it]Task 7, Epoch 5/50 => Loss 0.863, Train_accy 76.70, Test_accy 78.88:   8%|▊         | 4/50 [14:32<2:13:13, 173.76s/it]Task 7, Epoch 5/50 => Loss 0.863, Train_accy 76.70, Test_accy 78.88:  10%|█         | 5/50 [14:32<2:11:42, 175.61s/it]Task 7, Epoch 6/50 => Loss 0.782, Train_accy 79.33, Test_accy 79.61:  10%|█         | 5/50 [17:30<2:11:42, 175.61s/it]Task 7, Epoch 6/50 => Loss 0.782, Train_accy 79.33, Test_accy 79.61:  12%|█▏        | 6/50 [17:30<2:09:19, 176.35s/it]Task 7, Epoch 7/50 => Loss 0.750, Train_accy 80.23, Test_accy 81.01:  12%|█▏        | 6/50 [20:28<2:09:19, 176.35s/it]Task 7, Epoch 7/50 => Loss 0.750, Train_accy 80.23, Test_accy 81.01:  14%|█▍        | 7/50 [20:28<2:06:51, 177.01s/it]Task 7, Epoch 8/50 => Loss 0.697, Train_accy 81.79, Test_accy 81.80:  14%|█▍        | 7/50 [23:25<2:06:51, 177.01s/it]Task 7, Epoch 8/50 => Loss 0.697, Train_accy 81.79, Test_accy 81.80:  16%|█▌        | 8/50 [23:25<2:03:50, 176.91s/it]Task 7, Epoch 9/50 => Loss 0.671, Train_accy 81.87, Test_accy 81.76:  16%|█▌        | 8/50 [26:17<2:03:50, 176.91s/it]Task 7, Epoch 9/50 => Loss 0.671, Train_accy 81.87, Test_accy 81.76:  18%|█▊        | 9/50 [26:17<1:59:53, 175.46s/it]Task 7, Epoch 10/50 => Loss 0.663, Train_accy 82.21, Test_accy 80.02:  18%|█▊        | 9/50 [29:10<1:59:53, 175.46s/it]Task 7, Epoch 10/50 => Loss 0.663, Train_accy 82.21, Test_accy 80.02:  20%|██        | 10/50 [29:10<1:56:24, 174.62s/it]Task 7, Epoch 11/50 => Loss 0.651, Train_accy 82.65, Test_accy 82.64:  20%|██        | 10/50 [32:03<1:56:24, 174.62s/it]Task 7, Epoch 11/50 => Loss 0.651, Train_accy 82.65, Test_accy 82.64:  22%|██▏       | 11/50 [32:03<1:53:07, 174.04s/it]Task 7, Epoch 12/50 => Loss 0.617, Train_accy 83.64, Test_accy 82.18:  22%|██▏       | 11/50 [34:58<1:53:07, 174.04s/it]Task 7, Epoch 12/50 => Loss 0.617, Train_accy 83.64, Test_accy 82.18:  24%|██▍       | 12/50 [34:58<1:50:26, 174.39s/it]Task 7, Epoch 13/50 => Loss 0.621, Train_accy 83.64, Test_accy 82.82:  24%|██▍       | 12/50 [37:52<1:50:26, 174.39s/it]Task 7, Epoch 13/50 => Loss 0.621, Train_accy 83.64, Test_accy 82.82:  26%|██▌       | 13/50 [37:52<1:47:26, 174.23s/it]Task 7, Epoch 14/50 => Loss 0.606, Train_accy 84.10, Test_accy 83.05:  26%|██▌       | 13/50 [40:47<1:47:26, 174.23s/it]Task 7, Epoch 14/50 => Loss 0.606, Train_accy 84.10, Test_accy 83.05:  28%|██▊       | 14/50 [40:47<1:44:39, 174.43s/it]Task 7, Epoch 15/50 => Loss 0.603, Train_accy 84.36, Test_accy 83.83:  28%|██▊       | 14/50 [43:41<1:44:39, 174.43s/it]Task 7, Epoch 15/50 => Loss 0.603, Train_accy 84.36, Test_accy 83.83:  30%|███       | 15/50 [43:41<1:41:46, 174.46s/it]Task 7, Epoch 16/50 => Loss 0.585, Train_accy 84.61, Test_accy 82.17:  30%|███       | 15/50 [46:37<1:41:46, 174.46s/it]Task 7, Epoch 16/50 => Loss 0.585, Train_accy 84.61, Test_accy 82.17:  32%|███▏      | 16/50 [46:37<1:39:05, 174.85s/it]Task 7, Epoch 17/50 => Loss 0.572, Train_accy 85.27, Test_accy 83.73:  32%|███▏      | 16/50 [49:29<1:39:05, 174.85s/it]Task 7, Epoch 17/50 => Loss 0.572, Train_accy 85.27, Test_accy 83.73:  34%|███▍      | 17/50 [49:29<1:35:41, 174.00s/it]Task 7, Epoch 18/50 => Loss 0.567, Train_accy 85.20, Test_accy 82.07:  34%|███▍      | 17/50 [52:22<1:35:41, 174.00s/it]Task 7, Epoch 18/50 => Loss 0.567, Train_accy 85.20, Test_accy 82.07:  36%|███▌      | 18/50 [52:22<1:32:32, 173.52s/it]Task 7, Epoch 19/50 => Loss 0.588, Train_accy 84.36, Test_accy 83.19:  36%|███▌      | 18/50 [55:16<1:32:32, 173.52s/it]Task 7, Epoch 19/50 => Loss 0.588, Train_accy 84.36, Test_accy 83.19:  38%|███▊      | 19/50 [55:16<1:29:50, 173.87s/it]Task 7, Epoch 20/50 => Loss 0.564, Train_accy 85.18, Test_accy 83.96:  38%|███▊      | 19/50 [58:15<1:29:50, 173.87s/it]Task 7, Epoch 20/50 => Loss 0.564, Train_accy 85.18, Test_accy 83.96:  40%|████      | 20/50 [58:15<1:27:36, 175.21s/it]Task 7, Epoch 21/50 => Loss 0.561, Train_accy 85.36, Test_accy 83.73:  40%|████      | 20/50 [1:01:13<1:27:36, 175.21s/it]Task 7, Epoch 21/50 => Loss 0.561, Train_accy 85.36, Test_accy 83.73:  42%|████▏     | 21/50 [1:01:13<1:25:10, 176.22s/it]Task 7, Epoch 22/50 => Loss 0.554, Train_accy 85.43, Test_accy 83.45:  42%|████▏     | 21/50 [1:04:11<1:25:10, 176.22s/it]Task 7, Epoch 22/50 => Loss 0.554, Train_accy 85.43, Test_accy 83.45:  44%|████▍     | 22/50 [1:04:11<1:22:25, 176.64s/it]Task 7, Epoch 23/50 => Loss 0.538, Train_accy 86.23, Test_accy 84.64:  44%|████▍     | 22/50 [1:07:06<1:22:25, 176.64s/it]Task 7, Epoch 23/50 => Loss 0.538, Train_accy 86.23, Test_accy 84.64:  46%|████▌     | 23/50 [1:07:06<1:19:14, 176.09s/it]Task 7, Epoch 24/50 => Loss 0.548, Train_accy 85.56, Test_accy 84.19:  46%|████▌     | 23/50 [1:10:00<1:19:14, 176.09s/it]Task 7, Epoch 24/50 => Loss 0.548, Train_accy 85.56, Test_accy 84.19:  48%|████▊     | 24/50 [1:10:00<1:16:04, 175.56s/it]Task 7, Epoch 25/50 => Loss 0.533, Train_accy 86.36, Test_accy 84.74:  48%|████▊     | 24/50 [1:12:49<1:16:04, 175.56s/it]Task 7, Epoch 25/50 => Loss 0.533, Train_accy 86.36, Test_accy 84.74:  50%|█████     | 25/50 [1:12:49<1:12:20, 173.61s/it]Task 7, Epoch 26/50 => Loss 0.521, Train_accy 86.28, Test_accy 84.94:  50%|█████     | 25/50 [1:15:39<1:12:20, 173.61s/it]Task 7, Epoch 26/50 => Loss 0.521, Train_accy 86.28, Test_accy 84.94:  52%|█████▏    | 26/50 [1:15:39<1:08:57, 172.39s/it]Task 7, Epoch 27/50 => Loss 0.542, Train_accy 86.07, Test_accy 84.40:  52%|█████▏    | 26/50 [1:18:32<1:08:57, 172.39s/it]Task 7, Epoch 27/50 => Loss 0.542, Train_accy 86.07, Test_accy 84.40:  54%|█████▍    | 27/50 [1:18:32<1:06:11, 172.69s/it]Task 7, Epoch 28/50 => Loss 0.522, Train_accy 86.45, Test_accy 85.57:  54%|█████▍    | 27/50 [1:21:28<1:06:11, 172.69s/it]Task 7, Epoch 28/50 => Loss 0.522, Train_accy 86.45, Test_accy 85.57:  56%|█████▌    | 28/50 [1:21:28<1:03:42, 173.75s/it]Task 7, Epoch 29/50 => Loss 0.507, Train_accy 87.17, Test_accy 85.15:  56%|█████▌    | 28/50 [1:24:21<1:03:42, 173.75s/it]Task 7, Epoch 29/50 => Loss 0.507, Train_accy 87.17, Test_accy 85.15:  58%|█████▊    | 29/50 [1:24:21<1:00:45, 173.62s/it]Task 7, Epoch 30/50 => Loss 0.518, Train_accy 86.71, Test_accy 86.47:  58%|█████▊    | 29/50 [1:27:15<1:00:45, 173.62s/it]Task 7, Epoch 30/50 => Loss 0.518, Train_accy 86.71, Test_accy 86.47:  60%|██████    | 30/50 [1:27:15<57:52, 173.62s/it]  Task 7, Epoch 31/50 => Loss 0.503, Train_accy 87.15, Test_accy 85.16:  60%|██████    | 30/50 [1:30:09<57:52, 173.62s/it]Task 7, Epoch 31/50 => Loss 0.503, Train_accy 87.15, Test_accy 85.16:  62%|██████▏   | 31/50 [1:30:09<54:58, 173.59s/it]Task 7, Epoch 32/50 => Loss 0.502, Train_accy 87.06, Test_accy 86.21:  62%|██████▏   | 31/50 [1:32:58<54:58, 173.59s/it]Task 7, Epoch 32/50 => Loss 0.502, Train_accy 87.06, Test_accy 86.21:  64%|██████▍   | 32/50 [1:32:58<51:41, 172.31s/it]Task 7, Epoch 33/50 => Loss 0.510, Train_accy 86.68, Test_accy 86.02:  64%|██████▍   | 32/50 [1:35:49<51:41, 172.31s/it]Task 7, Epoch 33/50 => Loss 0.510, Train_accy 86.68, Test_accy 86.02:  66%|██████▌   | 33/50 [1:35:49<48:41, 171.83s/it]Task 7, Epoch 34/50 => Loss 0.519, Train_accy 86.63, Test_accy 85.59:  66%|██████▌   | 33/50 [1:38:40<48:41, 171.83s/it]Task 7, Epoch 34/50 => Loss 0.519, Train_accy 86.63, Test_accy 85.59:  68%|██████▊   | 34/50 [1:38:40<45:47, 171.71s/it]Task 7, Epoch 35/50 => Loss 0.499, Train_accy 87.09, Test_accy 86.54:  68%|██████▊   | 34/50 [1:41:33<45:47, 171.71s/it]Task 7, Epoch 35/50 => Loss 0.499, Train_accy 87.09, Test_accy 86.54:  70%|███████   | 35/50 [1:41:33<43:01, 172.07s/it]Task 7, Epoch 36/50 => Loss 0.483, Train_accy 87.58, Test_accy 85.33:  70%|███████   | 35/50 [1:44:26<43:01, 172.07s/it]Task 7, Epoch 36/50 => Loss 0.483, Train_accy 87.58, Test_accy 85.33:  72%|███████▏  | 36/50 [1:44:26<40:12, 172.34s/it]Task 7, Epoch 37/50 => Loss 0.496, Train_accy 87.22, Test_accy 86.41:  72%|███████▏  | 36/50 [1:47:22<40:12, 172.34s/it]Task 7, Epoch 37/50 => Loss 0.496, Train_accy 87.22, Test_accy 86.41:  74%|███████▍  | 37/50 [1:47:22<37:34, 173.45s/it]Task 7, Epoch 38/50 => Loss 0.491, Train_accy 87.59, Test_accy 85.86:  74%|███████▍  | 37/50 [1:50:17<37:34, 173.45s/it]Task 7, Epoch 38/50 => Loss 0.491, Train_accy 87.59, Test_accy 85.86:  76%|███████▌  | 38/50 [1:50:17<34:45, 173.83s/it]Task 7, Epoch 39/50 => Loss 0.479, Train_accy 87.67, Test_accy 86.07:  76%|███████▌  | 38/50 [1:53:11<34:45, 173.83s/it]Task 7, Epoch 39/50 => Loss 0.479, Train_accy 87.67, Test_accy 86.07:  78%|███████▊  | 39/50 [1:53:11<31:54, 174.04s/it]Task 7, Epoch 40/50 => Loss 0.464, Train_accy 88.19, Test_accy 86.48:  78%|███████▊  | 39/50 [1:56:05<31:54, 174.04s/it]Task 7, Epoch 40/50 => Loss 0.464, Train_accy 88.19, Test_accy 86.48:  80%|████████  | 40/50 [1:56:05<28:59, 173.91s/it]Task 7, Epoch 41/50 => Loss 0.479, Train_accy 87.58, Test_accy 86.63:  80%|████████  | 40/50 [1:58:57<28:59, 173.91s/it]Task 7, Epoch 41/50 => Loss 0.479, Train_accy 87.58, Test_accy 86.63:  82%|████████▏ | 41/50 [1:58:57<25:59, 173.29s/it]Task 7, Epoch 42/50 => Loss 0.455, Train_accy 88.65, Test_accy 86.31:  82%|████████▏ | 41/50 [2:01:50<25:59, 173.29s/it]Task 7, Epoch 42/50 => Loss 0.455, Train_accy 88.65, Test_accy 86.31:  84%|████████▍ | 42/50 [2:01:50<23:07, 173.40s/it]Task 7, Epoch 43/50 => Loss 0.465, Train_accy 88.27, Test_accy 86.33:  84%|████████▍ | 42/50 [2:04:44<23:07, 173.40s/it]Task 7, Epoch 43/50 => Loss 0.465, Train_accy 88.27, Test_accy 86.33:  86%|████████▌ | 43/50 [2:04:44<20:13, 173.39s/it]Task 7, Epoch 44/50 => Loss 0.475, Train_accy 87.91, Test_accy 86.51:  86%|████████▌ | 43/50 [2:07:39<20:13, 173.39s/it]Task 7, Epoch 44/50 => Loss 0.475, Train_accy 87.91, Test_accy 86.51:  88%|████████▊ | 44/50 [2:07:39<17:24, 174.12s/it]Task 7, Epoch 45/50 => Loss 0.478, Train_accy 88.17, Test_accy 86.71:  88%|████████▊ | 44/50 [2:10:33<17:24, 174.12s/it]Task 7, Epoch 45/50 => Loss 0.478, Train_accy 88.17, Test_accy 86.71:  90%|█████████ | 45/50 [2:10:33<14:29, 173.95s/it]Task 7, Epoch 46/50 => Loss 0.479, Train_accy 87.76, Test_accy 86.56:  90%|█████████ | 45/50 [2:13:26<14:29, 173.95s/it]Task 7, Epoch 46/50 => Loss 0.479, Train_accy 87.76, Test_accy 86.56:  92%|█████████▏| 46/50 [2:13:26<11:35, 173.75s/it]Task 7, Epoch 47/50 => Loss 0.458, Train_accy 88.43, Test_accy 86.57:  92%|█████████▏| 46/50 [2:16:17<11:35, 173.75s/it]Task 7, Epoch 47/50 => Loss 0.458, Train_accy 88.43, Test_accy 86.57:  94%|█████████▍| 47/50 [2:16:17<08:38, 172.85s/it]Task 7, Epoch 48/50 => Loss 0.467, Train_accy 88.39, Test_accy 86.57:  94%|█████████▍| 47/50 [2:19:08<08:38, 172.85s/it]Task 7, Epoch 48/50 => Loss 0.467, Train_accy 88.39, Test_accy 86.57:  96%|█████████▌| 48/50 [2:19:08<05:44, 172.38s/it]Task 7, Epoch 49/50 => Loss 0.482, Train_accy 87.87, Test_accy 86.56:  96%|█████████▌| 48/50 [2:22:01<05:44, 172.38s/it]Task 7, Epoch 49/50 => Loss 0.482, Train_accy 87.87, Test_accy 86.56:  98%|█████████▊| 49/50 [2:22:01<02:52, 172.49s/it]Task 7, Epoch 50/50 => Loss 0.483, Train_accy 87.77, Test_accy 86.55:  98%|█████████▊| 49/50 [2:24:55<02:52, 172.49s/it]Task 7, Epoch 50/50 => Loss 0.483, Train_accy 87.77, Test_accy 86.55: 100%|██████████| 50/50 [2:24:55<00:00, 172.79s/it]Task 7, Epoch 50/50 => Loss 0.483, Train_accy 87.77, Test_accy 86.55: 100%|██████████| 50/50 [2:24:55<00:00, 173.90s/it]
2024-06-14 18:41:24,841 [lora_prompt.py] => Task 7, Epoch 50/50 => Loss 0.483, Train_accy 87.77, Test_accy 86.55
/home/dd/cp_prompt/utils/toolkit.py:74: RuntimeWarning: invalid value encountered in long_scalars
  all_acc['new'] = np.around(((y_pred[idxes]%class_num) == (y_true[idxes]%class_num)).sum()*100 / len(idxes), decimals=2)
2024-06-14 18:53:33,601 [lora_prompt.py] => Exemplar size: 0
2024-06-14 18:53:33,601 [trainer.py] => CNN: {'total': 86.28, '00-49': 86.28, 'old': 86.28, 'new': nan}
2024-06-14 18:53:33,601 [trainer.py] => CNN top1 curve: [82.45, 82.5, 83.76, 83.93, 85.77, 85.78, 85.69, 86.28]
